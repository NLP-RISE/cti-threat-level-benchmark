{
    "Event":{
        "threat_level_id":"1",
        "date":"2023-07-04",
        "published":true,
        "info":"Charming Kitten Updates POWERSTAR with an InterPlanetary Twist",
        "publish_timestamp":"1688461546",
        "timestamp":"1688461520",
        "Tag":[
            {
                "name":"misp-galaxy:mitre-intrusion-set=\"Charming Kitten - G0058\""
            },
            {
                "name":"misp-galaxy:mitre-attack-pattern=\"Spearphishing Attachment - T1193\""
            },
            {
                "name":"tlp:white"
            }
        ],
        "Attribute":[
            {
                "category":"External analysis",
                "comment":"",
                "timestamp":"1688460861",
                "type":"link",
                "value":"https://www.volexity.com/blog/2023/06/28/charming-kitten-updates-powerstar-with-an-interplanetary-twist/",
                "to_ids":false
            },
            {
                "category":"External analysis",
                "comment":"",
                "timestamp":"1688460861",
                "type":"link",
                "value":"https://github.com/volexity/threat-intel/tree/main/2023/2023-06-28%20POWERSTAR/indicators",
                "to_ids":false
            },
            {
                "category":"Other",
                "comment":"",
                "timestamp":"1688461115",
                "type":"comment",
                "value":"Backblaze B2 bucket",
                "to_ids":false
            },
            {
                "category":"Other",
                "comment":"",
                "timestamp":"1688461215",
                "type":"comment",
                "value":"Use of IPFS",
                "to_ids":false
            },
            {
                "category":"Payload delivery",
                "comment":"IOCs related to distribution of POWERSTAR PowerShell backdoor by Charming Kitten",
                "timestamp":"1688461346",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"IOCs related to distribution of POWERSTAR PowerShell backdoor by Charming Kitten",
                "timestamp":"1688461346",
                "type":"sha1",
                "value":"<sha1>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"IOCs related to distribution of POWERSTAR PowerShell backdoor by Charming Kitten",
                "timestamp":"1688461346",
                "type":"md5",
                "value":"<md5>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"IOCs related to distribution of POWERSTAR PowerShell backdoor by Charming Kitten",
                "timestamp":"1688461346",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"IOCs related to distribution of POWERSTAR PowerShell backdoor by Charming Kitten",
                "timestamp":"1688461346",
                "type":"sha1",
                "value":"<sha1>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"IOCs related to distribution of POWERSTAR PowerShell backdoor by Charming Kitten",
                "timestamp":"1688461346",
                "type":"md5",
                "value":"<md5>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"IOCs related to distribution of POWERSTAR PowerShell backdoor by Charming Kitten",
                "timestamp":"1688461346",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"IOCs related to distribution of POWERSTAR PowerShell backdoor by Charming Kitten",
                "timestamp":"1688461346",
                "type":"sha1",
                "value":"<sha1>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"IOCs related to distribution of POWERSTAR PowerShell backdoor by Charming Kitten",
                "timestamp":"1688461346",
                "type":"md5",
                "value":"<md5>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"IOCs related to distribution of POWERSTAR PowerShell backdoor by Charming Kitten",
                "timestamp":"1688461346",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"IOCs related to distribution of POWERSTAR PowerShell backdoor by Charming Kitten",
                "timestamp":"1688461346",
                "type":"sha1",
                "value":"<sha1>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"IOCs related to distribution of POWERSTAR PowerShell backdoor by Charming Kitten",
                "timestamp":"1688461346",
                "type":"md5",
                "value":"<md5>",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"IOCs related to distribution of POWERSTAR PowerShell backdoor by Charming Kitten",
                "timestamp":"1688461346",
                "type":"hostname",
                "value":"openlibrary.ignorelist.com",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"IOCs related to distribution of POWERSTAR PowerShell backdoor by Charming Kitten",
                "timestamp":"1688461346",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"IOCs related to distribution of POWERSTAR PowerShell backdoor by Charming Kitten",
                "timestamp":"1688461346",
                "type":"sha1",
                "value":"<sha1>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"IOCs related to distribution of POWERSTAR PowerShell backdoor by Charming Kitten",
                "timestamp":"1688461346",
                "type":"md5",
                "value":"<md5>",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"IOCs related to distribution of POWERSTAR PowerShell backdoor by Charming Kitten",
                "timestamp":"1688461346",
                "type":"hostname",
                "value":"fuschia-rhinestone.cleverapps.io",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"IOCs related to distribution of POWERSTAR PowerShell backdoor by Charming Kitten",
                "timestamp":"1688461346",
                "type":"url",
                "value":"http://bluebox10546.s3.us-west-004.backblazeb2.com/sa/88W3X81EN/cettj34c.txt",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"IOCs related to distribution of POWERSTAR PowerShell backdoor by Charming Kitten",
                "timestamp":"1688461346",
                "type":"url",
                "value":"https://s3.us-west-004.backblazeb2.com/bluebox10546/k41we/k24510.txt",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"IOCs related to distribution of POWERSTAR PowerShell backdoor by Charming Kitten",
                "timestamp":"1688461346",
                "type":"url",
                "value":"https://bluebox10546.s3.us-west-004.backblazeb2.com/share/Us-China.pdf",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"IOCs related to distribution of POWERSTAR PowerShell backdoor by Charming Kitten",
                "timestamp":"1688461346",
                "type":"url",
                "value":"https://bluebox10546.s3.us-west-004.backblazeb2.com/k41we/btw74c.txt",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"IOCs related to distribution of POWERSTAR PowerShell backdoor by Charming Kitten",
                "timestamp":"1688461346",
                "type":"url",
                "value":"https://s3.us-west-004.backblazeb2.com/bluebox10546/k41we/bts74e.txt",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"IOCs related to distribution of POWERSTAR PowerShell backdoor by Charming Kitten",
                "timestamp":"1688461346",
                "type":"url",
                "value":"https://personalstorage1687.s3.us-west-004.backblazeb2.com",
                "to_ids":true
            },
            {
                "category":"Payload installation",
                "comment":"",
                "timestamp":"1688461447",
                "type":"yara",
                "value":"rule apt_win_powerstar_persistence_batch : CharmingKitten\r\n{\r\n    meta:\r\n        author = \"threatintel@volexity.com\"\r\n        date = \"2023-05-16\"\r\n        description = \"Detects the batch script used to persist PowerStar via Startup.\"\r\n        hash1 = \"9777f106ac62829cd3cfdbc156100fe892cfc4038f4c29a076e623dc40a60872\"\r\n        memory_suitable = 1\r\n        license = \"Please see the license at the head of this rules file for acceptable use.\"\r\n\r\n    strings:\r\n        $s_1 = \"e^c^h^o o^f^f\"\r\n        $s_2 = \"powershertxdll.ertxdxe\"\r\n        $s_3 = \"Get-Conrtxdtent -Prtxdath\"\r\n        $s_4 = \"%appdata%\\\\Microsrtxdoft\\\\Windortxdws\\\\\"\r\n        $s_5 = \"&(gcm i*x)$\"\r\n    condition:\r\n        3 of them\r\n}",
                "to_ids":false
            },
            {
                "category":"Payload installation",
                "comment":"",
                "timestamp":"1688461459",
                "type":"yara",
                "value":"rule apt_win_powerstar_memonly : CharmingKitten\r\n{\r\n    meta:\r\n        author = \"threatintel@volexity.com\"\r\n        date = \"2023-05-16\"\r\n        description = \"Detects the initial stage of the memory only variant of PowerStar.\"\r\n        hash1 = \"977cf5cc1d0c61b7364edcf397e5c67d910fac628c6c9a41cf9c73b3720ce67f\"\r\n        memory_suitable = 1\r\n        license = \"Please see the license at the head of this rules file for acceptable use.\"\r\n\r\n    strings:\r\n        $s_1 = \"[System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String($in.substring(3)))\"\r\n        $s_2 = \"[Convert]::ToByte(([Convert]::ToString(-bnot ($text_bytes[$i])\"\r\n        $s_3 = \"$Exec=[System.Text.Encoding]::UTF8.GetString($text_bytes)\"\r\n        $s_4 = \"((65..90) + (97..122) | Get-Random -Count 16 | % {[char]$_})\"\r\n        $f_1 = \"function Gorjol{\"\r\n        $f_2 = \"Borjol \\\"$\"\r\n        $f_3 = \"Gorjol -text\"\r\n        $f_4 = \"function Borjoly{\"\r\n        $f_6 = \"$filename = $env:APPDATA+\\\"\\\\Microsoft\\\\Windows\\\\DocumentPreview.pdf\\\";\"\r\n        $f_7 = \"$env:APPDATA+\\\"\\\\Microsoft\\\\Windows\\\\npv.txt\\\"\"\r\n        $f_8 = \"\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\Startup\\\\brt8ts74e.bat\"\r\n        $f_9 = \"\\\\Microsoft\\\\Windows\\\\s7qe52.txt\"\r\n        $f_10 = \"$yeolsoe2 = $yeolsoe\"\r\n        $f_11 = \"setRequestHeader(\\\"Content-DPR\\\"\"\r\n        $f_12 = \"getResponseHeader(\\\"Content-DPR\\\")\"\r\n        $f_13 = {24 43 6f 6d 6d 61 6e 64 50 61 72 74 73 20 3d 24 53 65 73 73 69 6f 6e 52 65 73 70 6f 6e 73 65 2e 53 70 6c 69 74 28 22 b6 22 29}\r\n        $f_14 = \"$language -like \\\"*shar*\\\"\"\r\n        $f_15 = \"$language -like \\\"*owers*\\\"\"\r\n        $alias_1 = \"(gcm *v????E?P?e*)\"\r\n        $alias_2 = \"&(gcm *ke-e*) $Command\"\r\n        $key = \"T2r0y1M1e1n1o0w1\"\r\n        $args_1 = \"$sem.Close()\"\r\n        $args_2 = \"$cem.Close()\"\r\n        $args_3 = \"$mem.Close()\"\r\n        $command_1 = \"_____numone_____\"\r\n        $command_2 = \"_____mac2_____\"\r\n        $command_3 = \"_____yeolsoe_____\"\r\n    condition:\r\n        2 of ($s_*) or\r\n        any of ($f_*) or\r\n        2 of ($alias_*) or\r\n        $key or\r\n        all of ($args_*) or\r\n        any of ($command_*)\r\n}",
                "to_ids":false
            },
            {
                "category":"Payload installation",
                "comment":"",
                "timestamp":"1688461470",
                "type":"yara",
                "value":"rule apt_win_powerstar_logmessage : CharmingKitten\r\n{\r\n    meta:\r\n        author = \"threatintel@volexity.com\"\r\n        date = \"2023-05-16\"\r\n        description = \"Detects interesting log message embedded in memory only version of PowerStar.\"\r\n        memory_suitable = 1\r\n        license = \"Please see the license at the head of this rules file for acceptable use.\"\r\n\r\n    strings:\r\n        $s_1 = \"wau, ije ulineun mueos-eul halkkayo?\"\r\n    condition:\r\n        all of them\r\n}",
                "to_ids":false
            },
            {
                "category":"Payload installation",
                "comment":"",
                "timestamp":"1688461483",
                "type":"yara",
                "value":"rule apt_win_powerstar_lnk : CharmingKitten\r\n{\r\n    meta:\r\n        author = \"threatintel@volexity.com\"\r\n        date = \"2023-05-16\"\r\n        description = \"Detects LNK command line used to install PowerStar.\"\r\n        memory_suitable = 1\r\n        license = \"Please see the license at the head of this rules file for acceptable use.\"\r\n\r\n    strings:\r\n        $p_1 = \"-UseBasicParsing).Content; &(gcm i*x)$\"\r\n\r\n        $c_1 = \"powershecde43ell.ecde43exe\"\r\n        $c_2 = \"wgcde43eet -Ucde43eri\"\r\n        $c_3 = \"-UseBasicde43ecParsing).Contcde43eent; &(gcm i*x)$\"\r\n    condition:\r\n        any of them\r\n}",
                "to_ids":false
            },
            {
                "category":"Payload installation",
                "comment":"",
                "timestamp":"1688461498",
                "type":"yara",
                "value":"rule apt_win_powerstar_decrypt_function : CharmingKitten\r\n{\r\n    meta:\r\n        author = \"threatintel@volexity.com\"\r\n        date = \"2023-05-16\"\r\n        description = \"Detects PowerStar decrypt function, potentially downloaded standalone and then injected.\"\r\n        hash1 = \"b79d28fe5e3c988bb5aadb12ce442d53291dbb9ede0c7d9d64eec078beba5585\"\r\n        memory_suitable = 1\r\n        license = \"Please see the license at the head of this rules file for acceptable use.\"\r\n\r\n    strings:\r\n        $f_1 = \"function Borjol{\"\r\n\r\n        $s_1 = \"$global:Domain = \\\"\"\r\n        $s_2 = \"$global:IP = \\\"\"\r\n        $s_3 = \"$global:yeolsoe\"\r\n        $s_4 = \"$semii.Close()\"\r\n        $s_5 = \"$cemii.Close()\"\r\n        $s_6 = \"$memii.Close()\"\r\n    condition:\r\n        any of ($f_*) or\r\n        2 of ($s_*)\r\n\r\n}",
                "to_ids":false
            },
            {
                "category":"Payload installation",
                "comment":"",
                "timestamp":"1688461513",
                "type":"yara",
                "value":"rule apt_win_powerstar : CharmingKitten\r\n{\r\n    meta:\r\n        author = \"threatintel@volexity.com\"\r\n        description = \"Custom PowerShell backdoor used by Charming Kitten.\"\r\n        date = \"2021-10-13\"\r\n        hash1 = \"de99c4fa14d99af791826a170b57a70b8265fee61c6b6278d3fe0aad98e85460\"\r\n        memory_suitable = 1\r\n        license = \"Please see the license at the head of this rules file for acceptable use.\"\r\n\r\n    strings:\r\n        $appname = \"[AppProject.Program]::Main()\" ascii wide // caller for C# code\r\n\r\n        $langfilters1 = \"*shar*\" ascii wide\r\n        $langfilters2 = \"*owers*\" ascii wide\r\n\r\n        $definitions1 = \"[string]$language\" ascii wide\r\n        $definitions2 = \"[string]$Command\" ascii wide\r\n        $definitions3 = \"[string]$ThreadName\" ascii wide\r\n        $definitions4 = \"[string]$StartStop\" ascii wide\r\n\r\n        $sess = \"$session = $v + \\\";;\\\" + $env:COMPUTERNAME + $mac;\" ascii wide\r\n\r\n    condition:\r\n        $appname or\r\n        all of ($langfilters*) or\r\n        all of ($definitions*) or\r\n        $sess\r\n}",
                "to_ids":false
            }
        ]
    }
}