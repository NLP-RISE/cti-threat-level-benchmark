{
    "Event":{
        "threat_level_id":"1",
        "date":"2025-07-23",
        "published":true,
        "info":"OSINT -  Disrupting active exploitation of on-premises SharePoint vulnerabilities",
        "publish_timestamp":"1753257969",
        "timestamp":"1753257959",
        "Tag":[
            {
                "name":"misp-galaxy:threat-actor=\"APT31\""
            },
            {
                "name":"misp-galaxy:threat-actor=\"Emissary Panda\""
            },
            {
                "name":"type:OSINT"
            },
            {
                "name":"osint:lifetime=\"perpetual\""
            },
            {
                "name":"osint:certainty=\"50\""
            },
            {
                "name":"tlp:white"
            },
            {
                "name":"tlp:clear"
            },
            {
                "name":"misp-galaxy:threat-actor=\"Storm-2603\""
            },
            {
                "name":"misp-galaxy:mitre-attack-pattern=\"Exploit Public-Facing Application - T1190\""
            },
            {
                "name":"misp-galaxy:mitre-attack-pattern=\"PowerShell - T1059.001\""
            },
            {
                "name":"misp-galaxy:mitre-attack-pattern=\"Web Shell - T1505.003\""
            },
            {
                "name":"misp-galaxy:mitre-attack-pattern=\"Reflective Code Loading - T1620\""
            },
            {
                "name":"misp-galaxy:mitre-attack-pattern=\"Automated Collection - T1119\""
            },
            {
                "name":"misp-galaxy:producer=\"Microsoft\""
            }
        ],
        "Attribute":[
            {
                "category":"External analysis",
                "comment":"",
                "timestamp":"1753253704",
                "type":"vulnerability",
                "value":"CVE-2025-53770",
                "to_ids":false
            },
            {
                "category":"External analysis",
                "comment":"",
                "timestamp":"1753253704",
                "type":"vulnerability",
                "value":"CVE-2025-49704",
                "to_ids":false
            },
            {
                "category":"External analysis",
                "comment":"",
                "timestamp":"1753253704",
                "type":"vulnerability",
                "value":"CVE-2025-53771",
                "to_ids":false
            },
            {
                "category":"External analysis",
                "comment":"",
                "timestamp":"1753253704",
                "type":"vulnerability",
                "value":"CVE-2025-49706",
                "to_ids":false
            },
            {
                "category":"Network activity",
                "comment":"IP address exploiting SharePoint vulnerabilities",
                "timestamp":"1753253793",
                "type":"ip-dst",
                "value":"134.199.202.205",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"IP address exploiting SharePoint vulnerabilities",
                "timestamp":"1753253793",
                "type":"ip-dst",
                "value":"104.238.159.149",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"IP address exploiting SharePoint vulnerabilities",
                "timestamp":"1753253793",
                "type":"ip-dst",
                "value":"188.130.206.168",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"Post exploitation C2",
                "timestamp":"1753253810",
                "type":"ip-dst",
                "value":"131.226.2.6",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"Ngrok tunnel delivering PowerShell to C2",
                "timestamp":"1753253878",
                "type":"url",
                "value":"c34718cbb4c6.ngrok-free.app/file.ps1",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"Hash of spinstall0.aspx",
                "timestamp":"1753253898",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            }
        ],
        "Object":[
            {
                "comment":"CVE-2025-49706: Enriched via the vulnerability_lookup module",
                "description":"Vulnerability object describing a common vulnerability enumeration which can describe published, unpublished, under review or embargo vulnerability for software, equipments or hardware.",
                "meta-category":"vulnerability",
                "name":"vulnerability",
                "timestamp":"1753253712",
                "Attribute":[
                    {
                        "category":"External analysis",
                        "comment":"",
                        "timestamp":"1753253712",
                        "type":"link",
                        "value":"https://vulnerability.circl.lu/vuln/CVE-2025-49706",
                        "to_ids":false
                    },
                    {
                        "category":"External analysis",
                        "comment":"",
                        "timestamp":"1753253712",
                        "type":"vulnerability",
                        "value":"CVE-2025-49706",
                        "to_ids":false
                    },
                    {
                        "category":"Other",
                        "comment":"",
                        "timestamp":"1753253712",
                        "type":"datetime",
                        "value":"2025-07-08T16:58:07.343000+00:00",
                        "to_ids":false
                    },
                    {
                        "category":"Other",
                        "comment":"",
                        "timestamp":"1753253712",
                        "type":"datetime",
                        "value":"2025-07-23T03:55:22.461000+00:00",
                        "to_ids":false
                    },
                    {
                        "category":"Other",
                        "comment":"",
                        "timestamp":"1753253712",
                        "type":"text",
                        "value":"PUBLISHED",
                        "to_ids":false
                    },
                    {
                        "category":"External analysis",
                        "comment":"",
                        "timestamp":"1753253712",
                        "type":"link",
                        "value":"https://msrc.microsoft.com/update-guide/vulnerability/CVE-2025-49706",
                        "to_ids":false
                    }
                ]
            },
            {
                "comment":"CVE-2025-53771: Enriched via the vulnerability_lookup module",
                "description":"Vulnerability object describing a common vulnerability enumeration which can describe published, unpublished, under review or embargo vulnerability for software, equipments or hardware.",
                "meta-category":"vulnerability",
                "name":"vulnerability",
                "timestamp":"1753253718",
                "Attribute":[
                    {
                        "category":"External analysis",
                        "comment":"",
                        "timestamp":"1753253718",
                        "type":"link",
                        "value":"https://vulnerability.circl.lu/vuln/CVE-2025-53771",
                        "to_ids":false
                    },
                    {
                        "category":"External analysis",
                        "comment":"",
                        "timestamp":"1753253718",
                        "type":"vulnerability",
                        "value":"CVE-2025-53771",
                        "to_ids":false
                    },
                    {
                        "category":"Other",
                        "comment":"",
                        "timestamp":"1753253718",
                        "type":"datetime",
                        "value":"2025-07-20T22:16:52.203000+00:00",
                        "to_ids":false
                    },
                    {
                        "category":"Other",
                        "comment":"",
                        "timestamp":"1753253718",
                        "type":"datetime",
                        "value":"2025-07-22T21:03:27.322000+00:00",
                        "to_ids":false
                    },
                    {
                        "category":"Other",
                        "comment":"",
                        "timestamp":"1753253718",
                        "type":"text",
                        "value":"PUBLISHED",
                        "to_ids":false
                    },
                    {
                        "category":"External analysis",
                        "comment":"",
                        "timestamp":"1753253718",
                        "type":"link",
                        "value":"https://msrc.microsoft.com/update-guide/vulnerability/CVE-2025-53771",
                        "to_ids":false
                    }
                ]
            },
            {
                "comment":"CVE-2025-49704: Enriched via the vulnerability_lookup module",
                "description":"Vulnerability object describing a common vulnerability enumeration which can describe published, unpublished, under review or embargo vulnerability for software, equipments or hardware.",
                "meta-category":"vulnerability",
                "name":"vulnerability",
                "timestamp":"1753253724",
                "Attribute":[
                    {
                        "category":"External analysis",
                        "comment":"",
                        "timestamp":"1753253724",
                        "type":"link",
                        "value":"https://vulnerability.circl.lu/vuln/CVE-2025-49704",
                        "to_ids":false
                    },
                    {
                        "category":"External analysis",
                        "comment":"",
                        "timestamp":"1753253724",
                        "type":"vulnerability",
                        "value":"CVE-2025-49704",
                        "to_ids":false
                    },
                    {
                        "category":"Other",
                        "comment":"",
                        "timestamp":"1753253724",
                        "type":"datetime",
                        "value":"2025-07-08T16:58:05.908000+00:00",
                        "to_ids":false
                    },
                    {
                        "category":"Other",
                        "comment":"",
                        "timestamp":"1753253724",
                        "type":"datetime",
                        "value":"2025-07-22T21:04:05.006000+00:00",
                        "to_ids":false
                    },
                    {
                        "category":"Other",
                        "comment":"",
                        "timestamp":"1753253724",
                        "type":"text",
                        "value":"PUBLISHED",
                        "to_ids":false
                    },
                    {
                        "category":"External analysis",
                        "comment":"",
                        "timestamp":"1753253724",
                        "type":"link",
                        "value":"https://msrc.microsoft.com/update-guide/vulnerability/CVE-2025-49704",
                        "to_ids":false
                    }
                ]
            },
            {
                "comment":"CVE-2025-49704: Enriched via the vulnerability_lookup module",
                "description":"Vulnerability object describing a common vulnerability enumeration which can describe published, unpublished, under review or embargo vulnerability for software, equipments or hardware.",
                "meta-category":"vulnerability",
                "name":"vulnerability",
                "timestamp":"1753253733",
                "Attribute":[
                    {
                        "category":"External analysis",
                        "comment":"",
                        "timestamp":"1753253733",
                        "type":"link",
                        "value":"https://vulnerability.circl.lu/vuln/CVE-2025-49704",
                        "to_ids":false
                    },
                    {
                        "category":"External analysis",
                        "comment":"",
                        "timestamp":"1753253733",
                        "type":"vulnerability",
                        "value":"CVE-2025-49704",
                        "to_ids":false
                    },
                    {
                        "category":"Other",
                        "comment":"",
                        "timestamp":"1753253733",
                        "type":"datetime",
                        "value":"2025-07-08T16:58:05.908000+00:00",
                        "to_ids":false
                    },
                    {
                        "category":"Other",
                        "comment":"",
                        "timestamp":"1753253733",
                        "type":"datetime",
                        "value":"2025-07-22T21:04:05.006000+00:00",
                        "to_ids":false
                    },
                    {
                        "category":"Other",
                        "comment":"",
                        "timestamp":"1753253733",
                        "type":"text",
                        "value":"PUBLISHED",
                        "to_ids":false
                    },
                    {
                        "category":"External analysis",
                        "comment":"",
                        "timestamp":"1753253733",
                        "type":"link",
                        "value":"https://msrc.microsoft.com/update-guide/vulnerability/CVE-2025-49704",
                        "to_ids":false
                    }
                ]
            },
            {
                "comment":"CVE-2025-53770: Enriched via the vulnerability_lookup module",
                "description":"Vulnerability object describing a common vulnerability enumeration which can describe published, unpublished, under review or embargo vulnerability for software, equipments or hardware.",
                "meta-category":"vulnerability",
                "name":"vulnerability",
                "timestamp":"1753253741",
                "Attribute":[
                    {
                        "category":"External analysis",
                        "comment":"",
                        "timestamp":"1753253741",
                        "type":"link",
                        "value":"https://vulnerability.circl.lu/vuln/CVE-2025-53770",
                        "to_ids":false
                    },
                    {
                        "category":"External analysis",
                        "comment":"",
                        "timestamp":"1753253741",
                        "type":"vulnerability",
                        "value":"CVE-2025-53770",
                        "to_ids":false
                    },
                    {
                        "category":"Other",
                        "comment":"",
                        "timestamp":"1753253741",
                        "type":"datetime",
                        "value":"2025-07-20T01:06:33.607000+00:00",
                        "to_ids":false
                    },
                    {
                        "category":"Other",
                        "comment":"",
                        "timestamp":"1753253741",
                        "type":"datetime",
                        "value":"2025-07-23T03:55:21.046000+00:00",
                        "to_ids":false
                    },
                    {
                        "category":"Other",
                        "comment":"",
                        "timestamp":"1753253741",
                        "type":"text",
                        "value":"PUBLISHED",
                        "to_ids":false
                    },
                    {
                        "category":"External analysis",
                        "comment":"",
                        "timestamp":"1753253741",
                        "type":"link",
                        "value":"https://msrc.microsoft.com/update-guide/vulnerability/CVE-2025-53770",
                        "to_ids":false
                    }
                ]
            },
            {
                "comment":"File path for stolen web configs",
                "description":"File object describing a file with meta-information",
                "meta-category":"file",
                "name":"file",
                "timestamp":"1753253856",
                "Attribute":[
                    {
                        "category":"Other",
                        "comment":"",
                        "timestamp":"1753253856",
                        "type":"text",
                        "value":"\\1[5-6]\\TEMPLATE\\LAYOUTS\\debug_dev.js",
                        "to_ids":false
                    }
                ]
            },
            {
                "comment":"",
                "description":"File object describing a file with meta-information",
                "meta-category":"file",
                "name":"file",
                "timestamp":"1753253938",
                "Attribute":[
                    {
                        "category":"Payload delivery",
                        "comment":"File containing web config data, including MachineKey data",
                        "timestamp":"1753253938",
                        "type":"filename",
                        "value":"debug_dev.js",
                        "to_ids":false
                    },
                    {
                        "category":"Other",
                        "comment":"",
                        "timestamp":"1753253938",
                        "type":"text",
                        "value":"Malicious",
                        "to_ids":false
                    }
                ]
            },
            {
                "comment":"",
                "description":"File object describing a file with meta-information",
                "meta-category":"file",
                "name":"file",
                "timestamp":"1753253983",
                "Attribute":[
                    {
                        "category":"Payload delivery",
                        "comment":"Web shell used by threat actors   Actors have also modified the file name in a variety of ways, such as spinstall.aspx, spinstall1.aspx, spinstall2.aspx",
                        "timestamp":"1753253983",
                        "type":"filename",
                        "value":"Spinstall0.aspx",
                        "to_ids":false
                    }
                ]
            },
            {
                "comment":"Detect network indicators of compromise and file hashes via ASIM",
                "description":"An object describing a query, along with its format.",
                "meta-category":"misc",
                "name":"query",
                "timestamp":"1753257511",
                "Attribute":[
                    {
                        "category":"Other",
                        "comment":"",
                        "timestamp":"1753257511",
                        "type":"text",
                        "value":"Sentinel Advanced Security Information Model",
                        "to_ids":false
                    },
                    {
                        "category":"Other",
                        "comment":"",
                        "timestamp":"1753257511",
                        "type":"text",
                        "value":"//IP list and domain list- _Im_NetworkSession\r\nlet lookback = 30d;\r\nlet ioc_ip_addr = dynamic([\"131.226.2.6\", \"134.199.202.205\", \"104.238.159.149\", \"188.130.206.168\"]);\r\nlet ioc_domains = dynamic([\"c34718cbb4c6.ngrok-free.app\"]);\r\n_Im_NetworkSession(starttime=todatetime(ago(lookback)), endtime=now())\r\n| where DstIpAddr in (ioc_ip_addr) or DstDomain has_any (ioc_domains)\r\n| summarize imNWS_mintime=min(TimeGenerated), imNWS_maxtime=max(TimeGenerated),\r\n  EventCount=count() by SrcIpAddr, DstIpAddr, DstDomain, Dvc, EventProduct, EventVendor",
                        "to_ids":false
                    }
                ]
            },
            {
                "comment":"Detect network indicators of compromise and file hashes via ASIM",
                "description":"An object describing a query, along with its format.",
                "meta-category":"misc",
                "name":"query",
                "timestamp":"1753257550",
                "Attribute":[
                    {
                        "category":"Other",
                        "comment":"",
                        "timestamp":"1753257550",
                        "type":"text",
                        "value":"Sentinel Advanced Security Information Model",
                        "to_ids":false
                    },
                    {
                        "category":"Other",
                        "comment":"",
                        "timestamp":"1753257550",
                        "type":"text",
                        "value":"//IP list - _Im_WebSession\r\nlet lookback = 30d;\r\nlet ioc_ip_addr = dynamic([\"131.226.2.6\", \"134.199.202.205\", \"104.238.159.149\", \"188.130.206.168\"]);\r\nlet ioc_sha_hashes =dynamic([\"92bb4ddb98eeaf11fc15bb32e71d0a63256a0ed826a03ba293ce3a8bf057a514\"]);\r\n_Im_WebSession(starttime=todatetime(ago(lookback)), endtime=now())\r\n| where DstIpAddr in (ioc_ip_addr) or FileSHA256 in (ioc_sha_hashes)\r\n| summarize imWS_mintime=min(TimeGenerated), imWS_maxtime=max(TimeGenerated),\r\n  EventCount=count() by SrcIpAddr, DstIpAddr, Url, Dvc, EventProduct, EventVendor",
                        "to_ids":false
                    }
                ]
            },
            {
                "comment":"",
                "description":"An object describing a query, along with its format.",
                "meta-category":"misc",
                "name":"query",
                "timestamp":"1753257617",
                "Attribute":[
                    {
                        "category":"Other",
                        "comment":"",
                        "timestamp":"1753257617",
                        "type":"text",
                        "value":"Sentinel Advanced Security Information Model",
                        "to_ids":false
                    },
                    {
                        "category":"Other",
                        "comment":"",
                        "timestamp":"1753257617",
                        "type":"text",
                        "value":"// file hash list - imFileEvent\r\nlet ioc_sha_hashes = dynamic([\"92bb4ddb98eeaf11fc15bb32e71d0a63256a0ed826a03ba293ce3a8bf057a514\"]);\r\nimFileEvent\r\n| where SrcFileSHA256 in (ioc_sha_hashes) or TargetFileSHA256 in (ioc_sha_hashes)\r\n| extend AccountName = tostring(split(User, @'')[1]), \r\n  AccountNTDomain = tostring(split(User, @'')[0])\r\n| extend AlgorithmType = \"SHA256\"",
                        "to_ids":false
                    }
                ]
            },
            {
                "comment":"Look for the creation of spinstall0.aspx, which indicates successful post-exploitation of CVE-2025-53770. ",
                "description":"An object describing a query, along with its format.",
                "meta-category":"misc",
                "name":"query",
                "timestamp":"1753257658",
                "Attribute":[
                    {
                        "category":"Other",
                        "comment":"",
                        "timestamp":"1753257658",
                        "type":"text",
                        "value":"Microsoft Defender XDR",
                        "to_ids":false
                    },
                    {
                        "category":"Other",
                        "comment":"",
                        "timestamp":"1753257658",
                        "type":"text",
                        "value":"DeviceFileEvents \r\n| where FolderPath has_any (\"microsoft shared\\\\Web Server Extensions\\\\15\\\\TEMPLATE\\\\LAYOUTS\", \"microsoft shared\\\\Web Server Extensions\\\\16\\\\TEMPLATE\\\\LAYOUTS\") \r\n| where FileName contains \"spinstall\"\r\n| project Timestamp, DeviceName, InitiatingProcessFileName, InitiatingProcessCommandLine, FileName, FolderPath, ReportId, ActionType, SHA256 \r\n| order by Timestamp desc",
                        "to_ids":false
                    }
                ]
            },
            {
                "comment":"Look for process creation where w3wp.exe is spawning encoded PowerShell involving the spinstall0.aspx file or the file paths it’s been known to be written to.",
                "description":"An object describing a query, along with its format.",
                "meta-category":"misc",
                "name":"query",
                "timestamp":"1753257695",
                "Attribute":[
                    {
                        "category":"Other",
                        "comment":"",
                        "timestamp":"1753257695",
                        "type":"text",
                        "value":"Microsoft Defender XDR",
                        "to_ids":false
                    },
                    {
                        "category":"Other",
                        "comment":"",
                        "timestamp":"1753257695",
                        "type":"text",
                        "value":"DeviceProcessEvents\r\n| where InitiatingProcessFileName has \"w3wp.exe\"\r\n    and InitiatingProcessCommandLine !has \"DefaultAppPool\"\r\n    and FileName =~ \"cmd.exe\"\r\n    and ProcessCommandLine has_all (\"cmd.exe\", \"powershell\")\r\n    and ProcessCommandLine has_any (\"EncodedCommand\", \"-ec\")\r\n| extend CommandArguments = split(ProcessCommandLine, \" \")\r\n| mv-expand CommandArguments to typeof(string)\r\n| where CommandArguments matches regex \"^[A-Za-z0-9+/=]{15,}$\"\r\n| extend B64Decode = replace(\"\\\\x00\", \"\", base64_decodestring(tostring(CommandArguments)))   \r\n| where B64Decode contains \"spinstall\", @'C:\\PROGRA~1\\COMMON~1\\MICROS~1\\WEBSER~1\\15\\TEMPLATE\\LAYOUTS', @'C:\\PROGRA~1\\COMMON~1\\MICROS~1\\WEBSER~1\\16\\TEMPLATE\\LAYOUTS')",
                        "to_ids":false
                    }
                ]
            },
            {
                "comment":"Look for the web shell dropped via the PowerShell command.",
                "description":"An object describing a query, along with its format.",
                "meta-category":"misc",
                "name":"query",
                "timestamp":"1753257738",
                "Attribute":[
                    {
                        "category":"Other",
                        "comment":"",
                        "timestamp":"1753257738",
                        "type":"text",
                        "value":"Microsoft Defender XDR",
                        "to_ids":false
                    },
                    {
                        "category":"Other",
                        "comment":"",
                        "timestamp":"1753257738",
                        "type":"text",
                        "value":"DeviceFileEvents\r\n| where Timestamp >ago(7d)\r\n| where InitiatingProcessFileName=~\"powershell.exe\"\r\n| where FileName contains \"spinstall\"",
                        "to_ids":false
                    }
                ]
            },
            {
                "comment":"Look at Microsoft Defender for Endpoint telemetry to determine if specific alerts fired in your environment.",
                "description":"An object describing a query, along with its format.",
                "meta-category":"misc",
                "name":"query",
                "timestamp":"1753257775",
                "Attribute":[
                    {
                        "category":"Other",
                        "comment":"",
                        "timestamp":"1753257775",
                        "type":"text",
                        "value":"Microsoft Defender XDR",
                        "to_ids":false
                    },
                    {
                        "category":"Other",
                        "comment":"",
                        "timestamp":"1753257775",
                        "type":"text",
                        "value":"AlertEvidence \r\n| where Timestamp > ago(7d) \r\n| where Title has \"SuspSignoutReq\" \r\n| extend _DeviceKey = iff(isnotempty(DeviceId), bag_pack_columns(DeviceId, DeviceName),\"\") \r\n| summarize min(Timestamp), max(Timestamp), count_distinctif(DeviceId,isnotempty(DeviceId)), make_set(Title), make_set_if(_DeviceKey, isnotempty(_DeviceKey) )",
                        "to_ids":false
                    }
                ]
            },
            {
                "comment":"Look for devices vulnerable to the CVEs listed in this event",
                "description":"An object describing a query, along with its format.",
                "meta-category":"misc",
                "name":"query",
                "timestamp":"1753257821",
                "Attribute":[
                    {
                        "category":"Other",
                        "comment":"",
                        "timestamp":"1753257821",
                        "type":"text",
                        "value":"Microsoft Defender XDR",
                        "to_ids":false
                    },
                    {
                        "category":"Other",
                        "comment":"",
                        "timestamp":"1753257821",
                        "type":"text",
                        "value":"DeviceTvmSoftwareVulnerabilities \r\n| where CveId in (\"CVE-2025-49704\",\"CVE-2025-49706\",\"CVE-2025-53770\",\"CVE-2025-53771\")",
                        "to_ids":false
                    }
                ]
            }
        ]
    }
}