{
    "Event":{
        "threat_level_id":"2",
        "date":"2023-03-09",
        "published":true,
        "info":"Prometei botnet improves modules and exhibits new capabilities in recent updates",
        "publish_timestamp":"1679649250",
        "timestamp":"1679649230",
        "Tag":[
            {
                "name":"misp-galaxy:malpedia=\"Prometei\""
            },
            {
                "name":"tlp:white"
            }
        ],
        "Attribute":[
            {
                "category":"Network activity",
                "comment":"",
                "timestamp":"1679648539",
                "type":"ip-dst",
                "value":"23.148.145.237",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"",
                "timestamp":"1679648539",
                "type":"ip-dst",
                "value":"69.84.240.57",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"",
                "timestamp":"1679648539",
                "type":"ip-dst",
                "value":"103.40.123.34",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"",
                "timestamp":"1679648539",
                "type":"ip-dst",
                "value":"103.184.128.180",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"",
                "timestamp":"1679648539",
                "type":"ip-dst",
                "value":"103.184.128.244",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"",
                "timestamp":"1679648539",
                "type":"ip-dst",
                "value":"194.195.213.62",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"",
                "timestamp":"1679648539",
                "type":"ip-dst",
                "value":"211.232.48.65",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"",
                "timestamp":"1679648539",
                "type":"ip-dst",
                "value":"103.65.236.53",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"",
                "timestamp":"1679648539",
                "type":"ip-dst",
                "value":"177.73.237.55",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"",
                "timestamp":"1679648539",
                "type":"ip-dst",
                "value":"221.120.144.101",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"",
                "timestamp":"1679648539",
                "type":"hostname",
                "value":"p1.feefreepool.net",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"",
                "timestamp":"1679648539",
                "type":"hostname",
                "value":"p2.feefreepool.net",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"",
                "timestamp":"1679648539",
                "type":"hostname",
                "value":"p3.feefreepool.net",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"",
                "timestamp":"1679648539",
                "type":"domain",
                "value":"gb7ni5rgeexdcncj.onion",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"",
                "timestamp":"1679648539",
                "type":"domain",
                "value":"mkhkjxgchtfgu7uhofxzgoawntfzrkdccymveektqgpxrpjb72oq.zero",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"",
                "timestamp":"1679648539",
                "type":"url",
                "value":"http://23.148.145.237:180/update.7z",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"",
                "timestamp":"1679648539",
                "type":"url",
                "value":"http://69.84.240.57:180/AppServ180.zip",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"",
                "timestamp":"1679648539",
                "type":"url",
                "value":"http://103.40.123.34/k.php",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"",
                "timestamp":"1679648539",
                "type":"url",
                "value":"http://103.40.123.34/7z32.dll",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"",
                "timestamp":"1679648539",
                "type":"url",
                "value":"http://103.40.123.34/7z32.exe",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"",
                "timestamp":"1679648539",
                "type":"url",
                "value":"http://103.40.123.34/std2.7z",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"",
                "timestamp":"1679648539",
                "type":"url",
                "value":"http://103.40.123.34/dwn.php?d=rdpcIip.exe",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"",
                "timestamp":"1679648539",
                "type":"url",
                "value":"http://103.40.123.34/dwn.php?d=7z32.exe",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"",
                "timestamp":"1679648539",
                "type":"url",
                "value":"http://103.40.123.34/dwn.php?d=7z32.dll",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"",
                "timestamp":"1679648539",
                "type":"url",
                "value":"http://103.126.6.233:180/AppServ180.zip",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"",
                "timestamp":"1679648539",
                "type":"url",
                "value":"http://103.40.123.34/srch.7z",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"",
                "timestamp":"1679648539",
                "type":"url",
                "value":"http://103.40.123.34/desktop.txt",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"",
                "timestamp":"1679648539",
                "type":"url",
                "value":"http://103.40.123.34/bklocal2.php",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"",
                "timestamp":"1679648539",
                "type":"url",
                "value":"http://103.40.123.34/bklocal4.php",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"",
                "timestamp":"1679648539",
                "type":"url",
                "value":"http://103.40.123.34/update.7z",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"",
                "timestamp":"1679648539",
                "type":"url",
                "value":"http://194.195.213.62:180/srch.7z",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"",
                "timestamp":"1679648539",
                "type":"url",
                "value":"http://103.184.128.244/update.7z",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"",
                "timestamp":"1679648539",
                "type":"url",
                "value":"http://211.232.48.65:180/update.7z",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"",
                "timestamp":"1679648539",
                "type":"url",
                "value":"http://p2.feefreepool.net/cgi-bin/prometei.cgi",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"",
                "timestamp":"1679648539",
                "type":"url",
                "value":"http://mkhkjxgchtfgu7uhofxzgoawntfzrkdccymveektqgpxrpjb72oq.zero/cgi-bin/prometei.cgi",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"",
                "timestamp":"1679648539",
                "type":"url",
                "value":"https://gb7ni5rgeexdcncj.onion/cgi-bin/prometei.cgi",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"",
                "timestamp":"1679648539",
                "type":"url",
                "value":"http://mkhkjxgchtfgu7uhofxzgoawntfzrkdccymveektqgpxrpjb72oq.b32.i2p/cgi-bin/prometei.cgi",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"",
                "timestamp":"1679648539",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"",
                "timestamp":"1679648539",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"",
                "timestamp":"1679648540",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"",
                "timestamp":"1679648540",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"",
                "timestamp":"1679648540",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"",
                "timestamp":"1679648540",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"",
                "timestamp":"1679648540",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"",
                "timestamp":"1679648540",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"",
                "timestamp":"1679648540",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"",
                "timestamp":"1679648540",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"",
                "timestamp":"1679648540",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"",
                "timestamp":"1679648540",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"",
                "timestamp":"1679648540",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"",
                "timestamp":"1679648540",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"",
                "timestamp":"1679648540",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"",
                "timestamp":"1679648540",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"",
                "timestamp":"1679648540",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"",
                "timestamp":"1679648540",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"",
                "timestamp":"1679648540",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"",
                "timestamp":"1679648540",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"",
                "timestamp":"1679648540",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"",
                "timestamp":"1679648540",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"",
                "timestamp":"1679648540",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"",
                "timestamp":"1679648540",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"",
                "timestamp":"1679648540",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"",
                "timestamp":"1679648540",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"",
                "timestamp":"1679648540",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"",
                "timestamp":"1679648540",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"",
                "timestamp":"1679648540",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"",
                "timestamp":"1679648540",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"",
                "timestamp":"1679648540",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"",
                "timestamp":"1679648540",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"",
                "timestamp":"1679648540",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"",
                "timestamp":"1679648540",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"",
                "timestamp":"1679648540",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"",
                "timestamp":"1679648540",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"",
                "timestamp":"1679648540",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"",
                "timestamp":"1679648540",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"",
                "timestamp":"1679648540",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"",
                "timestamp":"1679648540",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"",
                "timestamp":"1679648540",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"",
                "timestamp":"1679648540",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"",
                "timestamp":"1679648540",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"",
                "timestamp":"1679648540",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"the primary module is downloaded from an actor-controlled server in an encrypted form through a simple XOR byte alteration pattern. Its initial location on the hard drive is “C:\\windows\\zsvc.exe” and is executed through the PowerShell cmdlet “Start-Process”",
                "timestamp":"1679648784",
                "type":"filename",
                "value":"%WINDIR%\\zsvc.exe",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"The original downloaded file is then renamed from “zsvc.exe” to “sqhost.exe.”",
                "timestamp":"1679648841",
                "type":"filename",
                "value":"%WINDIR%\\sqhost.exe",
                "to_ids":true
            },
            {
                "category":"Other",
                "comment":"",
                "timestamp":"1679648878",
                "type":"comment",
                "value":"A firewall rule named “Secure Socket Tunneling Protocol (HTTP)” is executed through the “netsh” command to add “%WINDIR%\\sqhost.exe” to the allowed programs list. Persistence is obtained by creating an automated system service named “UPlugPlay,” which executes sqhost.exe with the argument “Dcomsvc”.",
                "to_ids":false
            },
            {
                "category":"External analysis",
                "comment":"",
                "timestamp":"1679649216",
                "type":"link",
                "value":"https://blog.talosintelligence.com/prometei-botnet-improves/",
                "to_ids":false
            }
        ],
        "Object":[
            {
                "comment":"",
                "description":"Object describing a computer program written to be run in a special run-time environment. The script or shell script can be used for malicious activities but also as support tools for threat analysts.",
                "meta-category":"misc",
                "name":"script",
                "timestamp":"1679648505",
                "Attribute":[
                    {
                        "category":"Other",
                        "comment":"",
                        "timestamp":"1679648505",
                        "type":"text",
                        "value":"#!/usr/bin/env python3\r\nfrom datetime import datetime\r\nimport sys\r\n\r\ndef genPrometeiDomains (basedate=datetime.now(), basestring='xinchao'):\r\n    \tmonth = basedate.strftime(\"%m\")\r\n    \tday_year = basedate.strftime(\"%d%y\")\r\n    \tbasedomain=''\r\n    \tgenerateddomains=[]\r\n    \tfor i in range(len(day_year)):\r\n        \tbasedomain=basedomain+chr(ord(day_year[i]) + 0x31)\r\n   \t \r\n    \tbasedomain=basedomain+chr(int(month)+0x61)\r\n   \t \r\n    \tfor i in range(16):\r\n        \tfor tld in ['.net','.org','.com']:\r\n            \tdomain=basestring+basedomain+chr(i + 0x61)\r\n            \tgenerateddomains.append(domain+tld)\r\n\r\n\r\n    \treturn '\\n'.join(generateddomains)\r\n\r\n\r\nif __name__ == \"__main__\":\r\n\ttry:\r\n    \t    print(genPrometeiDomains(datetime.fromisoformat(sys.argv[1])))\r\n\texcept IndexError:\r\n    \t    print(genPrometeiDomains())\r\n\texcept ValueError:\r\n    \t    print(\"The date must be specified using the ISO format yyyy-mm-dd\")",
                        "to_ids":false
                    },
                    {
                        "category":"Other",
                        "comment":"",
                        "timestamp":"1679648505",
                        "type":"text",
                        "value":"Python",
                        "to_ids":false
                    },
                    {
                        "category":"Other",
                        "comment":"",
                        "timestamp":"1679648505",
                        "type":"text",
                        "value":"Prometei DGA script",
                        "to_ids":false
                    }
                ]
            }
        ]
    }
}