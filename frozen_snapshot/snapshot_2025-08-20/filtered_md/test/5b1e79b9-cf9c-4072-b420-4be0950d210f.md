# Threat Report: 2018-04-16: OSINT -  Roaming Mantis uses DNS hijacking to infect Android smartphones


## Key Intelligence
* Date: 2018-04-16
* Threat Level: 3 (Low)
* Tags: tlp:white, circl:incident-classification="malware", osint:source-type="blog-post", Android Malware, ms-caro-malware:malware-platform="AndroidOS", ms-caro-malware-full:malware-platform="AndroidOS", misp-galaxy:tool="Roaming Mantis"

---

## Indicators of Compromise (IOCs)
### External analysis
* link: https://securelist.com/roaming-mantis-uses-dns-hijacking-to-infect-android-smartphones/85178/
* comment: n March 2018, Japanese media reported the hijacking of DNS settings on routers located in Japan, redirecting users to malicious IP addresses. The redirection led to the installation of Trojanized applications named facebook.apk and chrome.apk that contained Android Trojan-Banker. According to our telemetry data, this malware was detected more than 6,000 times, though the reports came from just 150 unique users (from February 9 to April 9, 2018). Of course, this is down to the nature of the malware distribution, but it also suggests a very painful experience for some users, who saw the same malware appear again and again in their network. More than half of the detections were observed targeting the Asian region.

During our research we received some invaluable information about the true scale of this attack. There were thousands of daily connections to the command and control (C2) infrastructure, with the device locale for the majority of victims set to Korean. Since we didnâ€™t find a pre-existing name for this malware operation, we decided to assign a new one for future reference. Based on its propagation via smartphones roaming between Wi-Fi networks, potentially carrying and spreading the infection, we decided to call it â€˜Roaming Mantisâ€™.

### Network activity
* ip-dst: 114.44.37.112 — Malicious hosts
* ip-dst: 118.166.1.124 — Malicious hosts
* ip-dst: 118.168.193.123 — Malicious hosts
* ip-dst: 128.14.50.146 — Malicious hosts
* ip-dst: 128.14.50.147 — Malicious hosts
* ip-dst: 220.136.111.66 — Malicious hosts
* ip-dst: 220.136.179.5 — Malicious hosts
* ip-dst: 220.136.76.200 — Malicious hosts
* ip-dst: 43.240.14.44 — Malicious hosts
* hostname: haoxingfu01.ddns.net — Malicious hosts
* hostname: shaoye11.hopto.org — Malicious hosts

### Payload delivery
* md5: <md5> — Malicious apks
* md5: <md5> — Malicious apks
* md5: <md5> — Malicious apks
* md5: <md5> — Malicious apks
* md5: <md5> — Malicious apks
* md5: <md5> — Malicious apks
* md5: <md5> — Malicious apks
* md5: <md5> — Malicious apks
* md5: <md5> — Malicious apks
* md5: <md5> — Malicious apks
* md5: <md5> — Malicious apks
* md5: <md5> — Malicious apks
* md5: <md5> — class.dex
* md5: <md5> — class.dex
* md5: <md5> — class.dex
* md5: <md5> — class.dex
* md5: <md5> — class.dex
* md5: <md5> — class.dex
* md5: <md5> — class.dex
* md5: <md5> — class.dex
* md5: <md5> — test.dex
* md5: <md5> — test.dex
* md5: <md5> — test.dex
* md5: <md5> — test.dex
* md5: <md5> — test.dex
* md5: <md5> — test.dex
* md5: <md5> — test.dex
* md5: <md5> — test.dex

## Objects
### file — File object describing a file with meta-information
* [Payload delivery] md5: <md5>
* [Payload delivery] filename: chrome.apk
* [Other] text: Malicious

### file — File object describing a file with meta-information
* _No attributes_

### virustotal-report — VirusTotal report
* _No attributes_

### file — File object describing a file with meta-information
* _No attributes_

### virustotal-report — VirusTotal report
* _No attributes_

### file — File object describing a file with meta-information
* _No attributes_

### virustotal-report — VirusTotal report
* _No attributes_

### file — File object describing a file with meta-information
* _No attributes_

### virustotal-report — VirusTotal report
* _No attributes_

### file — File object describing a file with meta-information
* _No attributes_

### virustotal-report — VirusTotal report
* _No attributes_

### file — File object describing a file with meta-information
* _No attributes_

### virustotal-report — VirusTotal report
* _No attributes_

### file — File object describing a file with meta-information
* _No attributes_

### virustotal-report — VirusTotal report
* _No attributes_

### file — File object describing a file with meta-information
* _No attributes_

### virustotal-report — VirusTotal report
* _No attributes_

### file — File object describing a file with meta-information
* _No attributes_

### virustotal-report — VirusTotal report
* _No attributes_

### file — File object describing a file with meta-information
* _No attributes_

### virustotal-report — VirusTotal report
* _No attributes_

### file — File object describing a file with meta-information
* _No attributes_

### virustotal-report — VirusTotal report
* _No attributes_

### file — File object describing a file with meta-information
* _No attributes_

### virustotal-report — VirusTotal report
* _No attributes_

### file — File object describing a file with meta-information
* _No attributes_

### virustotal-report — VirusTotal report
* _No attributes_

### file — File object describing a file with meta-information
* _No attributes_

### virustotal-report — VirusTotal report
* _No attributes_

### file — File object describing a file with meta-information
* _No attributes_

### virustotal-report — VirusTotal report
* _No attributes_

### file — File object describing a file with meta-information
* _No attributes_

### virustotal-report — VirusTotal report
* _No attributes_

### file — File object describing a file with meta-information
* _No attributes_

### virustotal-report — VirusTotal report
* _No attributes_

### file — File object describing a file with meta-information
* _No attributes_

### virustotal-report — VirusTotal report
* _No attributes_

### file — File object describing a file with meta-information
* _No attributes_

### virustotal-report — VirusTotal report
* _No attributes_

### file — File object describing a file with meta-information
* _No attributes_

### virustotal-report — VirusTotal report
* _No attributes_

### file — File object describing a file with meta-information
* _No attributes_

### virustotal-report — VirusTotal report
* _No attributes_

### file — File object describing a file with meta-information
* _No attributes_

### virustotal-report — VirusTotal report
* _No attributes_

### file — File object describing a file with meta-information
* _No attributes_

### virustotal-report — VirusTotal report
* _No attributes_

### file — File object describing a file with meta-information
* _No attributes_

### virustotal-report — VirusTotal report
* _No attributes_

### file — File object describing a file with meta-information
* _No attributes_

### virustotal-report — VirusTotal report
* _No attributes_

### file — File object describing a file with meta-information
* _No attributes_

### virustotal-report — VirusTotal report
* _No attributes_

### file — File object describing a file with meta-information
* _No attributes_

### virustotal-report — VirusTotal report
* _No attributes_

### file — File object describing a file with meta-information
* _No attributes_

### virustotal-report — VirusTotal report
* _No attributes_

### file — File object describing a file with meta-information
* _No attributes_

### virustotal-report — VirusTotal report
* _No attributes_
