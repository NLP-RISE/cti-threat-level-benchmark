# Threat Report: 2017-08-31: OSINT - Gazing at Gazer


## Key Intelligence
* Date: 2017-08-31
* Threat Level: 3 (Low)
* Tags: type:OSINT, tlp:white, osint:source-type="technical-report"

---

## Indicators of Compromise (IOCs)
### External analysis
* comment: Herein we release our analysis of a previously undocumented backdoor that has been targeted against embassies and consulates around the world leads us to attribute it, with high confidence, to the Turla group. Turla is a notorious group that has been targeting governments, government officials and diplomats for years. They are known to run watering hole and spearphishing campaigns to better pinpoint their targets. Although this backdoor has been actively deployed since at least 2016, it has not been documented anywhere. Based on strings found in the samples we analyzed, we have named this backdoor â€œGazerâ€.
Recently, the Turla APT group has seen extensive news coverage surrounding its campaigns, something we havenâ€™t seen for a long time. The Intercept reported that there exists a 2011 presentation by Canadaâ€™s Communication Security Establishment (CSE) outlining the errors made by the Turla operators during their operations even though the tools they use are quite advanced. The codename for Turla APT group in this presentation is MAKERSMARK. Gazer is, similar to its siblings in the Turla family, using advanced methods to spy and persist on its targets. This whitepaper highlights the campaigns in which Gazer was used and also contains a technical analysis of its functionalities.
* link: https://www.welivesecurity.com/wp-content/uploads/2017/08/eset-gazer.pdf
* link: https://www.virustotal.com/file/93e36c336b5b20b3c33b7d0f8844572ddcc10046d1fe91b7b106d78c7fea932c/analysis/1504156268/ — - Xchecked via VT: a5eec8c6aadf784994bf68d9d937bb7af3684d5c
* link: https://www.virustotal.com/file/4013d3c221c6924e8c525aac7ed0402bd5349a28dcbc20bc1ff6bd09079faacf/analysis/1504278816/ — - Xchecked via VT: c380038a57ffb8c064851b898f630312fabcbba7
* link: https://www.virustotal.com/file/a65bc4adbd61c098acf40ef81dc8b6b10269af0d9ebbdc18b48439df76c18cb3/analysis/1504263553/ — - Xchecked via VT: e40bb5beec5678537e8fe537f872b2ad6b77e08a
* link: https://www.virustotal.com/file/d0b169d2e753191a5c366a863d216bc5a9eb5e173f0bd5a61f126c4fd16484ac/analysis/1504183815/ — - Xchecked via VT: b151cd7c4f9e53a8dcbdeb7ce61ccdd146eb68ab
* link: https://www.virustotal.com/file/473aa2c3ace12abe8a54a088a08e00b7bd71bd66cda16673c308b903c796bec0/analysis/1504278826/ — - Xchecked via VT: 35f205367e2e5f8a121925bbae6ff07626b526a7

### Network activity
* url: daybreakhealthcare.co.uk/wp-includes/themees.php — C&C
* url: simplecreative.design/wp-content/plugins/calculated-fields-form/single.php — C&C
* url: 169.255.137.203/rss_0.php — C&C
* url: outletpiumini.springwaterfeatures.com/wp-includes/pomo/settings.php — C&C
* url: zerogov.com/wp-content/plugins.deactivate/paypal-donations/src/PaypalDonations/SimpleSubsribe.php — C&C
* url: ales.ball-mill.es/ckfinder/core/connector/php/php4/CommandHandler/CommandHandler.php — C&C
* url: dyskurs.com.ua/wp-admin/includes/map-menu.php — C&C
* url: warrixmalaysia.com.my/wp-content/plugins/jetpack/modules/contact-form/grunion-table-form.php — C&C
* url: 217.171.86.137/config.php — C&C
* url: 217.171.86.137/rss_0.php — C&C
* url: shinestars-lifestyle.com/old_shinstar/includes/old/front_footer.old.php — C&C
* url: www.aviasiya.com/murad.by/life/wp-content/plugins/wp-accounting/inc/pages/page-search.php — C&C
* url: baby.greenweb.co.il/wp-content/themes/san-kloud/admin.php — C&C
* url: soligro.com/wp-includes/pomo/db.php — C&C
* url: giadinhvabe.net/wp-content/themes/viettemp/out/css/class.php — C&C
* url: tekfordummies.com/wp-content/plugins/social-auto-poster/includes/libraries/delicious/Delicious.php — C&C
* url: kennynguyen.esy.es/wp-content/plugins/wp-statistics/vendor/maxmind-db/reader/tests/MaxMind/Db/ — C&C
* url: test/Reader/BuildTest.php — C&C
* url: sonneteck.com/wp-content/plugins/yith-woocommerce-wishlist/plugin-fw/licence/templates/panel/activation/activation.php — C&C
* url: chagiocaxuanson.esy.es/wp-content/plugins/nextgen-gallery/products/photocrati_nextgen/modules/ngglegacy/admin/templates/manage_gallery/gallery_preview_page_field.old.php — C&C
* url: hotnews.16mb.com/wp-content/themes/twentysixteen/template-parts/content-header.php — C&C
* url: zszinhyosz.pe.hu/wp-content/themes/twentyfourteen/page-templates/full-hight.php — C&C
* url: weandcats.com/wp-content/plugins/broken-link-checker/modules/checkers/http-module.php — C&C

### Payload delivery
* filename: %TEMP%\KB943729.log
* filename: %TEMP%\CVRG72B5.tmp.cvr
* filename: %TEMP%\CVRG1A6B.tmp.cvr
* filename: %TEMP%\CVRG38D9.tmp.cvr
* filename: %TEMP%\~DF1E06.tmp
* filename: %HOMEPATH%\ntuser.dat.LOG3
* filename: %HOMEPATH%\AppData\Local\Adobe\AdobeUpdater.exe
* sha1: <sha1>
* sha1: <sha1>
* sha1: <sha1>
* sha1: <sha1>
* sha1: <sha1>
* sha1: <sha1>
* sha1: <sha1>
* sha1: <sha1>
* sha1: <sha1>
* sha1: <sha1>
* sha1: <sha1>
* sha1: <sha1>
* sha1: <sha1>
* sha1: <sha1>
* sha1: <sha1>
* sha1: <sha1>
* sha1: <sha1>
* sha1: <sha1>
* sha1: <sha1>
* sha1: <sha1>
* sha1: <sha1>
* sha1: <sha1>
* sha1: <sha1>
* sha1: <sha1>
* sha1: <sha1>
* sha1: <sha1>
* sha1: <sha1>
* sha1: <sha1>
* sha1: <sha1>
* sha1: <sha1>
* sha1: <sha1>
* sha1: <sha1>
* sha1: <sha1>
* sha1: <sha1>
* sha1: <sha1>
* sha1: <sha1>
* sha1: <sha1>
* sha1: <sha1>
* sha1: <sha1>
* sha1: <sha1>
* sha1: <sha1>
* sha1: <sha1>
* sha1: <sha1>
* sha1: <sha1>
* sha1: <sha1>
* sha1: <sha1>
* yara: import â€œpeâ€
import â€œmathâ€
import â€œhashâ€
rule Gazer_certificate_subject {
  condition:
    for any i in (0..pe.number_of_signatures - 1):
       (pe.signatures[i].subject contains â€œSolid Loopâ€ or 
pe.signatures[i].subject contains â€œUltimate Computer Supportâ€)
}
rule Gazer_certificate
{
  strings:
    $certif1 = {52 76 a4 53 cd 70 9c 18 da 65 15 7e 5f 1f de 02}
    $certif2 = {12 90 f2 41 d9 b2 80 af 77 fc da 12 c6 b4 96 9c}
  condition:
    (uint16(0) == 0x5a4d) and 1 of them and filesize < 2MB
}
rule Gazer_logfile_name
{
    strings:
     $s1 = â€œCVRG72B5.tmp.cvrâ€
     $s2 = â€œCVRG1A6B.tmp.cvrâ€
     $s3 = â€œCVRG38D9.tmp.cvrâ€
    condition:
    (uint16(0) == 0x5a4d) and 1 of them
}
* sha256: <sha256> — - Xchecked via VT: a5eec8c6aadf784994bf68d9d937bb7af3684d5c
* md5: <md5> — - Xchecked via VT: a5eec8c6aadf784994bf68d9d937bb7af3684d5c
* sha256: <sha256> — - Xchecked via VT: c380038a57ffb8c064851b898f630312fabcbba7
* md5: <md5> — - Xchecked via VT: c380038a57ffb8c064851b898f630312fabcbba7
* sha256: <sha256> — - Xchecked via VT: e40bb5beec5678537e8fe537f872b2ad6b77e08a
* md5: <md5> — - Xchecked via VT: e40bb5beec5678537e8fe537f872b2ad6b77e08a
* sha256: <sha256> — - Xchecked via VT: b151cd7c4f9e53a8dcbdeb7ce61ccdd146eb68ab
* md5: <md5> — - Xchecked via VT: b151cd7c4f9e53a8dcbdeb7ce61ccdd146eb68ab
* sha256: <sha256> — - Xchecked via VT: 35f205367e2e5f8a121925bbae6ff07626b526a7
* md5: <md5> — - Xchecked via VT: 35f205367e2e5f8a121925bbae6ff07626b526a7

### Persistence mechanism
* regkey: HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\ScreenSaver
* regkey: HKCU\Software\Microsoft\Windows NT\CurrentVersion\Explorer\ScreenSaver
