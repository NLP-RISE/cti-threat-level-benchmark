# Threat Report: 2017-01-19: OSINT -  Uncovering the Inner Workings of EyePyramid


## Key Intelligence
* Date: 2017-01-19
* Threat Level: 3 (Low)
* Tags: misp-galaxy:tool=" EyePyramid Malware", tlp:white

---

## Indicators of Compromise (IOCs)
### Artifacts dropped
* pdb: :\Projects\VS2005\ChromePass\Release\ChromePass.pdb — paths or library names indicating code reuse of specific components
* pdb: :\Projects\VS2005\MyLastSearch\release\MyLastSearch.pdb — paths or library names indicating code reuse of specific components
* pdb: :\Projects\VS2005\NK2View\Release\NK2View.pdb — paths or library names indicating code reuse of specific components
* pdb: :\Projects\VS2005\ProduKey\Release\ProduKey.pdb — paths or library names indicating code reuse of specific components
* pdb: :\Projects\VS2005\RecentFilesView\Release\RecentFilesView.pdb — paths or library names indicating code reuse of specific components
* pdb: :\Projects\VS2005\USBDeview\Release\USBDeview.pdb — paths or library names indicating code reuse of specific components
* pdb: :\Projects\VS2005\WirelessKeyView\Release\WirelessKeyView.pdb — paths or library names indicating code reuse of specific components
* pdb: :\Projects\VS2005\mspass\Release\mspass.pdb — paths or library names indicating code reuse of specific components
* pdb: :\Projects\VS2005\netpass\Release\netpass.pdb — paths or library names indicating code reuse of specific components
* pdb: :\projects\VS2005\iepv\Release\iepv.pdb — paths or library names indicating code reuse of specific components
* pdb: :\projects\vs2005\shortcutsman\release\shman.pdb — paths or library names indicating code reuse of specific components

### Attribution
* text: MN600-D8102F401003102110C5114F1F18-0E8C — Both the 2010 and 2012 versions share the infamous MN600-D8102F401003102110C5114F1F18-0E8C MailBee license key, which was either purchased by Giulio Occhionero, or purchased using his name.

### External analysis
* text: Two Italians referred to as the â€œOcchionero brothersâ€ have been arrested and accused of using malware and a carefully-prepared spear-phishing scheme to spy on high-profile politicians and businessmen. This case has been called â€œEyePyramidâ€, which we first discussed last week. (Conspiracy theories aside, the name came from a domain name and directory path that was found during the research.)

The court order was published by AGI, an Italian news agency, around noon on January 11. It (surprisingly) contains multiple technical details which we used to bootstrap our initial analysis. This post builds on the details of the case to provide a more complete and in-depth view of the activities of this campaign.

Scope of this analysis

We have analyzed nearly 250 distinct samples, with new batches of EyePryramid-related samples seen and identified daily. Right after our initial analysis, about a dozen suspicious samples were uploaded to VirusTotal and tagged as â€œ#eyepyramidâ€. We believe that these samples are â€œfalse flags,â€ because the samples do not resemble any of the samples that we were able to definitely relate to the EyePyramid case. Although we are not able to say with 100% certainty that there are no relationships between these â€œfalse flagsâ€ and the original EyePyramid samples, we purposely did not focus on these uploaded samples.
* link: http://blog.trendmicro.com/trendlabs-security-intelligence/uncovering-inner-workings-eyepyramid
* attachment: EyePyramid_15-01.jpg — Analysis Methodology
* attachment: Appendix_uncovering-the-inner-workings-of-eyepyramid.pdf — Appendix
* link: https://www.virustotal.com/file/21b6f2584485b8bbfffdefd45c1c72dc2133290fd8cefb235eb39cf015550316/analysis/1423753823/ — Although used for debugging only, we found that the malware author was playing around with email-based cross-site scripting, as can be seen from the following code snippet - Xchecked via VT: 21b6f2584485b8bbfffdefd45c1c72dc2133290fd8cefb235eb39cf015550316
* link: https://www.virustotal.com/file/d3ad32bcb255e56cd2a768b3cbf6bafda88233288fc6650d0dfa3810be75f74c/analysis/1484353398/ — - Xchecked via VT: d3ad32bcb255e56cd2a768b3cbf6bafda88233288fc6650d0dfa3810be75f74c

### Network activity
* url: http://guess515.fastmail.fm/files/jobs/44dc7eceb — 2010 sample C&C
* url: http://guess515.fastmail.fm/files/jobs/3261cc389 — 2010 sample C&C
* url: http://guess515.fastmail.fm/files/run — 2010 sample C&C
* url: http://guess515.fastmail.fm/files/ghk — 2010 sample C&C
* url: http://guess515.fastmail.fm/files/co — 2010 sample C&C
* url: http://guess515.fastmail.fm/files/bin/ghk — 2010 sample C&C
* url: http://guess515.fastmail.fm/files/obj/decepk — 2010 sample C&C
* url: http://guess515.fastmail.fm/files/tasks — 2010 sample C&C
* url: http://guess515.fastmail.fm/files/decepk — 2010 sample C&C
* url: http://guess515.fastmail.fm/files/bin/run — 2010 sample C&C
* url: http://guess515.fastmail.fm/files/jobs — 2010 sample C&C
* url: http://guess515.fastmail.fm/files/replace — 2010 sample C&C
* url: http://guess515.fastmail.fm/files/fail — 2010 sample C&C
* url: http://guess515.fastmail.fm/files/obj — 2010 sample C&C
* url: http://guess515.fastmail.fm/files/obj/tasks — 2010 sample C&C
* url: http://guess515.fastmail.fm/files/bin — 2010 sample C&C
* url: ftp://ftp1.storegate.com/home/jiwoku375 — 2012 sample C&C
* url: https://webdav1.storegate.com/jiwoku375/home/jiwoku375 — 2012 sample C&C
* url: http://webdav1.storegate.com/jiwoku375/home/jiwoku375 — 2012 sample C&C
* url: ftp1.storegate.com/home/jiwoku375 — 2012 sample C&C
* url: https://webdav.hidrive.strato.com/users/oncole3991 — 2014 - sample C&C
* url: http://webdav.cloudme.com/imin1399/xios — 2014 - sample C&C
* url: http://webdav1.storegate.com/oldi4006/home/oldi4006 — 2014 - sample C&C
* url: https://webdav1.storegate.com/oldi4006/home/oldi4006 — 2014 - sample C&C
* url: http://webdav1.storegate.com/uwiq175/home/uwiq175 — 2014 - sample C&C
* url: https://webdav1.storegate.com/enzevu888/home/enzevu888 — 2014 - sample C&C
* url: https://webdav1.storegate.com/ordu1337/home/ordu1337 — 2014 - sample C&C
* url: http://webdav1.storegate.com/oqokul68646/home/oqokul68646 — 2014 - sample C&C
* url: http://webdav1.storegate.com/enzevu888/home/enzevu888 — 2014 - sample C&C
* url: https://webdav.cloudme.com/imin1399/xios — 2014 - sample C&C
* url: https://webdav1.storegate.com/uwiq175/home/uwiq175 — 2014 - sample C&C
* url: http://webdav.hidrive.strato.com/users/oncole3991 — 2014 - sample C&C
* url: http://webdav1.storegate.com/ordu1337/home/ordu1337 — 2014 - sample C&C
* url: https://webdav1.storegate.com/oqokul68646/home/oqokul68646 — 2014 - sample C&C

### Payload delivery
* sha256: <sha256> — Although used for debugging only, we found that the malware author was playing around with email-based cross-site scripting, as can be seen from the following code snippet
* sha256: <sha256>
* sha1: <sha1> — Although used for debugging only, we found that the malware author was playing around with email-based cross-site scripting, as can be seen from the following code snippet - Xchecked via VT: 21b6f2584485b8bbfffdefd45c1c72dc2133290fd8cefb235eb39cf015550316
* md5: <md5> — Although used for debugging only, we found that the malware author was playing around with email-based cross-site scripting, as can be seen from the following code snippet - Xchecked via VT: 21b6f2584485b8bbfffdefd45c1c72dc2133290fd8cefb235eb39cf015550316
* sha1: <sha1> — - Xchecked via VT: d3ad32bcb255e56cd2a768b3cbf6bafda88233288fc6650d0dfa3810be75f74c
* md5: <md5> — - Xchecked via VT: d3ad32bcb255e56cd2a768b3cbf6bafda88233288fc6650d0dfa3810be75f74c
* email-dst: tip848@gmail.com
* email-dst: deliver@hostpenta.com.xml
* email-dst: archive@hostpenta.com.xml
* email-dst: tim11235@gmail.com
* email-dst: guess515@fastmail.fm
* email-dst: tim11235@googlemail.com
* email-dst: dude626@gmail.com
* email-dst: octo424@gmail.com
* email-dst: plars575@gmail.com
* email-dst: purge626@gmail.com
