# Threat Report: 2018-06-24: OSINT - Tick Group Weaponized Secure USB Drives to Target Air-Gapped Critical Systems


## Key Intelligence
* Date: 2018-06-24
* Threat Level: 2 (Medium)
* Tags: misp-galaxy:threat-actor="Tick", tlp:white, misp-galaxy:mitre-enterprise-attack-attack-pattern="Multi-Stage Channels - T1104", misp-galaxy:mitre-enterprise-attack-attack-pattern="Replication Through Removable Media - T1091", osint:source-type="blog-post", estimative-language:confidence-in-analytic-judgment="moderate"

---

## Indicators of Compromise (IOCs)
### Artifacts dropped
* mutex: SysMonitor_3A2DCB47
* filename: %ProgramFiles%\Windows NT\Accessories\Microsoft\msxml.exe
* filename: %UserProfile%\Applications\Microsoft\msxml.exe
* regkey|value: HKLM\Software\Microsof\Windows\CurrentVersion\run\â€xmlâ€|%ProgramFiles%\Windows NT\Accessories\Microsoft\msxml.exe
* regkey|value: HKCU\Software\Microsof\Windows\CurrentVersion\run\â€xmlâ€|%UserProfile%\Applications\Microsoft\msxml.exe

### External analysis
* text: Tick is a cyberespionage group primarily targeting organizations in Japan and the Republic of Korea. The group is known to conduct attack campaigns with various custom malware such as Minzen, Datper, Nioupale (aka Daserf), and HomamDownloader. Unit 42 last wrote about the Tick group in July 2017.

Recently, Palo Alto Networks Unit 42 discovered the Tick group targeted a specific type of secure USB drive created by a South Korean defense company. The USB drive and its management system have various features to follow security guidelines in South Korea.

The weaponization of a secure USB drive is an uncommon attack technique and likely done in an effort to spread to air-gapped systems, which are systems that do not connect to the public internet. In addition, our research shows that the malware used in these attacks will only try to infect systems running Microsoft Windows XP or Windows Server 2003. This is despite the fact that the malware appears to have been created when newer versions of Windows software were available. This would seem to indicate an intentional targeting of older, out-of-support versions of Microsoft Windows installed on systems with no internet connectivity. Air-gapped systems are common practice in many countries for government, military, and defense contractors, as well as other industry verticals.

We have not identified any public reporting on this attack, and we suspect the Tick group used the malware described in this report in attacks multiple years ago. Based on the data collected, we do not believe this malware is part of any active threat campaign.

Our picture of this past attack is incomplete at this time. Based on our research thus far, we are able to sketch out the following hypothesized attack scenario:

    The Tick Group somehow compromised a secure type of USB drive and loaded a malicious file onto an unknown number of them. These USB drives are supposed to be certified as secure by the South Korean ITSCC (English).
    The Tick Group created a specific malware we are calling SymonLoader that somehow gets on older Windows systems and continuously looks for these specific USB drives.
    SymonLoader specifically targets Windows XP and Windows Server 2003 systems ONLY.
    If SymonLoader detects the presence of a specific type of secure USB drive, it will attempt to load the unknown malicious file using APIs that directly access the file system.

In the research below, we outline our findings around SymonLoader. We do not currently have either a compromised USB drive nor the unknown malicious file we believe is implanted on these devices. Because of this we are unable to describe the full attack sequence.

Because we do not have either a compromised USB drive or the unknown malicious file, we are also unable to determine how these USB drives have been compromised. Specifically, we do not know if there has been a successful compromise in the supply-chain making these devices, or if these have been compromised post-manufacturing and distributed using other means such as social engineering.
* link: https://researchcenter.paloaltonetworks.com/2018/06/unit42-tick-group-weaponized-secure-usb-drives-target-air-gapped-critical-systems/
* attachment: tick_1.png

### Network activity
* hostname: pre.englandprevail.com — C2 of HomamDownloader

### Payload delivery
* sha256: <sha256> — Trojanized Legitimate Software
* sha256: <sha256> — Trojanized Legitimate Software
* sha256: <sha256> — Trojanized Legitimate Software
* sha256: <sha256> — Trojanized Legitimate Software
* sha256: <sha256> — HomamDownloader
* sha256: <sha256> — HomamDownloader
* sha256: <sha256> — Malformed Legitimate software
* sha256: <sha256> — SysmonLoader

## Objects
### file — File object describing a file with meta-information
* _No attributes_

### virustotal-report — VirusTotal report
* _No attributes_

### file — File object describing a file with meta-information
* _No attributes_

### virustotal-report — VirusTotal report
* _No attributes_

### file — File object describing a file with meta-information
* _No attributes_

### virustotal-report — VirusTotal report
* _No attributes_

### file — File object describing a file with meta-information
* _No attributes_

### virustotal-report — VirusTotal report
* _No attributes_

### file — File object describing a file with meta-information
* _No attributes_

### virustotal-report — VirusTotal report
* _No attributes_

### file — File object describing a file with meta-information
* _No attributes_

### virustotal-report — VirusTotal report
* _No attributes_

### file — File object describing a file with meta-information
* _No attributes_

### virustotal-report — VirusTotal report
* _No attributes_
