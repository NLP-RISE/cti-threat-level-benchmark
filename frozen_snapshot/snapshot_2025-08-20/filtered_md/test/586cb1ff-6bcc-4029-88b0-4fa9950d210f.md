# Threat Report: 2016-12-29: OSINT -  Updated Sundown Exploit Kit Uses Steganography


## Key Intelligence
* Date: 2016-12-29
* Threat Level: 3 (Low)
* Tags: tlp:white, osint:source-type="blog-post", estimative-language:likelihood-probability="very-likely", admiralty-scale:information-credibility="2", misp-galaxy:tool="Chthonic", misp-galaxy:exploit-kit="Sundown"

---

## Indicators of Compromise (IOCs)
### External analysis
* link: http://blog.trendmicro.com/trendlabs-security-intelligence/updated-sundown-exploit-kit-uses-steganography/
* comment: 2016 saw a big shift in the exploit kit landscape, with many of the bigger players unexpectedly dropping out of action. The Nuclear exploit kit operations started dwindling in May, Angler disappeared around the same time Russiaâ€™s Federal Security Service made nearly 50 arrests last June, and then Neutrino reportedly went private and shifted to focus on select clientele in September. RIG and Sundown are now the most prominent exploit kits in circulation, gaining  prominence shortly after Neutrino dropped out of active circulation.

Sundown is something of an outlier from typical exploit kits. It tends to reuse old exploits and doesnâ€™t make an effort to disguise their activity. The URLs for Sundown requests for Flash files end in .swf, while Silverlight requests end in .xap. These are the normal extensions for these file types. Typically, other exploit kits make an effort to hide their exploits. In addition, Sundown doesnâ€™t have the anti-crawling feature used by other exploit kits.

Recent use of Sundown/RIG

Sundown and RIG were both in the spotlight last September when a malvertising campaign was found to be distributing the CryLocker ransomware through the two exploit kits. Researchers first detected RIG pushing this ransomware as its payload on September 1, while Sundown started doing so on September 5. CryLocker was unique in that it used Portable Network Graphic (PNG) files to package the information stolen from the infected system. The PNG file was then uploaded to an Imgur album, where ransomware operators could access it easily while evading detection.

The developers of this particular malware gave their files a valid PNG header, but no image. The file only had the system information as ASCII strings. This makes it distinct from steganography, which hides secret messages, files, or information in an image.

Steganography Techniques used by Exploit Kits

Steganography is an advanced technique used to hide malicious code in an image to prevent signature based detection. Itâ€™s quite popular and has been used in several malvertising and exploit kit attacks. Earlier this year, the massive GooNky malvertising campaign used multiple techniques to hide their malvertising traffic, including moving part of malicious code into images to prevent detection. However, here the attackers didnâ€™t really â€œhideâ€ the data in the picture itself â€“ they merely appended their malicious code at the end of the file.

In a more advanced case, Trend Micro researchers worked with colleagues in the security community to look into the steganography tactics used in the  AdGholas malvertising campaign and its associated Astrum exploit kit. The campaign encoded a script into an imageâ€™s alpha channel, which defines the transparency of the pixels. The minor modification allows the malware designer to mimic a legitimate ad, with only a slight difference in color. This makes it more difficult for these malicious ads to be spotted and analyzed.

On December 27, 2016, we noticed that Sundown was updated to use similar techniques. The PNG files werenâ€™t just used to store harvested information; the malware designers now used steganography to hide their exploit code.
* link: https://www.virustotal.com/file/9581b02cbe553b7ca436b138d9df012d9712e81b554dbe620f1bf1bffdc09219/analysis/1483176386/ — The Chthonic sample has the following hash - Xchecked via VT: c2cd9ea5ad1061fc33adf9df68eeed6a1883c5f9

### Network activity
* hostname: xbs.q30.biz — The following domains were used by the Sundown Exploit kit with the matching IP addresses:
* ip-dst: 188.165.163.228 — The following domains were used by the Sundown Exploit kit with the matching IP addresses:
* hostname: cjf.0340.mobi — The following domains were used by the Sundown Exploit kit with the matching IP addresses:
* ip-dst: 93.190.143.211 — The following domains were used by the Sundown Exploit kit with the matching IP addresses:

### Payload delivery
* sha1: <sha1> — The Chthonic sample has the following hash
* filename: pationare.bit — The sample also used the following C&C server:
* sha256: <sha256> — The Chthonic sample has the following hash - Xchecked via VT: c2cd9ea5ad1061fc33adf9df68eeed6a1883c5f9
* md5: <md5> — The Chthonic sample has the following hash - Xchecked via VT: c2cd9ea5ad1061fc33adf9df68eeed6a1883c5f9
