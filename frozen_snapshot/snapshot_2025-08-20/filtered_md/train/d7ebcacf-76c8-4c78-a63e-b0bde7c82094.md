# Threat Report: 2023-03-09: Prometei botnet improves modules and exhibits new capabilities in recent updates


## Key Intelligence
* Date: 2023-03-09
* Threat Level: 2 (Medium)
* Tags: misp-galaxy:malpedia="Prometei", tlp:white

---

## Indicators of Compromise (IOCs)
### External analysis
* link: https://blog.talosintelligence.com/prometei-botnet-improves/

### Network activity
* ip-dst: 23.148.145.237
* ip-dst: 69.84.240.57
* ip-dst: 103.40.123.34
* ip-dst: 103.184.128.180
* ip-dst: 103.184.128.244
* ip-dst: 194.195.213.62
* ip-dst: 211.232.48.65
* ip-dst: 103.65.236.53
* ip-dst: 177.73.237.55
* ip-dst: 221.120.144.101
* hostname: p1.feefreepool.net
* hostname: p2.feefreepool.net
* hostname: p3.feefreepool.net
* domain: gb7ni5rgeexdcncj.onion
* domain: mkhkjxgchtfgu7uhofxzgoawntfzrkdccymveektqgpxrpjb72oq.zero
* url: http://23.148.145.237:180/update.7z
* url: http://69.84.240.57:180/AppServ180.zip
* url: http://103.40.123.34/k.php
* url: http://103.40.123.34/7z32.dll
* url: http://103.40.123.34/7z32.exe
* url: http://103.40.123.34/std2.7z
* url: http://103.40.123.34/dwn.php?d=rdpcIip.exe
* url: http://103.40.123.34/dwn.php?d=7z32.exe
* url: http://103.40.123.34/dwn.php?d=7z32.dll
* url: http://103.126.6.233:180/AppServ180.zip
* url: http://103.40.123.34/srch.7z
* url: http://103.40.123.34/desktop.txt
* url: http://103.40.123.34/bklocal2.php
* url: http://103.40.123.34/bklocal4.php
* url: http://103.40.123.34/update.7z
* url: http://194.195.213.62:180/srch.7z
* url: http://103.184.128.244/update.7z
* url: http://211.232.48.65:180/update.7z
* url: http://p2.feefreepool.net/cgi-bin/prometei.cgi
* url: http://mkhkjxgchtfgu7uhofxzgoawntfzrkdccymveektqgpxrpjb72oq.zero/cgi-bin/prometei.cgi
* url: https://gb7ni5rgeexdcncj.onion/cgi-bin/prometei.cgi
* url: http://mkhkjxgchtfgu7uhofxzgoawntfzrkdccymveektqgpxrpjb72oq.b32.i2p/cgi-bin/prometei.cgi

### Other
* comment: A firewall rule named “Secure Socket Tunneling Protocol (HTTP)” is executed through the “netsh” command to add “%WINDIR%\sqhost.exe” to the allowed programs list. Persistence is obtained by creating an automated system service named “UPlugPlay,” which executes sqhost.exe with the argument “Dcomsvc”.

### Payload delivery
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* filename: %WINDIR%\zsvc.exe — the primary module is downloaded from an actor-controlled server in an encrypted form through a simple XOR byte alteration pattern. Its initial location on the hard drive is “C:\windows\zsvc.exe” and is executed through the PowerShell cmdlet “Start-Process”
* filename: %WINDIR%\sqhost.exe — The original downloaded file is then renamed from “zsvc.exe” to “sqhost.exe.”

## Objects
### script — Object describing a computer program written to be run in a special run-time environment. The script or shell script can be used for malicious activities but also as support tools for threat analysts.
* [Other] text: #!/usr/bin/env python3
from datetime import datetime
import sys

def genPrometeiDomains (basedate=datetime.now(), basestring='xinchao'):
    	month = basedate.strftime("%m")
    	day_year = basedate.strftime("%d%y")
    	basedomain=''
    	generateddomains=[]
    	for i in range(len(day_year)):
        	basedomain=basedomain+chr(ord(day_year[i]) + 0x31)
   	 
    	basedomain=basedomain+chr(int(month)+0x61)
   	 
    	for i in range(16):
        	for tld in ['.net','.org','.com']:
            	domain=basestring+basedomain+chr(i + 0x61)
            	generateddomains.append(domain+tld)


    	return '\n'.join(generateddomains)


if __name__ == "__main__":
	try:
    	    print(genPrometeiDomains(datetime.fromisoformat(sys.argv[1])))
	except IndexError:
    	    print(genPrometeiDomains())
	except ValueError:
    	    print("The date must be specified using the ISO format yyyy-mm-dd")
* [Other] text: Python
* [Other] text: Prometei DGA script
