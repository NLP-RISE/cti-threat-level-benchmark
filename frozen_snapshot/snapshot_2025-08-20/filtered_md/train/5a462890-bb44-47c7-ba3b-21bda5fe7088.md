# Threat Report: 2017-12-29: Threat Analysis: Malicious Microsoft Word Documents Being Used in Targeted Attack Campaigns


## Key Intelligence
* Date: 2017-12-29
* Threat Level: 3 (Low)
* Tags: tlp:white, osint:source-type="blog-post"

---

## Indicators of Compromise (IOCs)
### External analysis
* attachment: Figure_10_fixed_for_release.jpg
* link: https://www.cobaltstrike.com/ — Payload
* link: https://www.carbonblack.com/2017/12/19/threat-analysis-malicious-microsoft-word-documents-used-targeted-attack-campaigns/
* text: A Microsoft Word document (.doc) believed to be malicious was recently submitted to Carbon Blackâ€™s Threat Analysis Unit (TAU). The submitting organization did not feel that that document (and subsequent payload) was fully executing in their analysis environment, and questioned whether or not it was actually malicious.

The submitted file was part of a targeted attack against an organization, and would not properly run unless the infected system configured for a domain that matched a hard coded pattern. The malicious carrier file contained embedded macros which would launch a series of VB scripts. Ultimately the scripts would inject a Cobalt Strike payload into a running process. While researching this variant TAU discovered numerous other variants (both .doc and .docx formats), which were written in the same manner. Only one instance contained the portion of code to ensure the script would only run at a targeted domain. All of these variants had very low coverage when run through an analysis engine, and as this technique emerges it will continue to be used in targeted attacks and eventually commoditized.

### Network activity
* domain: carbon-copy-marketing.com — Cobalt Strike C2
* domain: free-clipart-archive.com — Cobalt Strike C2
* domain: stationmovil.com — Cobalt Strike C2
* domain: www.bankingandfinanceexpert.com — Cobalt Strike C2
* domain: www.themediaeducation.com — Cobalt Strike C2
* ip-dst: 212.83.58.231 — Cobalt Strike C2

### Payload delivery
* filename: Cobalt_Strike.dll — Embedded payload
* md5: <md5>
* md5: <md5>
* md5: <md5>
* md5: <md5>
* md5: <md5>
* md5: <md5> — Embedded payload
* md5: <md5>
* sha1: <sha1> — Embedded payload
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256> — Embedded payload
* sha256: <sha256>
* sha256: <sha256>
