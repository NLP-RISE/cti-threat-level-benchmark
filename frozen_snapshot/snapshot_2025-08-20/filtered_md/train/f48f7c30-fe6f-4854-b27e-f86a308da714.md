# Threat Report: 2024-06-08: Operation Crimson Palace: Sophos threat hunting unveils multiple clusters of Chinese state-sponsored activity targeting Southeast Asian government


## Key Intelligence
* Date: 2024-06-08
* Threat Level: 2 (Medium)
* Tags: misp-galaxy:country="china", misp-galaxy:sector="Government, Administration", tlp:white

---

## Indicators of Compromise (IOCs)
### External analysis
* link: https://news.sophos.com/en-us/2024/06/05/operation-crimson-palace-sophos-threat-hunting-unveils-multiple-clusters-of-chinese-state-sponsored-activity-targeting-southeast-asia/

### Network activity
* ip-src: 146.190.93.250 — CCoreDoor C2
* ip-src: 198.13.47.158 — PocoProxy C2
* ip-src: 64.176.50.42 — PocoProxy C2
* ip-src: 158.247.241.188 — PocoProxy C2
* ip-src: 139.180.217.105 — PocoProxy C2
* ip-src: 45.130.229.181 — Cobalt Strike C2
* ip-src: 185.201.8.187 — Cobalt Strike C2
* ip-src: 89.44.197.74 — Merlin C2
* ip-src: 185.195.237.123 — RUDEBIRD C2; EAGERBEE C2
* ip-src: 195.123.247.50 — RUDEBIRD C2
* ip-src: 172.67.130.71 — PhantomNet C2
* ip-src: 45.90.58.103 — PhantomNet C2; RUDEBIRD C2
* ip-src: 185.195.237.121 — PhantomNet C2
* ip-src: 104.21.3.57 — PhantomNet C2
* ip-src: 185.82.217.164 — PhantomNet C2
* ip-src: 195.123.245.79 — PhantomNet C2
* ip-src: 154.39.137.29 — PowHeartBeat C2
* ip-src: 147.139.47.141 — PowHeartBeat C2
* ip-src: 185.167.116.30 — PhantomNet C2; EAGERBEE C2
* ip-src: 91.220.202.143 — EAGERBEE C2
* ip-src: 139.162.18.97 — dllhost.exe
* ip-src: 103.56.5.224 — swprv.dll C2
* ip-src: 49.157.28.114 — swprv.dll C2
* ip-src: 141.136.44.219 — Havoc C2
* ip-src: 145.14.158.235 — Havoc C2
* ip-src: 107.148.41.114 — Havoc C2
* ip-src: 66.42.56.233 — Havoc C2 / XiebroC2
* ip-src: 45.15.143.151 — Havoc C2
* ip-src: 198.244.237.13 — Havoc C2 payload host
* ip-src: 123.253.35.100 — swprv.dll C2
* ip-src: 178.128.221.202 — mios.exe C2
* ip-src: 192.142.18.15 — Interacted with webshell (VPN subnet)
* ip-src: 192.142.18.27 — Interacted with webshell (VPN subnet)
* ip-src: 192.142.18.25 — Dropped webshell (VPN subnet)
* ip-src: 191.96.53.132 — Havoc C2 / XiebroC2
* ip-src: 45.9.191.183 — Havoc C2 / XiebroC2
* ip-src: 45.77.46.245 — Havoc C2
* ip-src: 64.176.37.107 — Havoc C2
* domain: cloud.keepasses.com — Merlin C2
* domain: message.ooguy.com — CCoreDoor C2
* domain: gsenergyspeedtest.com — Cobalt Strike C2
* domain: hpupdate.net — Havoc C2
* domain: cancelle.net — swprv.dll C2
* domain: dmsz.org — swprv.dll C2
* domain: gandeste.net — swprv.dll C2
* domain: test1.zhangliyong.cn — Havoc C2 / XiebroC2

### Payload delivery
* sha256: <sha256> — 3.ps1 (PowerShell script)
* sha256: <sha256> — EvtxParser.exe (EVTX dump)
* sha256: <sha256> — 2.vbs (VBS script)
* sha256: <sha256> — r.vbs (VBS script)
* sha256: <sha256> — mscorsvc.dll (CCoreDoor)
* sha256: <sha256> — mscorsvc.dll (CCoreDoor)
* sha256: <sha256> — ntpsapi.dll (signed, benign, ntdll.dll used for EDR unhooking)
* sha256: <sha256> — sslwnd64.exe (PhantomNet)
* sha256: <sha256> — sslwnd64.exe (PhantomNet)
* sha256: <sha256> — nethood.exe (PhantomNet)
* sha256: <sha256> — oci.dll (PhantomNet)
* sha256: <sha256> — X64.dll (PhantomNet, renamed to oci.dll)
* sha256: <sha256> — wlbsctrl.dll (EAGERBEE)
* sha256: <sha256> — TSVIPSrv.dll (EAGERBEE)
* sha256: <sha256> — TSVIPSrv.dll (EAGERBEE)
* sha256: <sha256> — C:\ProgramData\Microsoft\DeviceSync\jli.dll (EAGERBEE)
* sha256: <sha256> — C:\ProgramData\Microsoft\Vault\vmnat.dll (Merlin)
* sha256: <sha256> — pc2msupp.dll (Malicious DLL sideloaded by MOBPOPUP.exe)
* sha256: <sha256> — MSI64.exe (RUDEBIRD)
* sha256: <sha256> — ba0oddof.dll (CSC compilation artifact from 1.ps1 execution)
* sha256: <sha256> — SophosUD.exe (PowHeartBeat)
* sha256: <sha256> — SophosUD.exe (PowHeartBeat)
* sha256: <sha256> — SophosUD2.exe (PowHeartBeat)
* sha256: <sha256> — SensAPI.dll (Malicious DLL sideloaded by ph.exe)
* sha256: <sha256> — C:\ProgramData\Microsoft\Windows\svcchost.dll (Malicious DLL sideloaded by renamed vmnat.exe, svcchost.exe)
* sha256: <sha256> — a8.txt (PocoProxy)
* sha256: <sha256> — s.dat (Malicious file)
* sha256: <sha256> — msedge_elf.dll (HUI Loader)
* sha256: <sha256> — hideschtasks.exe (Custom binary; remotely creates scheduled tasks)
* sha256: <sha256> — log.ini (Masquerading DLL generating C2)
* sha256: <sha256> — 11.log (LSASS credential interceptor)
* sha256: <sha256> — 1.dat (Cobalt Strike)
* sha256: <sha256> — sssa.exe (Malicious file)
* sha256: <sha256> — McPvNs.dll (Malicious DLL sideloaded by McPvTray.exe)
* sha256: <sha256> — rsndispot.sys , EDR evasion
* sha256: <sha256> — rspot.sys, EDR evasion
* sha256: <sha256> — tpyrced_ambs.exe
* sha256: <sha256> — 443.txt (PocoProxy)
* sha256: <sha256> — 4413.txt (PocoProxy)
* sha256: <sha256> — chrome.log (PocoProxy)
* sha256: <sha256> — textinputhost.exe (renamed rc.exe)
* sha256: <sha256> — TextInputHost.dat
* sha256: <sha256> — sc.cfg
* sha256: <sha256> — appmgmt.dll (Stowaway)
* sha256: <sha256> — check.exe (NUPAKAGE)
* sha256: <sha256> — appmgmt.dll (Stowaway)
* sha256: <sha256> — swprvs.dll
* sha256: <sha256> — winbridge.dll
* sha256: <sha256> — C:\ProgramData\mios.exe (Malicious File) used in conjuction with cmdline containing  '172.19.120.60 65211' and '178.128.221.202 443'
* sha256: <sha256> — C:\Windows\Help\Help\mscorsvc.dll (Malicious DLL)
* sha256: <sha256> — C:\ProgramData\mscorsvc.dll (Malicious DLL)
* sha256: <sha256> — C:\Windows\Temp\ntpsapi.dll (EDR unhooking, benign version of ntdll.dll)
* sha256: <sha256> — C:\windows\syswow64\WWindows.Data.Devices.Config.dll (SharpHound/BloodHound)
* sha256: <sha256> — locale.nlp (ATK/DonutLdr-A)
* sha256: <sha256> — C:\Windows\debug\net.LOG (Havoc)
* sha256: <sha256> — swprv.dll (Malicious DLL sideloaded by swprv service)
* sha256: <sha256> — iscsiexe.dll (MSiSCSI payload)
* sha256: <sha256> — version.dll (Malicious DLL sideloaded by swi_update.exe)
* sha256: <sha256> — DecrptDumper.exe (Malicious File, no execution data)
* sha256: <sha256> — c:\windows\help\prow.xml (Havoc)
* sha256: <sha256> — ~docpdf.tmp (Havoc)
* sha256: <sha256> — C:/PerfLogs/libcef.dll (Havoc)
* sha256: <sha256> — <REDACTED>DOC20231100001603KMAP.pdf (webshell)
* sha256: <sha256> — C:/Windows/System32/wbem/ncobjapi.dll
* sha256: <sha256> — <REDACTED>DOC20231200001924KMAP.aspx
* sha256: <sha256> — 111 (Shellcode loader)
* sha256: <sha256> — C:/Windows/Vss/Writers/Application/libcef.dll (Shellcode Loader for Havoc)
* sha256: <sha256> — C:/Windows/Vss/Writers/Application/libcef.dll (Shellcode Loader for Havoc)
* sha256: <sha256> — <REDACTED>DOC20231200001922KMAP.asp (webshell)
* sha256: <sha256> — <REDACTED>DOC20231200002062KMAP.php (webshell)
* sha256: <sha256> — log.ini (Havoc)
* sha256: <sha256> — 1.exe (Invoke WMI)
* sha256: <sha256> — msedge_elf.dll (Shellcode Loader, Havoc)
* sha256: <sha256> — chrome.exe (Shellcode Loader, Havoc)
* sha256: <sha256> — msedge_elf.dll (Shellcode Loader, Havoc)
* sha256: <sha256> — C:/ProgramData/conhost.exe (Alcatraz Git Project EDR Evasion)
* sha256: <sha256> — C:\Windows\Vss\Writers\Application\libcef.dll
* sha256: <sha256> — C:\Windows\Vss\Writers\libcef.dll
* sha256: <sha256> — C:\PerfLogs\vcruntime140.dll
* sha256: <sha256> — C:\PerfLogs\jli.dll
* sha256: <sha256> — C:\PerfLogs\pt.exe (unsigned executable with certificate stating that it is MS Edge)
* sha256: <sha256> — C:\Users\Public\r2.exe (Unknown threat file)
* sha256: <sha256> — C:\PerfLogs\msedge_elf.dll
