# Threat Report: 2019-07-04: OSINT - Threat Spotlight: Ratsnif - New Network Vermin from OceanLotus


## Key Intelligence
* Date: 2019-07-04
* Threat Level: 3 (Low)
* Tags: misp-galaxy:threat-actor="APT32", misp-galaxy:mitre-attack-pattern="Commonly Used Port - T1043", misp-galaxy:mitre-attack-pattern="Custom Command and Control Protocol - T1094", type:OSINT, osint:lifetime="perpetual", tlp:white, osint:source-type="blog-post", osint:certainty="93", estimative-language:confidence-in-analytic-judgment="high", workflow:todo="review-for-privacy"

---

## Indicators of Compromise (IOCs)
### External analysis
* link: https://threatvector.cylance.com/en_us/home/threat-spotlight-ratsnif-new-network-vermin-from-oceanlotus.html
* text: The OceanLotus Group (aka APT32, CobaltKitty | previous reports: The SpyRATs of OceanLotus; OceanLotus APT Group Leveraging Steganography) is using a suite of remote access trojans dubbed "Ratsnif" to leverage new network attack capabilities. Blackberry Cylance threat researchers have analyzed the Ratsnif trojans, which offer a veritable swiss-army knife of network attack techniques. The trojans, under active development since 2016, combine capabilities like packet sniffing, gateway/device ARP poisoning, DNS poisoning, HTTP injection, and MAC spoofing. 

We delved into four distinct Ratsnif samples, three of them developed in 2016, the fourth created during the latter half of 2018.

### Network activity
* hostname: search.webstie.net
* hostname: dns.domain-resolve.org
* ip-src: 66.85.185.126 — Attribute #7545884 enriched by dns.

### Payload delivery
* md5: <md5>
* attachment: Fig0-ratsnif.jpeg — Passive total
* sha256: <sha256>
* sha256: <sha256>

## Objects
### file — File object describing a file with meta-information
* [Payload delivery] md5: <md5>
* [Payload delivery] sha1: <sha1>
* [Payload delivery] sha256: <sha256>

### virustotal-report — VirusTotal report
* [Other] datetime: 2019-07-03T15:11:12
* [Payload delivery] link: https://www.virustotal.com/file/b4e3b2a1f1e343d14af8d812d4a29440940b99aaf145b5699dfe277b5bfb8405/analysis/1562166672/
* [Payload delivery] text: 21/69

### file — File object describing a file with meta-information
* [Payload delivery] malware-sample: b4e3b2a1f1e343d14af8d812d4a29440940b99aaf145b5699dfe277b5bfb8405|516ad28f8fa161f086be7ca122351edf
* [Payload delivery] filename: javaw.exe
* [Payload delivery] filename: Client.exe
* [Payload delivery] md5: <md5>
* [Payload delivery] sha256: <sha256>
* [Other] text: X:\Project\BotFrame\Debug\Client.exe
* [Other] size-in-bytes: 1387520

### file — File object describing a file with meta-information
* [Payload delivery] malware-sample: b214c7a127cb669a523791806353da5c5c04832f123a0a6df118642eee1632a3|b2f8c9ce955d4155d466fbbb7836e08b
* [Payload delivery] filename: b214c7a127cb669a523791806353da5c5c04832f123a0a6df118642eee1632a3
* [Payload delivery] md5: <md5>
* [Payload delivery] sha1: <sha1>
* [Payload delivery] sha256: <sha256>
* [Other] size-in-bytes: 1387520

### file — File object describing a file with meta-information
* [Payload delivery] malware-sample: b214c7a127cb669a523791806353da5c5c04832f123a0a6df118642eee1632a3|b2f8c9ce955d4155d466fbbb7836e08b
* [Payload delivery] filename: b214c7a127cb669a523791806353da5c5c04832f123a0a6df118642eee1632a3
* [Payload delivery] md5: <md5>

### file — File object describing a file with meta-information
* [Payload delivery] malware-sample: b214c7a127cb669a523791806353da5c5c04832f123a0a6df118642eee1632a3|b2f8c9ce955d4155d466fbbb7836e08b
* [Payload delivery] filename: b214c7a127cb669a523791806353da5c5c04832f123a0a6df118642eee1632a3
* [Payload delivery] md5: <md5>
* [Payload delivery] sha1: <sha1>
* [Payload delivery] sha256: <sha256>
* [Other] size-in-bytes: 1387520

### file — File object describing a file with meta-information
* [Payload delivery] malware-sample: b20327c03703ebad191c0ba025a3f26494ff12c5908749e33e71589ae1e1f6b3|7f0ac1b4e169edc62856731953dad126
* [Payload delivery] filename: b20327c03703ebad191c0ba025a3f26494ff12c5908749e33e71589ae1e1f6b3
* [Payload delivery] md5: <md5>
* [Payload delivery] sha1: <sha1>
* [Payload delivery] sha256: <sha256>
* [Other] size-in-bytes: 442880

### virustotal-report — VirusTotal report
* [Other] datetime: 2019-07-03T15:12:45
* [Payload delivery] link: https://www.virustotal.com/file/b20327c03703ebad191c0ba025a3f26494ff12c5908749e33e71589ae1e1f6b3/analysis/1562166765/
* [Payload delivery] text: 27/69

### virustotal-report — VirusTotal report
* [Other] datetime: 2019-07-03T05:43:22
* [Payload delivery] link: https://www.virustotal.com/file/b214c7a127cb669a523791806353da5c5c04832f123a0a6df118642eee1632a3/analysis/1562132602/
* [Payload delivery] text: 17/67

### url — url object describes an url along with its normalized field (like extracted using faup parsing library) and its metadata.
* [Other] text: http
* [Other] text: /cl_client_online.php — POST containing harvested system information
* [Other] text: /cl_client_cmd.php — GET C2 command
* [Other] text: /cl_client_cmd_res.php — POST result of C2 command
* [Other] text: /cl_client_logs.php — POST log message

### file — File object describing a file with meta-information
* [Payload delivery] md5: <md5>
* [Payload delivery] sha1: <sha1>
* [Payload delivery] sha256: <sha256>

### virustotal-report — VirusTotal report
* [Other] datetime: 2019-07-04T14:54:29
* [Payload delivery] link: https://www.virustotal.com/file/7fd526e1a190c10c060bac21de17d2c90eb2985633c9ab74020a2b78acd8a4c8/analysis/1562252069/
* [Payload delivery] text: 48/66

### virustotal-report — VirusTotal report
* [Other] datetime: 2019-07-04T14:53:20
* [Payload delivery] link: https://www.virustotal.com/file/b214c7a127cb669a523791806353da5c5c04832f123a0a6df118642eee1632a3/analysis/1562252000/
* [Payload delivery] text: 26/66
