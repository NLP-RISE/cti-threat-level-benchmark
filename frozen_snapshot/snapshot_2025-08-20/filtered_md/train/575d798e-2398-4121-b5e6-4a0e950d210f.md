# Threat Report: 2016-06-12: OSINT - Reverse-engineering DUBNIUM


## Key Intelligence
* Date: 2016-06-12
* Threat Level: 3 (Low)
* Tags: type:OSINT, tlp:white

---

## Indicators of Compromise (IOCs)
### External analysis
* link: https://blogs.technet.microsoft.com/mmpc/2016/06/09/reverse-engineering-dubnium-2/
* comment: DUBNIUM (which shares indicators with what Kaspersky researchers have called DarkHotel) is one of the activity groups that has been very active in recent years, and has many distinctive features.

We located multiple variants of multiple-stage droppers and payloads in the last few months, and although they are not really packed or obfuscated in a conventional way, they use their own methods and tactics of obfuscation and distraction.

In this blog, we will focus on analysis of the first-stage payload of the malware.

As the code is very complicated and twisted in many ways, it is a complex task to reverse-engineer the malware. The complexity of the malware includes linking with unrelated code statically (so that their logic can hide in a big, benign code dump) and excessive use of an in-house encoding scheme. Their bootstrap logic is also hidden in plain sight, such that it might be easy to miss.

Every sub-routine from the malicious code has a â€œmemory cleaner routineâ€ when the logic ends. The memory snapshot of the process will not disclose many more details than the static binary itself.

The malware is also very sneaky and sensitive to dynamic analysis. When it detects the existence of analysis toolsets, the executable file bails out from further execution. Even binary instrumentation tools like PIN or DynamoRio prevent the malware from running. This effectively defeats many automation systems that rely on at least one of the toolsets they check to avoid. Avoiding these toolsets during analysis makes the overall investigation even more complex.

With this blog series, we want to discuss some of the simple techniques and tactics weâ€™ve used to break down the features of DUBNIUM.

We acquired multiple versions of DUBNIUM droppers through our daily operations. They are evolving slowly, but basically their features have not changed over the last few months.

In this blog, weâ€™ll be using sample SHA1: dc3ab3f6af87405d889b6af2557c835d7b7ed588 in our examples and analysis.
* link: https://www.virustotal.com/file/839baf85de657b6d6503b6f94054efa8841f667987a9c805eab94a85a859e1ba/analysis/1465591410/ — We discovered the following in relation to DUBNIUM - Xchecked via VT: df793d097017b90bc9d7da9a85f929422004f6b6
* link: https://www.virustotal.com/file/5246899b8c74a681e385cbc1dd556f9c73cf55f2a0074c389b3bf823bfc6ce4b/analysis/1447106132/ — We discovered the following in relation to DUBNIUM - Xchecked via VT: c9cd559ed73a0b066b48090243436103eb52cc45
* link: https://www.virustotal.com/file/5f07b074414513b73e202d7f77ec4bcf048f13dd735c9be3afcf25be818dc8e0/analysis/1457628585/ — We discovered the following in relation to DUBNIUM - Xchecked via VT: a3bcaecf62d9bc92e48b703750b78816bc38dbe8
* link: https://www.virustotal.com/file/16f0b05d5e8546ab1504b07b0eaa0e8de14bca7c1555fd114c4c1c51d5a4c06b/analysis/1465591409/ — We discovered the following in relation to DUBNIUM - Xchecked via VT: 8ff7f64356f7577623bf424f601c7fa0f720e5fb
* link: https://www.virustotal.com/file/1feaad03f6c0b57f5f5b02aef668e26001e5a7787bb51966d50c8fcf344fb4e8/analysis/1465591409/ — We discovered the following in relation to DUBNIUM - Xchecked via VT: 6e74da35695e7838456f3f719d6eb283d4198735
* link: https://www.virustotal.com/file/bd780f4d56214c78045454d31d83ae18ed209cc138e75d138e72976a7ef9803f/analysis/1452178803/ — We discovered the following in relation to DUBNIUM - Xchecked via VT: 561db51eba971ab4afe0a811361e7a678b8f8129
* link: https://www.virustotal.com/file/a25715108d2859595959879ff50085bc85969e9473ecc3d26dda24c4a17822c9/analysis/1455833470/ — We discovered the following in relation to DUBNIUM - Xchecked via VT: 4627cff4cd90dc47df5c4d53480101bdc1d46720
* link: https://www.virustotal.com/file/41ecd81bc7df4b47d713e812f2b7b38d3ac4b9dcdc13dd5ca61763a4bf300dcf/analysis/1454552583/ — We discovered the following in relation to DUBNIUM - Xchecked via VT: 1949a9753df57eec586aeb6b4763f92c0ca6a895
* link: https://www.virustotal.com/file/e0918072d427d12b43f436bf0797a361996ae436047d4ef8277f11caf2dd481b/analysis/1453000012/ — We discovered the following in relation to DUBNIUM - Xchecked via VT: 0ac65c60ad6f23b2b2f208e5ab8be0372371e4b3
* link: https://www.virustotal.com/file/f529a10126b83157e403742c8c7c90742a490a24270cb137b372ba84e5977d78/analysis/1458803118/ — We discovered the following in relation to DUBNIUM - Xchecked via VT: b42ca359fe942456de14283fd2e199113c8789e6
* link: https://www.virustotal.com/file/e0362d319a8d0e13eda782a0d8da960dd96043e6cc3500faeae521d1747576e5/analysis/1465591407/ — We discovered the following in relation to DUBNIUM - Xchecked via VT: aee8d6f39e4286506cee0c849ede01d6f42110cc
* link: https://www.virustotal.com/file/caefcdf2b4e5a928cdf9360b70960337f751ec4a5ab8c0b75851fc9a1ab507a8/analysis/1465591410/ — We discovered the following in relation to DUBNIUM - Xchecked via VT: ebccb1e12c88d838db15957366cee93c079b5a8e
* link: https://www.virustotal.com/file/77ca1148503def0d8e9674a37e1388e5c910da4eda9685eabe68fd0ee227b727/analysis/1465591408/ — We discovered the following in relation to DUBNIUM - Xchecked via VT: cad21e4ae48f2f1ba91faa9f875816f83737bcaf
* link: https://www.virustotal.com/file/a77d1c452291a6f2f6ed89a4bac88dd03d38acde709b0061efd9f50e6d9f3827/analysis/1465591406/ — We discovered the following in relation to DUBNIUM - Xchecked via VT: 7f9ecfc95462b5e01e233b64dcedbcf944e97fca
* link: https://www.virustotal.com/file/8ca8067dfef13f10e657d299b517008ad7523aacf7900a1afeb0a8508a6e11d3/analysis/1454911986/ — We discovered the following in relation to DUBNIUM - Xchecked via VT: 09b022ef88b825041b67da9c9a2588e962817f6d

### Payload delivery
* sha1: <sha1> — We discovered the following in relation to DUBNIUM
* sha1: <sha1> — We discovered the following in relation to DUBNIUM
* sha1: <sha1> — We discovered the following in relation to DUBNIUM
* sha1: <sha1> — We discovered the following in relation to DUBNIUM
* sha1: <sha1> — We discovered the following in relation to DUBNIUM
* sha1: <sha1> — We discovered the following in relation to DUBNIUM
* sha1: <sha1> — We discovered the following in relation to DUBNIUM
* sha1: <sha1> — We discovered the following in relation to DUBNIUM
* sha1: <sha1> — We discovered the following in relation to DUBNIUM
* sha1: <sha1> — We discovered the following in relation to DUBNIUM
* sha1: <sha1> — We discovered the following in relation to DUBNIUM
* sha1: <sha1> — We discovered the following in relation to DUBNIUM
* sha1: <sha1> — We discovered the following in relation to DUBNIUM
* sha1: <sha1> — We discovered the following in relation to DUBNIUM
* sha1: <sha1> — We discovered the following in relation to DUBNIUM
* sha1: <sha1> — We discovered the following in relation to DUBNIUM
* sha1: <sha1> — We discovered the following in relation to DUBNIUM
* sha1: <sha1> — We discovered the following in relation to DUBNIUM
* sha1: <sha1> — We discovered the following in relation to DUBNIUM
* sha256: <sha256> — We discovered the following in relation to DUBNIUM - Xchecked via VT: df793d097017b90bc9d7da9a85f929422004f6b6
* md5: <md5> — We discovered the following in relation to DUBNIUM - Xchecked via VT: df793d097017b90bc9d7da9a85f929422004f6b6
* sha256: <sha256> — We discovered the following in relation to DUBNIUM - Xchecked via VT: c9cd559ed73a0b066b48090243436103eb52cc45
* md5: <md5> — We discovered the following in relation to DUBNIUM - Xchecked via VT: c9cd559ed73a0b066b48090243436103eb52cc45
* sha256: <sha256> — We discovered the following in relation to DUBNIUM - Xchecked via VT: a3bcaecf62d9bc92e48b703750b78816bc38dbe8
* md5: <md5> — We discovered the following in relation to DUBNIUM - Xchecked via VT: a3bcaecf62d9bc92e48b703750b78816bc38dbe8
* sha256: <sha256> — We discovered the following in relation to DUBNIUM - Xchecked via VT: 8ff7f64356f7577623bf424f601c7fa0f720e5fb
* md5: <md5> — We discovered the following in relation to DUBNIUM - Xchecked via VT: 8ff7f64356f7577623bf424f601c7fa0f720e5fb
* sha256: <sha256> — We discovered the following in relation to DUBNIUM - Xchecked via VT: 6e74da35695e7838456f3f719d6eb283d4198735
* md5: <md5> — We discovered the following in relation to DUBNIUM - Xchecked via VT: 6e74da35695e7838456f3f719d6eb283d4198735
* sha256: <sha256> — We discovered the following in relation to DUBNIUM - Xchecked via VT: 561db51eba971ab4afe0a811361e7a678b8f8129
* md5: <md5> — We discovered the following in relation to DUBNIUM - Xchecked via VT: 561db51eba971ab4afe0a811361e7a678b8f8129
* sha256: <sha256> — We discovered the following in relation to DUBNIUM - Xchecked via VT: 4627cff4cd90dc47df5c4d53480101bdc1d46720
* md5: <md5> — We discovered the following in relation to DUBNIUM - Xchecked via VT: 4627cff4cd90dc47df5c4d53480101bdc1d46720
* sha256: <sha256> — We discovered the following in relation to DUBNIUM - Xchecked via VT: 1949a9753df57eec586aeb6b4763f92c0ca6a895
* md5: <md5> — We discovered the following in relation to DUBNIUM - Xchecked via VT: 1949a9753df57eec586aeb6b4763f92c0ca6a895
* sha256: <sha256> — We discovered the following in relation to DUBNIUM - Xchecked via VT: 0ac65c60ad6f23b2b2f208e5ab8be0372371e4b3
* md5: <md5> — We discovered the following in relation to DUBNIUM - Xchecked via VT: 0ac65c60ad6f23b2b2f208e5ab8be0372371e4b3
* sha256: <sha256> — We discovered the following in relation to DUBNIUM - Xchecked via VT: b42ca359fe942456de14283fd2e199113c8789e6
* md5: <md5> — We discovered the following in relation to DUBNIUM - Xchecked via VT: b42ca359fe942456de14283fd2e199113c8789e6
* sha256: <sha256> — We discovered the following in relation to DUBNIUM - Xchecked via VT: aee8d6f39e4286506cee0c849ede01d6f42110cc
* md5: <md5> — We discovered the following in relation to DUBNIUM - Xchecked via VT: aee8d6f39e4286506cee0c849ede01d6f42110cc
* sha256: <sha256> — We discovered the following in relation to DUBNIUM - Xchecked via VT: ebccb1e12c88d838db15957366cee93c079b5a8e
* md5: <md5> — We discovered the following in relation to DUBNIUM - Xchecked via VT: ebccb1e12c88d838db15957366cee93c079b5a8e
* sha256: <sha256> — We discovered the following in relation to DUBNIUM - Xchecked via VT: cad21e4ae48f2f1ba91faa9f875816f83737bcaf
* md5: <md5> — We discovered the following in relation to DUBNIUM - Xchecked via VT: cad21e4ae48f2f1ba91faa9f875816f83737bcaf
* sha256: <sha256> — We discovered the following in relation to DUBNIUM - Xchecked via VT: 7f9ecfc95462b5e01e233b64dcedbcf944e97fca
* md5: <md5> — We discovered the following in relation to DUBNIUM - Xchecked via VT: 7f9ecfc95462b5e01e233b64dcedbcf944e97fca
* sha256: <sha256> — We discovered the following in relation to DUBNIUM - Xchecked via VT: 09b022ef88b825041b67da9c9a2588e962817f6d
* md5: <md5> — We discovered the following in relation to DUBNIUM - Xchecked via VT: 09b022ef88b825041b67da9c9a2588e962817f6d
