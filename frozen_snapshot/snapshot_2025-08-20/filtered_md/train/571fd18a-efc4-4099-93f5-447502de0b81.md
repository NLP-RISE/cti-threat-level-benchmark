# Threat Report: 2016-04-26: OSINT - Macro Malware Employs Advanced Obfuscation to Avoid Detection


## Key Intelligence
* Date: 2016-04-26
* Threat Level: 3 (Low)
* Tags: tlp:white, type:OSINT

---

## Indicators of Compromise (IOCs)
### External analysis
* link: https://www.virustotal.com/file/25f7bf9246534c7aad3b728c0bad60dd62e31d9bd7695de8ac0ec7ec0270f104/analysis/1461421247/ — - Xchecked via VT: c1787d80ad7beb46646d5c20cdd7eff2
* link: https://www.virustotal.com/file/1fcdc054fbd0ecefbb895502d271c94e4733dbb5dc0a0152d8d4864ce82cd916/analysis/1461421238/ — - Xchecked via VT: d80c15fd4ee1b10512d81bde32daaf30
* link: https://blogs.mcafee.com/mcafee-labs/macro-malware-employs-advanced-obfuscation-to-avoid-detection/
* comment: Attacks by macro malware carrying ransomware are growing, as we have recently reported on Blog Central here and here. Now McAfee Labs researchers have witnessed a new variant of macro malware that employs fudging techniques such as virtual machine awareness, sandbox awareness, and more.

Since early March we have seen macro malware using high-obfuscation algorithms to protect itself from static and traditional antimalware detection techniques. These algorithms do not change frequently; we noticed updates only over a period of one month. This slow evolution suggests that the actors are able to sustain their binaries with few changes. So far we have seen three obfuscating algorithms deployed in such malware. The version we noticed in mid-April was quite interesting; here is our analysis.

This new variant of macro malware not only has high-level obfuscation techniques but also several layers of evasion. In addition to obfuscation, the functions are scattered across the macros. I have converted the obfuscation algorithm to an equivalent Python and the scripts used for evasion techniques into VBA scripts for easy understanding.

### Payload installation
* md5: <md5>
* md5: <md5>
* sha256: <sha256> — - Xchecked via VT: c1787d80ad7beb46646d5c20cdd7eff2
* sha1: <sha1> — - Xchecked via VT: c1787d80ad7beb46646d5c20cdd7eff2
* sha256: <sha256> — - Xchecked via VT: d80c15fd4ee1b10512d81bde32daaf30
* sha1: <sha1> — - Xchecked via VT: d80c15fd4ee1b10512d81bde32daaf30
