# Threat Report: 2019-01-19: OSINT - Malware Used by “Rocke” Group Evolves to Evade Detection by Cloud Security Products


## Key Intelligence
* Date: 2019-01-19
* Threat Level: 3 (Low)
* Tags: misp-galaxy:tool="Xbash", type:OSINT, osint:lifetime="perpetual", osint:certainty="50", tlp:white

---

## Indicators of Compromise (IOCs)
### External analysis
* link: https://unit42.paloaltonetworks.com/malware-used-by-rocke-group-evolves-to-evade-detection-by-cloud-security-products/
* text: Palo Alto Networks Unit 42 recently captured and investigated new samples of the Linux coin mining malware used by the Rocke group. The family was suspected to be developed by the Iron cybercrime group and it’s also associated with the Xbash malware we reported on in September of 2018. The threat actor Rocke was originally revealed by Talos in August of 2018 and many remarkable behaviors were disclosed in their blog post. The samples described in this report were collected in October of 2018, and since that time the command and control servers they use have been shut down.

During our analysis, we realized that these samples used by the Rocke group adopted new code to uninstall five different cloud security protection and monitoring products from compromised Linux servers. In our analysis, these attacks did not compromise these security products: rather, the attacks first gained full administrative control over the hosts and then abused that full administrative control to uninstall these products in the same way a legitimate administrator would.

These products were developed by Tencent Cloud and Alibaba Cloud (Aliyun), the two leading cloud providers in China that are expanding their business globally. To the best of our knowledge, this is the first malware family that developed the unique capability to target and remove cloud security products. This also highlights a new challenge for products in the Cloud Workload Protection Platforms market defined by Gartner.

### Network activity
* hostname: dwn.rundll32.ml — Domain for C2 Communication
* hostname: www.aybc.so — Domain for C2 Communication
* hostname: a.ssvs.space — Domain for C2 Communication
* domain: sydwzl.cn — Domain for C2 Communication
* ip-dst: 118.24.150.172 — Tencent Cloud
* ip-dst: 120.55.54.65 — Alibaba Cloud
* url: https://pastebin.com/raw/CnPtQ2tM — URL for Code Update
* url: https://pastebin.com/raw/rjPGgXQE — URL for Code Update
* url: https://pastebin.com/raw/1NtRkBc3 — URL for Code Update
* url: https://pastebin.com/raw/tRxfvbYN — URL for Code Update
* url: https://pastebin.com/raw/SSCy7mY7 — URL for Code Update
* url: https://pastebin.com/raw/VVt27LeH — URL for Code Update
* url: https://pastebin.com/raw/Fj2YdETv — URL for Code Update
* url: https://pastebin.com/raw/JNPewK6r — URL for Code Update
* url: https://pastebin.com/raw/TzBeq3AM — URL for Code Update
* url: https://pastebin.com/raw/eRkrSQfE — URL for Code Update
* url: https://pastebin.com/raw/5bjpjvLP — URL for Code Update
* url: https://pastebin.com/raw/Gw7mywhC — URL for Code Update

### Payload delivery
* sha256: <sha256> — Sample with the evasion behavior
* sha256: <sha256> — Sample with the evasion behavior
* sha256: <sha256> — Sample with the evasion behavior
* sha256: <sha256> — Sample with the evasion behavior
* sha256: <sha256> — Sample with the evasion behavior
* sha256: <sha256> — Sample with the evasion behavior
* sha256: <sha256> — Sample with the evasion behavior
* sha256: <sha256> — Sample with the evasion behavior
* sha256: <sha256> — Sample with the evasion behavior
* sha256: <sha256> — Sample with the evasion behavior
* sha256: <sha256> — Sample with the evasion behavior
* sha256: <sha256> — Sample with the evasion behavior
