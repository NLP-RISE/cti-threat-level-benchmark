# Threat Report: 2016-04-22: OSINT - Teaching an old RAT new tricks


## Key Intelligence
* Date: 2016-04-22
* Threat Level: 3 (Low)
* Tags: tlp:white, type:OSINT

---

## Indicators of Compromise (IOCs)
### External analysis
* link: https://www.sentinelone.com/blogs/teaching-an-old-rat-new-tricks/
* comment: Attackers have been successfully deploying RATs for years to remotely control users systems - giving them full access to the victimâ€™s files or resources such as cameras, recording key strokes, or downloading further malware.  Traditionally RATs have been deployed when a user opens an email attachment, or downloads a file from a website or peer-to-peer network.  In both cases, these vectors involve use of files to deliver the payload - which are easier to detect.

Recently we detected a more sophisticated technique that a handful of countries across Asia are actively using to infect systems with RATs.  This new technique ensures that the payload/file remains in memory through its execution, never touching the disk in a de-encrypted state.  In doing so, the attacker can remain out of view from antivirus technologies, and even â€˜next-generationâ€™ technologies that only focus on file-based threat vectors.  Also, the samples analyzed have the ability detect the presence of a virtual machine to ensure itâ€™s not being analyzed in a network sandbox.

And finally itâ€™s important to highlight that the RAT itself is not new.  In fact this technique can be used to deliver any â€œknownâ€ RAT to a victimâ€™s system.  We analyzed this sample against our SentinelOne EPP to confirm is does not evade our behavior-based detection mechanisms.  This is due to the fact that weâ€™re monitoring all processes at the user-space/kernel-space interface - and because all communication between the application and the kernel must be unencrypted, we detect the sample at both process-injection points.
* link: https://www.virustotal.com/file/b7cfc7e9551b15319c068aae966f8a9ff563b522ed9b1b42d19c122778e018c8/analysis/1461260966/
* link: https://www.virustotal.com/file/755f49a4ffef5b1b62f4b5a5de279868c0c1766b528648febf76628f1fe39050/analysis/1460984076/
* link: https://www.virustotal.com/file/51142d1fb6c080b3b754a92e8f5826295f5da316ec72b480967cbd68432cede1/analysis/1455165681/
* link: https://www.virustotal.com/file/e707a7745e346c5df59b5aa4df084574ae7c204f4fb7f924c0586ae03b79bf06/analysis/1461269734/

### Network activity
* hostname: azona2015.chickenkiller.com — On port 1617
* hostname: azona.chickenkiller.com — On port 1617

### Payload delivery
* sha256: <sha256> — Win32 PE .NET 2.0 - Samples Analyzed
* sha1: <sha1> — Win32 PE .NET 2.0 - Samples Analyzed - Xchecked via VT: b7cfc7e9551b15319c068aae966f8a9ff563b522ed9b1b42d19c122778e018c8
* md5: <md5> — Win32 PE .NET 2.0 - Samples Analyzed - Xchecked via VT: b7cfc7e9551b15319c068aae966f8a9ff563b522ed9b1b42d19c122778e018c8

### Payload installation
* md5: <md5> — Packed "Benchmark" DLL
* md5: <md5> — Monitor (PerfWatson.exe)
* md5: <md5> — NanoCore RAT dumped from memory
* sha256: <sha256> — NanoCore RAT dumped from memory - Xchecked via VT: d740ed3f33ca4cef3a6aa717f94bf52a
* sha1: <sha1> — NanoCore RAT dumped from memory - Xchecked via VT: d740ed3f33ca4cef3a6aa717f94bf52a
* sha256: <sha256> — Monitor (PerfWatson.exe) - Xchecked via VT: 9e05fb115bd4e85cfc0e32c72aa721be
* sha1: <sha1> — Monitor (PerfWatson.exe) - Xchecked via VT: 9e05fb115bd4e85cfc0e32c72aa721be
* sha256: <sha256> — Packed "Benchmark" DLL - Xchecked via VT: e5c71180f117270538487cd9b9b1b6d8
* sha1: <sha1> — Packed "Benchmark" DLL - Xchecked via VT: e5c71180f117270538487cd9b9b1b6d8
