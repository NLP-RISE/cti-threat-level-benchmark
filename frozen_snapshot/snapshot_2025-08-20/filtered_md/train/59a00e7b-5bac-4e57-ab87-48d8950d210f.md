# Threat Report: 2017-08-25: OSINT - WAP-billing Trojan-Clickers on rise


## Key Intelligence
* Date: 2017-08-25
* Threat Level: 3 (Low)
* Tags: tlp:white, enisa:nefarious-activity-abuse="mobile-malware"

---

## Indicators of Compromise (IOCs)
### External analysis
* link: https://securelist.com/wap-billing-trojan-clickers-on-rise/81576/
* text: During the preparation of the â€œIT threat evolution Q2 2017â€ report I found several common Trojans in the â€œTop 20 mobile malware programsâ€ list that were stealing money from users using WAP-billing â€“ a form of mobile payment that charges costs directly to the userâ€™s mobile phone bill so they donâ€™t need to register a card or set up a user-name and password. This mechanism is similar to premium rate SMS messages but Trojans do not need to send any SMS in this case â€“ they just need to click on a button on a web-page with WAP-billing.

From userâ€™s perspective a page with WAP-billing looks like regular web-page. Usually such pages contain complete information about payments and a button. By clicking on this button user will be redirected to a mobile network operator server, which may show additional information and request userâ€™s final decision about payment by clicking on another button. If the user connects to the Internet through mobile data, the mobile network operator can identify him/her by IP address. Mobile network operators charges users only if they are successfully identified and only after click on the button.

From a financial point of view, this mechanism is similar to the Premium rate SMS service â€“ charge is directly applied to usersâ€™ phone bills. However, in this case Trojans do not need to send any SMS â€“ just to click on button on a web-page with WAP-billing.

We hadnâ€™t seen any Trojans like this in a while, but several of them appeared out of nowhere. Different Trojans from different cybercriminal groups targeting different countries (Russia and India) became common at the same time. Most of them had been under development since the end of 2016 / the beginning of 2017, but their prevalence increased only in the second half of Q2 2017. Therefore, I decided to take a closer look at these Trojans.

In general, these Trojans are doing similar things. First, they turn off WiFi and turn on mobile Internet. They do this because WAP-billing works only through mobile Internet. Then they open a URL which redirects to the page with WAP-billing. Usually, Trojans load such pages and click on buttons using JavaScript (JS) files. After that they need to delete incoming SMS messages containing information about subscriptions from the mobile network operator.

Furthermore, some of them have the ability to send premium rate SMS messages. In addition, some are exploiting Device Administrator rights to make it harder to delete the Trojan.
* link: https://www.virustotal.com/file/a38d879bc02f6721d2fe326b4142c0ad429bb414be2416f69ce8fd570f15b3e6/analysis/1500263716/ — - Xchecked via VT: aeae6bfdd18712637852c6d824955859
* link: https://www.virustotal.com/file/dba977d43d84d2f0a1e42bc3cc6c9c656bb0012651ff1531ce5d0fa9d2368a7f/analysis/1488259926/ — - Xchecked via VT: 66fe79bee25a92462a565fd7ed8a03b4
* link: https://www.virustotal.com/file/2f012d6adccebb975eedc790a250000c30c3cd9de2c7d1b6e3067d68cbb6262f/analysis/1496415838/ — - Xchecked via VT: a93d3c727b970082c682895fea4db77b
* link: https://www.virustotal.com/file/1f00c1d379b3fe49215c96dabf310f8208ef4203e12e6f04ce3a15265254a96f/analysis/1501376726/ — - Xchecked via VT: 9e492a6fb926e1338dadc32463196288
* link: https://www.virustotal.com/file/3e3c73987b0ad9cb8ab10100ca875df65ebe7560b7f08f875c8acee18c7af92f/analysis/1497642003/ — - Xchecked via VT: f3d2febbf356e968c7310ec182ee9ce0

### Payload delivery
* md5: <md5>
* md5: <md5>
* md5: <md5>
* md5: <md5>
* md5: <md5>
* md5: <md5>
* sha256: <sha256> — - Xchecked via VT: aeae6bfdd18712637852c6d824955859
* sha1: <sha1> — - Xchecked via VT: aeae6bfdd18712637852c6d824955859
* sha256: <sha256> — - Xchecked via VT: 66fe79bee25a92462a565fd7ed8a03b4
* sha1: <sha1> — - Xchecked via VT: 66fe79bee25a92462a565fd7ed8a03b4
* sha256: <sha256> — - Xchecked via VT: a93d3c727b970082c682895fea4db77b
* sha1: <sha1> — - Xchecked via VT: a93d3c727b970082c682895fea4db77b
* sha256: <sha256> — - Xchecked via VT: 9e492a6fb926e1338dadc32463196288
* sha1: <sha1> — - Xchecked via VT: 9e492a6fb926e1338dadc32463196288
* sha256: <sha256> — - Xchecked via VT: f3d2febbf356e968c7310ec182ee9ce0
* sha1: <sha1> — - Xchecked via VT: f3d2febbf356e968c7310ec182ee9ce0
