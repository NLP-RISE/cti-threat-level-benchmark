# Threat Report: 2021-10-05: UEFI threats moving to the ESP: Introducing ESPecter bootkit


## Key Intelligence
* Date: 2021-10-05
* Threat Level: 1 (High)
* Tags: type:OSINT, osint:lifetime="perpetual", osint:certainty="50", tlp:white, misp-galaxy:mitre-attack-pattern="Native API - T1106", misp-galaxy:mitre-attack-pattern="Pre-OS Boot - T1542", misp-galaxy:mitre-attack-pattern="Boot or Logon Autostart Execution - T1547", misp-galaxy:mitre-attack-pattern="Dynamic-link Library Injection - T1055.001", misp-galaxy:mitre-attack-pattern="Hidden Files and Directories - T1564.001", misp-galaxy:mitre-attack-pattern="Hidden File System - T1564.005", misp-galaxy:mitre-attack-pattern="Deobfuscate/Decode Files or Information - T1140", misp-galaxy:mitre-attack-pattern="Impair Defenses - T1562", misp-galaxy:mitre-attack-pattern="Rename System Utilities - T1036.003", misp-galaxy:mitre-attack-pattern="Modify Registry - T1112", misp-galaxy:mitre-attack-pattern="Patch System Image - T1601.001", misp-galaxy:mitre-attack-pattern="Obfuscated Files or Information - T1406", misp-galaxy:mitre-attack-pattern="Software Packing - T1027.002", misp-galaxy:mitre-attack-pattern="Bootkit - T1542.003", misp-galaxy:mitre-attack-pattern="Code Signing Policy Modification - T1553.006", misp-galaxy:mitre-attack-pattern="Time Based Evasion - T1497.003", misp-galaxy:mitre-attack-pattern="Keylogging - T1056.001", misp-galaxy:mitre-attack-pattern="Application Window Discovery - T1010", misp-galaxy:mitre-attack-pattern="File and Directory Discovery - T1083", misp-galaxy:mitre-attack-pattern="File and Directory Discovery - T1420", misp-galaxy:mitre-attack-pattern="Peripheral Device Discovery - T1120", misp-galaxy:mitre-attack-pattern="Process Discovery - T1424", misp-galaxy:mitre-attack-pattern="Query Registry - T1012", misp-galaxy:mitre-attack-pattern="System Information Discovery - T1426", misp-galaxy:mitre-attack-pattern="System Time Discovery - T1124", misp-galaxy:mitre-attack-pattern="Automated Collection - T1119", misp-galaxy:mitre-attack-pattern="Data from Removable Media - T1025", misp-galaxy:mitre-attack-pattern="Local Data Staging - T1074.001", misp-galaxy:mitre-attack-pattern="Input Capture - T1417", misp-galaxy:mitre-attack-pattern="Input Capture - T1056", misp-galaxy:mitre-attack-pattern="Screen Capture - T1513", misp-galaxy:mitre-attack-pattern="Screen Capture - T1113", misp-galaxy:mitre-attack-pattern="Web Protocols - T1071.001", misp-galaxy:mitre-attack-pattern="Symmetric Cryptography - T1573.001", misp-galaxy:mitre-attack-pattern="Ingress Tool Transfer - T1105", misp-galaxy:mitre-attack-pattern="Non-Application Layer Protocol - T1095", misp-galaxy:mitre-attack-pattern="Multi-Stage Channels - T1104", misp-galaxy:mitre-attack-pattern="Automated Exfiltration - T1020", misp-galaxy:mitre-attack-pattern="Exfiltration Over C2 Channel - T1041", misp-galaxy:mitre-attack-pattern="Exfiltration Over Command and Control Channel - T1041", misp-galaxy:mitre-attack-pattern="Scheduled Transfer - T1029", misp-galaxy:tool="ESPecter bootkit"

---

## Indicators of Compromise (IOCs)
### Artifacts dropped
* text: EFI/Rootkit.ESPecter
* text: Win32/Rootkit.ESPecter
* text: Win64/Rootkit.ESPecter

### Network activity
* ip-dst: 196.1.2.111 — C&C from configurations
* ip-dst: 103.212.69.175 — C&C from configurations
* ip-dst: 183.90.187.65 — C&C from configurations
* ip-dst: 61.178.79.69 — C&C from configurations
* hostname: swj02.gicp.net — C&C from configurations
* hostname: server.microsoftassistant.com — C&C from configurations
* hostname: yspark.justdied.com — C&C from configurations
* domain: crystalnba.com — C&C from configurations

### Other
* text: %windir%\Temp\syslog — Configuration file path
* text: %sysdir%\Media\NPCSJDLFSD — Base directory for the collected data (%BaseDir%)
* text: %windir%\Temp\NPCSJDLFSD — Base directory for the collected data (%BaseDir%)
* text: %BaseDir%\SSQWCVBER — Screenshots directory
* text: %BaseDir%\UTXZCZXQ — Stolen documents directory
* text: %BaseDir%\KLACVSWER — Intercepted keyboard logs directory
* text: %windir%\Temp\dd_vcredist — Encrypted user-mode payloads files
* text: %windir%\Temp\memlog — Encrypted user-mode payloads files
* text: %windir%\Temp\vmmmlog — Encrypted user-mode payloads files
* text: %windir%\Temp\vmmmmlog — Encrypted user-mode payloads files
* text: %windir%\Temp\vmmmlog.exe — Decrypted user-mode payloads files
* text: %windir%\Temp\vmmmmlog.exe — Decrypted user-mode payloads files
* text: \SystemRoot\System32\Client.dll — Decrypted user-mode payloads files
* text: \SystemRoot\System32\WinSys.dll — Decrypted user-mode payloads files
* text: %windir%\\Help\\intel.chm — Backed up clean null.sys or beep.sys driver path

## Objects
### file — File object describing a file with meta-information
* [Payload delivery] sha1: <sha1>
* [Payload delivery] filename: WinSys.dll

### file — File object describing a file with meta-information
* [Payload delivery] sha1: <sha1>
* [Payload delivery] filename: WinSys.dll

### file — File object describing a file with meta-information
* [Payload delivery] sha1: <sha1> — Legacy BIOS version installers

### file — File object describing a file with meta-information
* [Payload delivery] sha1: <sha1>
* [Payload delivery] filename: WinSys.dll

### file — File object describing a file with meta-information
* [Payload delivery] sha1: <sha1> — Kernel drivers

### file — File object describing a file with meta-information
* [Payload delivery] sha1: <sha1> — Kernel drivers

### file — File object describing a file with meta-information
* [Payload delivery] sha1: <sha1> — Kernel drivers

### file — File object describing a file with meta-information
* [Payload delivery] sha1: <sha1> — Kernel drivers

### file — File object describing a file with meta-information
* [Payload delivery] sha1: <sha1> — Legacy BIOS version installers

### file — File object describing a file with meta-information
* [Payload delivery] sha1: <sha1> — Kernel drivers

### file — File object describing a file with meta-information
* [Payload delivery] sha1: <sha1> — Compromised UEFI Windows Boot Manager

### file — File object describing a file with meta-information
* [Payload delivery] sha1: <sha1> — Legacy BIOS version installers

### file — File object describing a file with meta-information
* [Payload delivery] sha1: <sha1> — Legacy BIOS version installers

### file — File object describing a file with meta-information
* [Payload delivery] sha1: <sha1> — Kernel drivers

### file — File object describing a file with meta-information
* [Payload delivery] sha1: <sha1> — Legacy BIOS version installers

### file — File object describing a file with meta-information
* [Payload delivery] sha1: <sha1> — Legacy BIOS version installers

### file — File object describing a file with meta-information
* [Payload delivery] sha1: <sha1> — Legacy BIOS version installers

### file — File object describing a file with meta-information
* [Payload delivery] sha1: <sha1> — Kernel drivers

### file — File object describing a file with meta-information
* [Payload delivery] sha1: <sha1> — Legacy BIOS version installers

### file — File object describing a file with meta-information
* [Payload delivery] sha1: <sha1> — Legacy BIOS version installers

### file — File object describing a file with meta-information
* [Payload delivery] sha1: <sha1> — Compromised UEFI Windows Boot Manager

### file — File object describing a file with meta-information
* [Payload delivery] sha1: <sha1> — Legacy BIOS version installers

### file — File object describing a file with meta-information
* [Payload delivery] sha1: <sha1> — Legacy BIOS version installers

### file — File object describing a file with meta-information
* [Payload delivery] sha1: <sha1> — Kernel drivers

### file — File object describing a file with meta-information
* [Payload delivery] sha1: <sha1> — Kernel drivers

### file — File object describing a file with meta-information
* [Payload delivery] sha1: <sha1>
* [Payload delivery] filename: WinSys.dll

### file — File object describing a file with meta-information
* [Payload delivery] sha1: <sha1>
* [Payload delivery] filename: WinSys.dll

### file — File object describing a file with meta-information
* [Payload delivery] sha1: <sha1>
* [Payload delivery] filename: WinSys.dll

### file — File object describing a file with meta-information
* [Payload delivery] sha1: <sha1>
* [Payload delivery] filename: WinSys.dll

### file — File object describing a file with meta-information
* [Payload delivery] sha1: <sha1>
* [Payload delivery] filename: WinSys.dll

### file — File object describing a file with meta-information
* [Payload delivery] sha1: <sha1>
* [Payload delivery] filename: WinSys.dll

### report — Metadata used to generate an executive level report
* [External analysis] link: https://www.welivesecurity.com/2021/10/05/uefi-threats-moving-esp-introducing-especter-bootkit/
* [Other] text: ESET researchers have analyzed a previously undocumented, real-world UEFI bootkit that persists on the EFI System Partition (ESP). The bootkit, which we’ve named ESPecter, can bypass Windows Driver Signature Enforcement to load its own unsigned driver, which facilitates its espionage activities. Alongside Kaspersky’s recent discovery of the unrelated FinSpy bootkit, it is now safe to say that real-world UEFI threats are no longer limited to SPI flash implants, as used by Lojax.
* [Other] text: Online Article

### report — Metadata used to generate an executive level report
* [External analysis] link: https://github.com/eset/malware-ioc/tree/master/especter
* [Other] text: Report

### file — File object describing a file with meta-information
* [Payload delivery] md5: <md5> — Legacy BIOS version installers
* [Payload delivery] sha1: <sha1> — Legacy BIOS version installers
* [Payload delivery] sha256: <sha256> — Legacy BIOS version installers

### virustotal-report — VirusTotal report
* [Other] datetime: 2021-10-23T06:24:22+00:00 — Legacy BIOS version installers
* [Payload delivery] link: https://www.virustotal.com/gui/file/d61417d72a054d45ee33e395079e9d674f891a42ed0ec5357b5a8d91c69858a6/detection/f-d61417d72a054d45ee33e395079e9d674f891a42ed0ec5357b5a8d91c69858a6-1634970262 — Legacy BIOS version installers
* [Payload delivery] text: 51/68 — Legacy BIOS version installers

### file — File object describing a file with meta-information
* [Payload delivery] md5: <md5> — Legacy BIOS version installers
* [Payload delivery] sha1: <sha1> — Legacy BIOS version installers
* [Payload delivery] sha256: <sha256> — Legacy BIOS version installers

### virustotal-report — VirusTotal report
* [Other] datetime: 2021-10-27T13:27:29+00:00 — Legacy BIOS version installers
* [Payload delivery] link: https://www.virustotal.com/gui/file/021ec918c30a65a9f93919cedf57e8c935df3e773e03b74704d14fabcab89c5b/detection/f-021ec918c30a65a9f93919cedf57e8c935df3e773e03b74704d14fabcab89c5b-1635341249 — Legacy BIOS version installers
* [Payload delivery] text: 57/68 — Legacy BIOS version installers

### file — File object describing a file with meta-information
* [Payload delivery] md5: <md5>
* [Payload delivery] sha1: <sha1>
* [Payload delivery] sha256: <sha256>

### virustotal-report — VirusTotal report
* [Other] datetime: 2021-10-23T05:15:58+00:00
* [Payload delivery] link: https://www.virustotal.com/gui/file/e2bb96b57fa337e3ee2f7d26b1710a80e89449c41c77ff58073cd386dbf83b63/detection/f-e2bb96b57fa337e3ee2f7d26b1710a80e89449c41c77ff58073cd386dbf83b63-1634966158
* [Payload delivery] text: 50/65

### file — File object describing a file with meta-information
* [Payload delivery] md5: <md5> — Legacy BIOS version installers
* [Payload delivery] sha1: <sha1> — Legacy BIOS version installers
* [Payload delivery] sha256: <sha256> — Legacy BIOS version installers

### virustotal-report — VirusTotal report
* [Other] datetime: 2021-10-27T13:33:01+00:00 — Legacy BIOS version installers
* [Payload delivery] link: https://www.virustotal.com/gui/file/5ef62c780d7c9f82dea098972f66d5b3367841913444933cdb779adaecd06d1a/detection/f-5ef62c780d7c9f82dea098972f66d5b3367841913444933cdb779adaecd06d1a-1635341581 — Legacy BIOS version installers
* [Payload delivery] text: 56/67 — Legacy BIOS version installers

### file — File object describing a file with meta-information
* [Payload delivery] md5: <md5> — Legacy BIOS version installers
* [Payload delivery] sha1: <sha1> — Legacy BIOS version installers
* [Payload delivery] sha256: <sha256> — Legacy BIOS version installers

### virustotal-report — VirusTotal report
* [Other] datetime: 2021-10-23T05:36:39+00:00 — Legacy BIOS version installers
* [Payload delivery] link: https://www.virustotal.com/gui/file/6b0cd074a6c556f4d1fe0088c15160eb13f847974c4307f9eeeea4dc33d49286/detection/f-6b0cd074a6c556f4d1fe0088c15160eb13f847974c4307f9eeeea4dc33d49286-1634967399 — Legacy BIOS version installers
* [Payload delivery] text: 52/68 — Legacy BIOS version installers
