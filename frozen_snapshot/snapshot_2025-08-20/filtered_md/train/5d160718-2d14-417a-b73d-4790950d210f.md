# Threat Report: 2019-06-26: OSINT - Very nasty Linux backdoor with multiple components


## Key Intelligence
* Date: 2019-06-26
* Threat Level: 3 (Low)
* Tags: type:OSINT, osint:lifetime="perpetual", osint:certainty="50", tlp:white, ecsirt:intrusions="backdoor", veris:action:malware:variety="Backdoor", ms-caro-malware:malware-type="Backdoor", ms-caro-malware-full:malware-type="Backdoor", ms-caro-malware-full:malware-platform="Linux", ms-caro-malware:malware-platform="Linux"

---

## Indicators of Compromise (IOCs)
### External analysis
* attachment: D9_fhl-XoAA2lqo.jpeg
* attachment: D9_f5EBXUAA3WPB.jpeg
* attachment: D9_gbcAXsAArCk_.png
* attachment: D9_gkKyX4AAyIGB.jpeg
* attachment: D9_jn9BXkAATcRM.png
* attachment: D9_kDIyWsAY2tMM.png
* attachment: D9_kITnWsAAx7t1.png
* attachment: D9_m9yWWkAM7omk.png
* attachment: D9_nE5vW4AALIhL.png

### Network activity
* hostname: auth.to0ls.com — remote host

## Objects
### microblog — Microblog post like a Twitter tweet or a post on a Facebook wall.
* [Other] text: Very nasty Linux backdoor with multiple components (link: https://www.virustotal.com/gui/file/c69ee0f12a900adc654d93aef9ad23ea56bdfae8513e534e1a11dca6666d10aa/detection) virustotal.com/gui/file/c69ee…

- Kills & uninstalls AV: clamav, avast, avg, drweb, esets
- Very persistent
- Uses Gates malware
- Uses Brootkit
- Uses CVE-2016-5195 to get root
- Infects other systems from known_hosts, .bash_history
* [Network activity] url: https://mobile.twitter.com/michalmalik/status/1143879771878830080
* [Other] text: michalmalik
* [Other] datetime: Jun 26, 2019 3:52 PM
* [Network activity] url: https://www.virustotal.com/gui/file/c69ee0f12a900adc654d93aef9ad23ea56bdfae8513e534e1a11dca6666d10aa/detection
* [Network activity] url: https://t.co/RmWa9pD5G4?amp=1

### file — File object describing a file with meta-information
* [Payload delivery] md5: <md5>
* [Payload delivery] sha256: <sha256>
* [Payload delivery] sha1: <sha1>

### microblog — Microblog post like a Twitter tweet or a post on a Facebook wall.
* [Other] text: Michal Malík
@michalmalik
- It periodically tries to detect a running miner and kill it (it can also kill itself & Gates malware - to update)
- Brootkit is "installed" to  /etc/profile.d/emacs.sh - this confirms that EMACS is indeed a rootkit
- The remote host is auth.to0ls[.]com
* [Other] text: Twitter
* [Network activity] url: https://mobile.twitter.com/michalmalik/status/1143883668034871296
* [Other] text: michalmalik
* [Other] datetime: Jun 26, 2019  4:08 PM

### ip-port — An IP address (or domain or hostname) and a port seen as a tuple (or as a triple) in a specific time frame.
* [Network activity] domain: vpn.to0ls.com
* [Network activity] port: 443

### ip-port — An IP address (or domain or hostname) and a port seen as a tuple (or as a triple) in a specific time frame.
* [Network activity] ip-dst: 115.231.218.64
* [Network activity] port: 8226

### file — File object describing a file with meta-information
* [Payload delivery] sha1: <sha1>

### microblog — Microblog post like a Twitter tweet or a post on a Facebook wall.
* [Other] text: Artefacts from one of the Gates files (syn, 2a9bf4ee7d437ae0bc67d2da1e711aaa0d1aa302)
- vpn.to0ls[.]com:443
- 115.231.218[.]64:8226
* [Other] text: Twitter
* [Network activity] url: https://mobile.twitter.com/michalmalik/status/1143887109599748097
* [Other] text: michalmalik
* [Other] datetime: Jun 26, 2019 4:21 PM
