# Threat Report: 2017-03-03: OSINT - Update on the Fancy Bear Android malware (poprd30.apk)


## Key Intelligence
* Date: 2017-03-03
* Threat Level: 3 (Low)
* Tags: misp-galaxy:threat-actor="Sofacy", tlp:white

---

## Indicators of Compromise (IOCs)
### Artifacts dropped
* sha256: <sha256> — The repair process consisted of finding and removing an extra byte from the file â€œwarnings.pngâ€. By changing only this byte and getting a valid APK file, this might be the original file. After repair, we got the following file - REPAIRED.apk
* yara: rule sofacy_xagent {
meta:
author = "AKG"
description = "Sofacy - XAgent"
strings:
$service = "ksysdefd"
$x1 = "AgentKernel"
$x2 = "Cryptor"
$x3 = "AgentModule"
$x4 = "ChannelController"
$x5 = "RemoteKeylogger"
$a1 = "UNCORRECT DISPLAY NAME"
$a2 = "Keylogger started"
$a3 = "Keylog thread exit"
$a4 = "Keylogger yet started"
condition:
$service or (2 of ($x*)) or (2 of ($a*))
} — Recommended yara for the linux versions

### External analysis
* text: The APK file, that was investigated by Crowd Strike and us is actually corrupt, unzipping yields two warnings and a CRC Error.
* link: http://blog.crysys.hu/2017/03/update-on-the-fancy-bear-android-malware-poprd30-apk/
* link: https://www.virustotal.com/file/5f6b2a0d1d966fc4f1ed292b46240767f4acb06c13512b0061b434ae2a692fa1/analysis/1478070568/ — These XAgent linux samples are very similar to a Windows version that has been found in november, 2013 - Xchecked via VT: 5f6b2a0d1d966fc4f1ed292b46240767f4acb06c13512b0061b434ae2a692fa1

### Payload installation
* sha256: <sha256> — These XAgent linux samples are very similar to a Windows version that has been found in november, 2013
* sha1: <sha1> — These XAgent linux samples are very similar to a Windows version that has been found in november, 2013 - Xchecked via VT: 5f6b2a0d1d966fc4f1ed292b46240767f4acb06c13512b0061b434ae2a692fa1
* md5: <md5> — These XAgent linux samples are very similar to a Windows version that has been found in november, 2013 - Xchecked via VT: 5f6b2a0d1d966fc4f1ed292b46240767f4acb06c13512b0061b434ae2a692fa1
