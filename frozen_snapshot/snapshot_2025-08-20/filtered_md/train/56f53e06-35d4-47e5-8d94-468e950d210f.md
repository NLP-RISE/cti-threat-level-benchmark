# Threat Report: 2016-03-25: OSINT - New self-protecting USB trojan able to avoid detection


## Key Intelligence
* Date: 2016-03-25
* Threat Level: 3 (Low)
* Tags: tlp:white, type:OSINT

---

## Indicators of Compromise (IOCs)
### Antivirus detection
* text: Win32/PSW.Stealer.NAI trojan — payload
* text: Win32/TrojanDropper.Agent.RFT trojan

### External analysis
* link: http://blog.eset.ie/2016/03/23/new-self-protecting-usb-trojan-able-to-avoid-detection/
* comment: A unique data-stealing trojan has been spotted on USB devices in the wild â€“ and it is different from typical data-stealing malware. Each instance of this trojan relies on the particular USB device on which it is installed and it leaves no evidence on the compromised system. Moreover, it uses a very special mechanism to protect itself from being reproduced or copied, which makes it even harder to detect.

In this article we will examine the technical details of this interesting malware.

â€What really sets this malware apart is its self-protection mechanism.â€

Where other malware uses â€˜good old-fashioned approachesâ€™ like Autorun files or crafted shortcuts in order to get users to run it, USB Thief uses also another technique. This method depends on the increasingly common practice of storing portable versions of popular applications such as Firefox, NotePad++ and TrueCrypt on USB drives.

The malware takes advantage of this trend by inserting itself into the command chain of such applications, in the form of a plugin or a dynamically linked library (DLL). And therefore, whenever such an application is executed, the malware will also be run in the background.

What really sets this malware apart, however, is its self-protection mechanism.
* link: https://www.virustotal.com/file/9b07058b787c40aead135554108d12d4edde6b9d3dd5847a0cf4c03eb55cae50/analysis/1458896127/
* link: https://www.virustotal.com/file/f2734d702a76fddcf1f6683b289b3d68cbece905ec6a4951ecf500ef8ee966ab/analysis/1458896995/
* link: https://www.virustotal.com/file/8e7f3a2e664e530015fd20fc4034bb957c97da500564d0d9354127896b6458cd/analysis/1458896043/
* link: https://www.virustotal.com/file/a5b504fced6daf4f58989e7451441a2281d5e494dcf973ce19308da5e07514cc/analysis/1458896212/
* link: https://www.virustotal.com/file/b297ef8df5c954a033c9c40200619f9a0c61d57bdd86197e36c92e3397913c48/analysis/1458896666/

### Payload installation
* sha1: <sha1> — SHA1 hashes of decrypted binaries
* sha1: <sha1> — SHA1 hashes of decrypted binaries
* sha1: <sha1> — SHA1 hashes of decrypted binaries
* sha1: <sha1> — SHA1 hashes of decrypted binaries
* sha1: <sha1> — SHA1 hashes of decrypted binaries
* sha256: <sha256> — SHA1 hashes of decrypted binaries - Xchecked via VT: 2c188c395ab32eaa00e6b7aa031632248ff38b2e
* md5: <md5> — SHA1 hashes of decrypted binaries - Xchecked via VT: 2c188c395ab32eaa00e6b7aa031632248ff38b2e
* sha256: <sha256> — SHA1 hashes of decrypted binaries - Xchecked via VT: b03abe820c0517ccef98bc1785b7fd4cdf958278
* md5: <md5> — SHA1 hashes of decrypted binaries - Xchecked via VT: b03abe820c0517ccef98bc1785b7fd4cdf958278
* sha256: <sha256> — SHA1 hashes of decrypted binaries - Xchecked via VT: 66d169e1e503725a720d903e1dfaf456db172767
* md5: <md5> — SHA1 hashes of decrypted binaries - Xchecked via VT: 66d169e1e503725a720d903e1dfaf456db172767
* sha256: <sha256> — SHA1 hashes of decrypted binaries - Xchecked via VT: 4b2c60d77915c5695ec9d3c4364e6cd6946bd33c
* md5: <md5> — SHA1 hashes of decrypted binaries - Xchecked via VT: 4b2c60d77915c5695ec9d3c4364e6cd6946bd33c
* sha256: <sha256> — SHA1 hashes of decrypted binaries - Xchecked via VT: 76471b0f34abb3c2530a16f39e10e4478cb6816d
* md5: <md5> — SHA1 hashes of decrypted binaries - Xchecked via VT: 76471b0f34abb3c2530a16f39e10e4478cb6816d
