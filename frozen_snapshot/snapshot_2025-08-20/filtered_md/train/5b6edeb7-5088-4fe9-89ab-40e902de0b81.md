# Threat Report: 2018-07-31: OSINT - Malware Analysis Report (AR18-221A) MAR-10135536-17 â€“ North Korean Trojan: KEYMARBLE- MAR-10135536.r17.v1


## Key Intelligence
* Date: 2018-07-31
* Threat Level: 3 (Low)
* Tags: tlp:white, estimative-language:confidence-in-analytic-judgment="high", misp-galaxy:tool="KEYMARBLE", misp-galaxy:threat-actor="Lazarus Group"

---

## Indicators of Compromise (IOCs)
### Artifacts dropped
* yara: rule rsa_modulus { meta: Author="NCCIC trusted 3rd party" Incident="10135536" Date = "2018/04/19" category = "hidden_cobra" family = "n/a" description = "n/a" strings: $n = "bc9b75a31177587245305cd418b8df78652d1c03e9da0cfc910d6d38ee4191d40" condition: (uint16(0) == 0x5A4D and uint16(uint32(0x3c)) == 0x4550) and any of them }

### External analysis
* attachment: Figure 1
* link: https://www.us-cert.gov/sites/default/files/publications/MAR-10135536.r17.v1.WHITE_stix.xml
* text: This Malware Analysis Report (MAR) is the result of analytic efforts between Department of Homeland Security (DHS) and the Federal Bureau of Investigation (FBI). Working with U.S. Government partners, DHS and FBI identified Trojan malware variants used by the North Korean government. This malware variant has been identified as KEYMARBLE. The U.S. Government refers to malicious cyber activity by the North Korean government as HIDDEN COBRA. For more information on HIDDEN COBRA activity, visit https://www.us-cert.gov/hiddencobra.

DHS and FBI are distributing this MAR to enable network defense and reduce exposure to North Korean government malicious cyber activity.

This MAR includes malware descriptions related to HIDDEN COBRA, suggested response actions and recommended mitigation techniques. Users or administrators should flag activity associated with the malware, report the activity to the DHS National Cybersecurity and Communications Integration Center (NCCIC) or the FBI Cyber Watch (CyWatch), and give the activity the highest priority for enhanced mitigation.

This malware report contains analysis of one 32-bit Windows executable file, identified as a Remote Access Trojan (RAT). This malware is capable of accessing device configuration data, downloading additional files, executing commands, modifying the registry, capturing screen shots, and exfiltrating data.
* link: https://www.us-cert.gov/ncas/analysis-reports/AR18-221A

### Network activity
* port: 443
* ip-dst: 212.143.21.43
* ip-dst: 100.43.153.60
* ip-dst: 104.194.160.59

## Objects
### file — File object describing a file with meta-information
* [Payload delivery] md5: <md5>
* [Payload delivery] sha1: <sha1>
* [Payload delivery] sha256: <sha256>

### pe-section — Object describing a section of a Portable Executable
* [Other] float: 0.627182
* [Payload delivery] md5: <md5>
* [Other] size-in-bytes: 4096

### pe-section — Object describing a section of a Portable Executable
* [Payload delivery] md5: <md5>
* [Other] float: 6.633409
* [Other] text: .text
* [Other] size-in-bytes: 94208

### pe-section — Object describing a section of a Portable Executable
* [Payload delivery] md5: <md5>
* [Other] float: 5.054283
* [Other] text: .rdata
* [Other] size-in-bytes: 8192

### pe-section — Object describing a section of a Portable Executable
* [Payload delivery] md5: <md5>
* [Other] float: 4.41698
* [Other] text: .data
* [Other] size-in-bytes: 20480

### pe — Object describing a Portable Executable
* [Payload delivery] filename: 704d491c155aad996f16377a35732cb4
* [Payload delivery] filename: 704d491c155aad996f16377a35732cb4
* [Other] counter: 4

### virustotal-report — VirusTotal report
* [Other] datetime: 2018-08-10T21:54:59
* [External analysis] link: https://www.virustotal.com/file/e23900b00ffd67cd8dfa3283d9ced691566df6d63d1d46c95b22569b49011f09/analysis/1533938099/
* [Other] text: 52/66
