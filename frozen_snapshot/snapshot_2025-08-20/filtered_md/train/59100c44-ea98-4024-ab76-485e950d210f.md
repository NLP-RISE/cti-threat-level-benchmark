# Threat Report: 2017-05-08: OSINT - Windows Defender ATP thwarts Operation WilySupply software supply chain cyberattack


## Key Intelligence
* Date: 2017-05-08
* Threat Level: 3 (Low)
* Tags: tlp:white, veris:actor:motive="Financial"

---

## Indicators of Compromise (IOCs)
### External analysis
* link: https://blogs.technet.microsoft.com/mmpc/2017/05/04/windows-defender-atp-thwarts-operation-wilysupply-software-supply-chain-cyberattack/
* text: Several weeks ago, the Windows Defender Advanced Threat Protection (Windows Defender ATP) research team noticed security alerts that demonstrated an intriguing attack pattern. These early alerts uncovered a well-planned, finely orchestrated cyberattack that targeted several high-profile technology and financial organizations. An unknown attacker was taking advantage of a silent yet effective attack vector: the compromised update mechanism or software supply chain for a third-party editing tool. The software vendor that develops the editing tool was unaware of the issue. In fact, while their software supply chain served as a channel for attacking other organizations, they themselves were also under attack.

This cyberattack could have been much more problematic if it had gone undetected. Its early discovery allowed incident respondersâ€”a collaboration of security experts from the targeted industries and developers working for the third-party software vendorâ€”to work with Microsoft security researchers to promptly identify and neutralize the activities associated with this cyberespionage campaign.

Thanks to the collaborative response, Microsoft was able to notify known affected parties as well as the third-party software vendor, who then worked around the clock to contain the attempted attack and mitigate potential risks.
Investigating alert timelines and process trees

Regardless of how an attack is executed, through sophisticated social engineering or a zero-day exploit, the first stage or the entry vector of a kill chain is often the most challenging aspect to understand about the attack. Windows Defender ATP initially called our attention to alerts flagging suspicious PowerShell scripts, self-deletion of executables, and other suspect activities. A quick check in the Windows Defender ATP console led us to the machine that was under attack. However, the source of the attack remained buried, requiring additional investigative effort to uncover.
* link: https://www.virustotal.com/file/9a4346d7ac23d3fb06050e56ab7376fa56194c21617232574a5dbcb0a4e00a57/analysis/1494003300/ — the malicious sample downloaded through the third-party updater - Xchecked via VT: 75edd4ee11e7d3dabd191c316da637f939140e2f

### Network activity
* url: http://5.39.218.205/logo.png — (used for initial infection and C&C communication)
* url: http://176.53.118.131/logo.png — (used for initial infection and C&C communication)
* ip-dst: 5.39.218.205 — used for initial infection and C&C communication
* ip-dst: 176.53.118.131 — used for initial infection and C&C communication

### Payload delivery
* sha1: <sha1> — the malicious sample downloaded through the third-party updater
* md5: <md5> — the malicious sample downloaded through the third-party updater
* sha256: <sha256> — the malicious sample downloaded through the third-party updater - Xchecked via VT: 75edd4ee11e7d3dabd191c316da637f939140e2f
