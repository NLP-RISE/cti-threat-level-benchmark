# Threat Report: 2023-08-25: CISA - MAR-10459736.r1.v1 - WHIRLPOOL Variant


## Key Intelligence
* Date: 2023-08-25
* Threat Level: 3 (Low)
* Tags: type:OSINT, osint:lifetime="perpetual", tlp:white, tlp:clear

---

## Indicators of Compromise (IOCs)
### Payload installation
* yara: 'namespace'='CISA_Consolidated.yara' rule_name=CISA_10452108_02 rule_content=rule CISA_10452108_02 : WHIRLPOOL backdoor communicates_with_c2 installs_other_components
{
	meta:
		Author = "CISA Code & Media Analysis"
		Incident = "10452108"
		Date = "2023-06-20"
		Last_Modified = "20230804_1730"
		Actor = "n/a"
		Family = "WHIRLPOOL"
		Capabilities = "communicates-with-c2 installs-other-components"
		Malware_Type = "backdoor"
		Tool_Type = "unknown"
		Description = "Detects malicious Linux WHIRLPOOL samples"
		SHA256_1 = "83ca636253fd1eb898b244855838e2281f257bbe8ead428b69528fc50b60ae9c"
		SHA256_2 = "8849a3273e0362c45b4928375d196714224ec22cb1d2df5d029bf57349860347"
	strings:
		$s0 = { 65 72 72 6f 72 20 2d 31 20 65 78 69 74 }
		$s1 = { 63 72 65 61 74 65 20 73 6f 63 6b 65 74 20 65 72 72 6f 72 3a 20 25 73 28 65 72 72 6f 72 3a 20 25 64 29 }
		$s2 = { c7 00 20 32 3e 26 66 c7 40 04 31 00 }
		$a3 = { 70 6c 61 69 6e 5f 63 6f 6e 6e 65 63 74 }
		$a4 = { 63 6f 6e 6e 65 63 74 20 65 72 72 6f 72 3a 20 25 73 28 65 72 72 6f 72 3a 20 25 64 29 }
		$a5 = { 73 73 6c 5f 63 6f 6e 6e 65 63 74 }
	condition:
		uint32(0) == 0x464c457f and 4 of them
} — The file 'ssld' is a Linux ELF reverse shell and is a variant of WHIRLPOOL malware used on the Barracuda Email Security Gateway (ESG) device (Figure 1). The file looks for an encoded string with a '.io' extension (Figure 2). The string will be decoded and the data will be passed as the C2 which will include the Internet Protocol (IP) address and port number used to establish a reverse shell.

## Objects
### identity — Identities can represent actual individuals, organizations, or groups (e.g., ACME, Inc.) as well as classes of individuals, organizations, systems or groups (e.g., the finance sector).  The Identity SDO can capture basic identifying information, contact information, and the sectors that the Identity belongs to. Identity is used in STIX to represent, among other things, targets of attacks, information sources, object creators, and threat actor identities. (ref. STIX 2.1 - 4.5)
* [Other] text: GeminiProduction_CMA
* [Other] text: Cybersecurity and Infrastructure Security Agency Production Identity. Code and Media Analysis.
* [Other] text: system

### malware-analysis — Malware Analysis captures the metadata and results of a particular static or dynamic analysis performed on a malware instance or family.
* [Other] text: eset
* [Other] text: unknown
* [Other] text: a variant of Linux/WhirlPool.A trojan

### file — File object describing a file with meta-information
* [Payload delivery] md5: <md5>
* [Payload delivery] sha1: <sha1>
* [Payload delivery] sha256: <sha256>
* [Payload delivery] sha512: <sha512>
* [Payload delivery] ssdeep: <ssdeep>
* [Payload delivery] filename: ssld
* [Other] size-in-bytes: 5034648

### malware — Malware is a type of TTP that represents malicious code.
* [Other] text: The file 'ssld' is a Linux ELF reverse shell and is a variant of WHIRLPOOL malware used on the Barracuda Email Security Gateway (ESG) device (Figure 1). The file looks for an encoded string with a '.io' extension (Figure 2). The string will be decoded and the data will be passed as the C2 which will include the Internet Protocol (IP) address and port number used to establish a reverse shell.
* [Other] boolean: 0
* [Other] text: trojan

### file — File object describing a file with meta-information
* [Payload delivery] md5: <md5>
* [Payload delivery] sha1: <sha1>
* [Payload delivery] sha256: <sha256>
* [Payload delivery] sha512: <sha512>

### original-imported-file — Object describing the original file used to import data in MISP.
* [External analysis] attachment: MAR-10459736.r1.v1.CLEAR_stix2.json
* [Other] text: STIX 2.1
