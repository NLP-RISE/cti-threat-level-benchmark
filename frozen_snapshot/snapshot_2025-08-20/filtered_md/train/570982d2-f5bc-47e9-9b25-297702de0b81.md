# Threat Report: 2016-04-09: OSINT - ModPOS: A Framework Lurking in Point-of-Sale System Kernels


## Key Intelligence
* Date: 2016-04-09
* Threat Level: 3 (Low)
* Tags: tlp:white, type:OSINT

---

## Indicators of Compromise (IOCs)
### External analysis
* link: http://labs.lastline.com/modpos-a-framework-lurking-in-point-of-sale-system-kernels
* comment: Diving deeply into the ModPOS malware framework using sandbox process snapshotting

Point-of-sale (POS) systems are amongst the most valuable targets for attackers today: with direct access to systems processing payment information, miscreants are able to circumvent any encryption between point-of-sale devices and the payment processor, allowing them to spy on - or even tamper with - sensitive payment information.

With ModPOS malware authors have developed a system that not only compromises payment processes at the origin device, but, at the same time, it does so from the kernel of these systems, well outside the reach of most security solutions.

As we will describe in this post, the ModPOS malware is much more than a system for compromising POS systems: it is a versatile framework that allows an  attacker to leverage a practically unlimited range of tools to interfere with a compromised system. Even more, this malware works on any 32-bit Microsoft Windows system (many POS systems on the market today are still running on Microsoft Windows XP) allowing to use this malware on more than just POS systems.

By leveraging process snapshots extracted by the Lastline FUSE sandbox, we walk through the most important parts of this versatile framework. We will show in detail how the infection spreads through the entire operating system, and how the attackers behind ModPOS can leverage the framework to load arbitrary plugins into user- and kernel-space of an infected system.
* link: https://www.virustotal.com/file/2aa35ae062f83248585b924dd668ed0a1a3089550a772900789b0feba1a923bb/analysis/1449594049/

### Network activity
* ip-dst: 130.0.237.22 — The variant that we analyzed for this blog uses an HTTP POST for requesting the page "/robots.txt" on the following IPs
* ip-dst: 109.72.149.42 — The variant that we analyzed for this blog uses an HTTP POST for requesting the page "/robots.txt" on the following IPs

### Payload installation
* md5: <md5>
* sha256: <sha256> — - Xchecked via VT: cf446e1d423afb9933b211d28d3ea33a
* sha1: <sha1> — - Xchecked via VT: cf446e1d423afb9933b211d28d3ea33a
