# Threat Report: 2021-02-02: OSINT - Kobalos – A complex Linux threat to high performance computing infrastructure


## Key Intelligence
* Date: 2021-02-02
* Threat Level: 2 (Medium)
* Tags: type:OSINT, osint:lifetime="perpetual", tlp:white, estimative-language:confidence-in-analytic-judgment="high", misp-galaxy:mitre-attack-pattern="Compromise Client Software Binary - T1554", misp-galaxy:mitre-attack-pattern="Traffic Signaling - T1205", misp-galaxy:mitre-attack-pattern="Clear Command History - T1070.003", misp-galaxy:mitre-attack-pattern="Timestomp - T1070.006", misp-galaxy:mitre-attack-pattern="Software Packing - T1027.002", misp-galaxy:mitre-attack-pattern="Encrypted Channel - T1573", misp-galaxy:mitre-attack-pattern="Proxy - T1090"

---

## Indicators of Compromise (IOCs)
### External analysis
* link: https://github.com/eset/malware-ioc/blob/master/kobalos/README.adoc
* link: https://www.welivesecurity.com/2021/02/02/kobalos-complex-linux-threat-high-performance-computing-infrastructure/

## Objects
### crypto-material — Cryptographic materials such as public or/and private keys.
* [Other] text: RC4
* [Other] text: AE0E05090F3AC2B50B1BC6E91D2FE3CE

### crypto-material — Cryptographic materials such as public or/and private keys.
* [Other] text: RSA
* [Other] text: -----BEGIN PUBLIC KEY-----
MFwwDQYJKoZIhvcNAQEBBQADSwAwSAJBAOUgD8sEF1kZ04QxCd60HrB+TxWnLQED
wzb0sZ8vMMD6xnUAJspdYzSVDnRnKYjTOM43qtLNcJOwVj6cuC1uHHMCAwEAAQ==
-----END PUBLIC KEY-----

### ip-port — An IP address (or domain or hostname) and a port seen as a tuple (or as a triple) in a specific time frame.
* [Network activity] port: 7070
* [Network activity] ip-dst: 151.80.57.191

### file — File object describing a file with meta-information
* [Payload delivery] sha1: <sha1>
* [Other] text: Malicious

### file — File object describing a file with meta-information
* [Payload delivery] md5: <md5>
* [Payload delivery] sha1: <sha1>
* [Payload delivery] sha256: <sha256>

### virustotal-report — VirusTotal report
* [Other] datetime: 2021-02-01T18:56:46+00:00
* [Payload delivery] link: https://www.virustotal.com/gui/file/73576d5a21ec2f164fe37bea86964e18dca1b800a8c7a104223cc35d74e7bd58/detection/f-73576d5a21ec2f164fe37bea86964e18dca1b800a8c7a104223cc35d74e7bd58-1612205806
* [Payload delivery] text: 3/62

### file — File object describing a file with meta-information
* [Payload delivery] sha1: <sha1>
* [Other] text: Malicious

### file — File object describing a file with meta-information
* [Payload delivery] sha1: <sha1>
* [Other] text: Malicious

### file — File object describing a file with meta-information
* [Payload delivery] sha1: <sha1>
* [Other] text: Malicious

### file — File object describing a file with meta-information
* [Payload delivery] sha1: <sha1>
* [Other] text: Malicious

### file — File object describing a file with meta-information
* [Payload delivery] sha1: <sha1>
* [Other] text: Malicious

### file — File object describing a file with meta-information
* [Other] text: /var/run/nscd/ns.pid

### file — File object describing a file with meta-information
* [Payload delivery] sha1: <sha1>
* [Other] text: Malicious

### file — File object describing a file with meta-information
* [Other] text: /var/run/udev/ud.pid

### file — File object describing a file with meta-information
* [Payload delivery] sha1: <sha1>
* [Other] text: Malicious

### file — File object describing a file with meta-information
* [Other] text: /var/run/udevd.pid

### file — File object describing a file with meta-information
* [Payload delivery] sha1: <sha1>
* [Other] text: Malicious

### file — File object describing a file with meta-information
* [Payload delivery] sha1: <sha1>
* [Other] text: Malicious

### file — File object describing a file with meta-information
* [Other] text: /var/run/sshd/sshd.pid

### yara — An object describing a YARA rule (or a YARA rule name) along with its version.
* [Other] text: all
* [Payload installation] yara: rule kobalos
{
    meta:
        description = "Kobalos malware"
        author = "Marc-Etienne M.Léveillé"
        date = "2020-11-02"
        reference = "http://www.welivesecurity.com"
        source = "https://github.com/eset/malware-ioc/"
        license = "BSD 2-Clause"
        version = "1"

    strings:
        $encrypted_strings_sizes = {
            05 00 00 00 09 00 00 00  04 00 00 00 06 00 00 00
            08 00 00 00 08 00 00 00  02 00 00 00 02 00 00 00
            01 00 00 00 01 00 00 00  05 00 00 00 07 00 00 00
            05 00 00 00 05 00 00 00  05 00 00 00 0A 00 00 00
        }
        $password_md5_digest = { 3ADD48192654BD558A4A4CED9C255C4C }
        $rsa_512_mod_header = { 10 11 02 00 09 02 00 }
        $strings_rc4_key = { AE0E05090F3AC2B50B1BC6E91D2FE3CE }

    condition:
        any of them
}

### yara — An object describing a YARA rule (or a YARA rule name) along with its version.
* [Other] text: all
* [Payload installation] yara: rule kobalos_ssh_credential_stealer {
    meta:
        description = "Kobalos SSH credential stealer seen in OpenSSH client"
        author = "Marc-Etienne M.Léveillé"
        date = "2020-11-02"
        reference = "http://www.welivesecurity.com"
        source = "https://github.com/eset/malware-ioc/"
        license = "BSD 2-Clause"
        version = "1"

    strings:
        $ = "user: %.128s host: %.128s port %05d user: %.128s password: %.128s"

    condition:
        any of them
}

### report — Metadata used to generate an executive level report
* [Other] text: ESET researchers have analyzed malware that has been targeting high performance computing (HPC) clusters, among other high-profile targets. We reverse engineered this small, yet complex, malware that is portable to many operating systems including Linux, BSD, Solaris, and possibly AIX and Windows. We have named this malware Kobalos for its tiny code size and many tricks; in Greek mythology, a Kobalos is a small, mischievous creature. Today we publish a paper titled “A wild Kobalos appears: Tricksy Linux malware goes after HPCs” describing the inner working of this threat.

### file — File object describing a file with meta-information
* [Payload delivery] md5: <md5>
* [Payload delivery] sha1: <sha1>
* [Payload delivery] sha256: <sha256>

### virustotal-report — VirusTotal report
* [Other] datetime: 2020-03-04T18:41:56+00:00
* [Payload delivery] link: https://www.virustotal.com/gui/file/75edf6662811d001da179b96bd06d675aa2439fd88a981cc84f24b4a5b4f8f45/detection/f-75edf6662811d001da179b96bd06d675aa2439fd88a981cc84f24b4a5b4f8f45-1583347316
* [Payload delivery] text: 0/61

### file — File object describing a file with meta-information
* [Payload delivery] md5: <md5>
* [Payload delivery] sha1: <sha1>
* [Payload delivery] sha256: <sha256>

### virustotal-report — VirusTotal report
* [Other] datetime: 2021-02-02T11:56:14+00:00
* [Payload delivery] link: https://www.virustotal.com/gui/file/6c36e0341ea1529665de88b690a19a18ea02d2a2a5bae6d745e01efc194e486a/detection/f-6c36e0341ea1529665de88b690a19a18ea02d2a2a5bae6d745e01efc194e486a-1612266974
* [Payload delivery] text: 1/62

### virustotal-report — VirusTotal report
* [Other] datetime: 2021-02-01T18:56:46+00:00
* [Payload delivery] link: https://www.virustotal.com/gui/file/73576d5a21ec2f164fe37bea86964e18dca1b800a8c7a104223cc35d74e7bd58/detection/f-73576d5a21ec2f164fe37bea86964e18dca1b800a8c7a104223cc35d74e7bd58-1612205806
* [Payload delivery] text: 3/62

### file — File object describing a file with meta-information
* [Payload delivery] md5: <md5>
* [Payload delivery] sha1: <sha1>
* [Payload delivery] sha256: <sha256>

### virustotal-report — VirusTotal report
* [Other] datetime: 2021-02-02T08:05:42+00:00
* [Payload delivery] link: https://www.virustotal.com/gui/file/d51cb52136931af5ebd8628b64d6cd1327a99196b102d246f52d878ffb581983/detection/f-d51cb52136931af5ebd8628b64d6cd1327a99196b102d246f52d878ffb581983-1612253142
* [Payload delivery] text: 1/62

### file — File object describing a file with meta-information
* [Payload delivery] md5: <md5>
* [Payload delivery] sha1: <sha1>
* [Payload delivery] sha256: <sha256>

### virustotal-report — VirusTotal report
* [Other] datetime: 2021-02-01T18:58:25+00:00
* [Payload delivery] link: https://www.virustotal.com/gui/file/9ed33b43e679ad98615e1a4e8c46dbeb9b93271625e46f4b4d021099b4b6fb74/detection/f-9ed33b43e679ad98615e1a4e8c46dbeb9b93271625e46f4b4d021099b4b6fb74-1612205905
* [Payload delivery] text: 1/61

### file — File object describing a file with meta-information
* [Payload delivery] md5: <md5>
* [Payload delivery] sha1: <sha1>
* [Payload delivery] sha256: <sha256>

### virustotal-report — VirusTotal report
* [Other] datetime: 2020-03-09T08:44:44+00:00
* [Payload delivery] link: https://www.virustotal.com/gui/file/13cbde1b79ca195a06697df937580c82c0e1cd90cc91c18ddfe4a7802e8e923a/detection/f-13cbde1b79ca195a06697df937580c82c0e1cd90cc91c18ddfe4a7802e8e923a-1583743484
* [Payload delivery] text: 0/59
