# Threat Report: 2020-12-30: RegretLocker - compiled information, activity and samples


## Key Intelligence
* Date: 2020-12-30
* Threat Level: 2 (Medium)
* Tags: misp-galaxy:ransomware="RegretLocker", type:OSINT, osint:lifetime="perpetual", osint:certainty="50", tlp:white

---

## Indicators of Compromise (IOCs)
### Artifacts dropped
* windows-scheduled-task: Mouse Application — Next, it also schedules the malware as a task every minite using this Schtasks.exe command, which is run from cmd.exe using ShellExecuteA.

### Attribution
* text: WIN-295748OMAKG — The malware writter has 2 weird checks to check for a particular user name and PC name(WIN-295748OMAKG). If the user name or the PC name matches, the malware will exit immediately.

### External analysis
* link: http://chuongdong.com/reverse%20engineering/2020/11/17/RegretLocker/
* link: https://twitter.com/VK_Intel/status/1323693700371914753
* link: https://twitter.com/malwrhunterteam/status/1321375502179905536
* link: https://github.com/vxunderground/VXUG-Papers/blob/main/Weaponizing%20Windows%20Virtualization/WeaponizingWindowsVirtualization.pdf
* link: https://app.any.run/tasks/e19eff7c-6d0f-4b09-95da-23f6ab465bb1/

### Network activity
* url: http://344744.cloud4box.ru/files/locker/locker.exe — Source url
* ip-dst: 109.248.203.209

## Objects
### tor-hiddenservice — Tor hidden service (onion service) object.
* [Other] text: http://regretzjibibtcgb.onion/input
* [Other] text: regretzjibibtcgb.onion

### url — url object describes an url along with its normalized field (like extracted using faup parsing library) and its metadata.
* [Network activity] url: http://regretzjibibtcgb.onion/input
* [Other] text: http
* [Network activity] domain: regretzjibibtcgb.onion
* [Network activity] hostname: regretzjibibtcgb.onion

### crypto-material — Cryptographic materials such as public or/and private keys.
* [Other] text: RSA
* [Other] text: -----BEGIN PUBLIC KEY-----
MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQC1ZQInrnhxXCtAN/LsOX2GmgbvBxMsO49lc1/qodshkUvRQLazWv61UbMLKx2gaRQrCYuVrR1Cgd7LxY4ueGo50TqZioAJbCcfzdiXlEkJqLlz4RTU9RFZ/wFjWxChek2NsU6vLLSowPPTw+JhwTooI+QPAIYeoxCf4xz7Kvu9CQIDAQAB
-----END PUBLIC KEY-----
* [Other] text: malware-extraction

### yara — An object describing a YARA rule (or a YARA rule name) along with its version.
* [Payload installation] yara: rule regretlocker {
	meta:
		description = "YARA rule for RegretLocker"
		reference = "http://chuongdong.com/reverse%20engineering/2020/11/17/RegretLocker/"
		author = "@cPeterr"
		tlp = "white"
	strings:
		$str1 = "tor-lib.dll"
		$str2 = "http://regretzjibibtcgb.onion/input"
		$str3 = ".mouse"
		$cmd1 = "taskkill /F /IM \\"
		$cmd2 = "wmic SHADOWCOPY DELETE"
		$cmd3 = "wbadmin DELETE SYSTEMSTATEBACKUP"
		$cmd4 = "bcdedit.exe / set{ default } bootstatuspolicy ignoreallfailures"
		$cmd5 = "bcdedit.exe / set{ default } recoveryenabled No"
		$func1 = "open_virtual_drive()"
		$func2 = "smb_scanner()"
		$checklarge = { 81 fe 00 00 40 06 }
	condition:
		all of ($str*) and any of ($cmd*) and any of ($func*) and $checklarge
}
* [Other] text: 3.7.1
* [Other] text: all

### pe-section — Object describing a section of a Portable Executable
* [Other] text: .text
* [Other] size-in-bytes: 320000
* [Other] float: 6.6348495531091
* [Payload delivery] md5: <md5>
* [Payload delivery] sha1: <sha1>
* [Payload delivery] sha256: <sha256>
* [Payload delivery] sha512: <sha512>
* [Payload delivery] ssdeep: <ssdeep>

### pe-section — Object describing a section of a Portable Executable
* [Other] text: .rdata
* [Other] size-in-bytes: 103936
* [Other] float: 5.3139379645706
* [Payload delivery] md5: <md5>
* [Payload delivery] sha1: <sha1>
* [Payload delivery] sha256: <sha256>
* [Payload delivery] sha512: <sha512>
* [Payload delivery] ssdeep: <ssdeep>

### pe-section — Object describing a section of a Portable Executable
* [Other] text: .data
* [Other] size-in-bytes: 10752
* [Other] float: 4.5643514844553
* [Payload delivery] md5: <md5>
* [Payload delivery] sha1: <sha1>
* [Payload delivery] sha256: <sha256>
* [Payload delivery] sha512: <sha512>
* [Payload delivery] ssdeep: <ssdeep>

### pe-section — Object describing a section of a Portable Executable
* [Other] text: .rsrc
* [Other] size-in-bytes: 39424
* [Other] float: 6.3888085830938
* [Payload delivery] md5: <md5>
* [Payload delivery] sha1: <sha1>
* [Payload delivery] sha256: <sha256>
* [Payload delivery] sha512: <sha512>
* [Payload delivery] ssdeep: <ssdeep>

### pe-section — Object describing a section of a Portable Executable
* [Other] text: .reloc
* [Other] size-in-bytes: 19456
* [Other] float: 6.6017444852914
* [Payload delivery] md5: <md5>
* [Payload delivery] sha1: <sha1>
* [Payload delivery] sha256: <sha256>
* [Payload delivery] sha512: <sha512>
* [Payload delivery] ssdeep: <ssdeep>

### pe — Object describing a Portable Executable
* [Other] text: exe
* [Other] text: 4296533
* [Other] datetime: 2020-10-23T09:56:46+00:00
* [Other] counter: 5

### file — File object describing a file with meta-information
* [Payload delivery] filename: a188e147ba147455ce5e3a6eb8ac1a46bdd58588de7af53d4ad542c6986491f4
* [Other] size-in-bytes: 494592
* [Other] float: 6.58346583069
* [Payload delivery] md5: <md5>
* [Payload delivery] sha1: <sha1>
* [Payload delivery] sha256: <sha256>
* [Payload delivery] sha512: <sha512>
* [Payload delivery] malware-sample: a188e147ba147455ce5e3a6eb8ac1a46bdd58588de7af53d4ad542c6986491f4|3265b2b0afc6d2ad0bdd55af8edb9b37
* [Artifacts dropped] mime-type: PE32 executable (GUI) Intel 80386, for MS Windows
* [Payload delivery] ssdeep: <ssdeep>

### virustotal-report — VirusTotal report
* [Other] datetime: 2020-12-10T18:07:01+00:00
* [Payload delivery] link: https://www.virustotal.com/gui/file/a188e147ba147455ce5e3a6eb8ac1a46bdd58588de7af53d4ad542c6986491f4/detection/f-a188e147ba147455ce5e3a6eb8ac1a46bdd58588de7af53d4ad542c6986491f4-1607623621
* [Payload delivery] text: 63/70

### pe-section — Object describing a section of a Portable Executable
* [Other] text: .text
* [Other] size-in-bytes: 298496
* [Other] float: 6.6475524649073
* [Payload delivery] md5: <md5>
* [Payload delivery] sha1: <sha1>
* [Payload delivery] sha256: <sha256>
* [Payload delivery] sha512: <sha512>
* [Payload delivery] ssdeep: <ssdeep>

### pe-section — Object describing a section of a Portable Executable
* [Other] text: .rdata
* [Other] size-in-bytes: 93696
* [Other] float: 5.4415893542669
* [Payload delivery] md5: <md5>
* [Payload delivery] sha1: <sha1>
* [Payload delivery] sha256: <sha256>
* [Payload delivery] sha512: <sha512>
* [Payload delivery] ssdeep: <ssdeep>

### pe-section — Object describing a section of a Portable Executable
* [Other] text: .data
* [Other] size-in-bytes: 10240
* [Other] float: 4.5555134237561
* [Payload delivery] md5: <md5>
* [Payload delivery] sha1: <sha1>
* [Payload delivery] sha256: <sha256>
* [Payload delivery] sha512: <sha512>
* [Payload delivery] ssdeep: <ssdeep>

### pe-section — Object describing a section of a Portable Executable
* [Other] text: .rsrc
* [Other] size-in-bytes: 39424
* [Other] float: 6.3887459421453
* [Payload delivery] md5: <md5>
* [Payload delivery] sha1: <sha1>
* [Payload delivery] sha256: <sha256>
* [Payload delivery] sha512: <sha512>
* [Payload delivery] ssdeep: <ssdeep>

### pe-section — Object describing a section of a Portable Executable
* [Other] text: .reloc
* [Other] size-in-bytes: 16896
* [Other] float: 6.622890870612
* [Payload delivery] md5: <md5>
* [Payload delivery] sha1: <sha1>
* [Payload delivery] sha256: <sha256>
* [Payload delivery] sha512: <sha512>
* [Payload delivery] ssdeep: <ssdeep>

### pe — Object describing a Portable Executable
* [Other] text: exe
* [Other] text: 4281237
* [Other] datetime: 2020-11-11T09:22:22+00:00
* [Other] counter: 5

### file — File object describing a file with meta-information
* [Payload delivery] filename: c5c7e4f126099586670346024bd37eccf0cce6dd1eb8cfcafbb24530e1c582fa
* [Other] size-in-bytes: 459776
* [Other] float: 6.6161412344098
* [Payload delivery] md5: <md5>
* [Payload delivery] sha1: <sha1>
* [Payload delivery] sha256: <sha256>
* [Payload delivery] sha512: <sha512>
* [Payload delivery] malware-sample: c5c7e4f126099586670346024bd37eccf0cce6dd1eb8cfcafbb24530e1c582fa|83153f8ca7f872a1b4abd40a5bd58094
* [Artifacts dropped] mime-type: PE32 executable (GUI) Intel 80386, for MS Windows
* [Payload delivery] ssdeep: <ssdeep>

### virustotal-report — VirusTotal report
* [Other] datetime: 2020-11-11T09:43:20+00:00
* [Payload delivery] link: https://www.virustotal.com/gui/file/c5c7e4f126099586670346024bd37eccf0cce6dd1eb8cfcafbb24530e1c582fa/detection/f-c5c7e4f126099586670346024bd37eccf0cce6dd1eb8cfcafbb24530e1c582fa-1605087800
* [Payload delivery] text: 39/71

### virustotal-report — VirusTotal report
* [Other] datetime: 2020-12-10T18:07:01+00:00
* [Payload delivery] link: https://www.virustotal.com/gui/file/a188e147ba147455ce5e3a6eb8ac1a46bdd58588de7af53d4ad542c6986491f4/detection/f-a188e147ba147455ce5e3a6eb8ac1a46bdd58588de7af53d4ad542c6986491f4-1607623621
* [Payload delivery] text: 63/70
