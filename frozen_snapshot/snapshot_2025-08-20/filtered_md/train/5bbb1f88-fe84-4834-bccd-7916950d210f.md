# Threat Report: 2018-08-20: OSINT - New Fox Ransomware Matrix Variant Tries Its Best to Close All File Handles


## Key Intelligence
* Date: 2018-08-20
* Threat Level: 3 (Low)
* Tags: tlp:white, malware_classification:malware-category="Ransomware", circl:incident-classification="malware", osint:source-type="blog-post", misp-galaxy:ransomware="Matrix"

---

## Indicators of Compromise (IOCs)
### Artifacts dropped
* text: HOW TO RECOVER YOUR FILES INSTRUCTION
ATENTION!!!
We are realy sorry to inform you that  ALL YOUR FILES WERE ENCRYPTED 
by our automatic software. It became possible because of bad server security.  
ATENTION!!!
Please don't worry, we can help you to RESTORE your server to original
state and decrypt all your files quickly and safely!

INFORMATION!!!
Files are not broken!!!
Files were encrypted with AES-128+RSA-2048 crypto algorithms.
There is no way to decrypt your files without unique decryption key and special software. Your unique decryption key is securely stored on our server. For our safety, all information about your server and your decryption key will be automaticaly DELETED AFTER 7 DAYS! You will irrevocably lose all your data!
* Please note that all the attempts to recover your files by yourself or using third party tools will result only in irrevocable loss of your data!
* Please note that you can recover files only with your unique decryption key, which stored on our side. If you will use the help of third parties, you will only add a middleman.

HOW TO RECOVER FILES???
Please write us to the e-mail (write on English or use professional translator):
PabFox@protonmail.com 
FoxHelp@cock.li
FoxHelp@tutanota.com
You have to send your message on each of our 3 emails due to the fact that the message may not reach their intended recipient for a variety of reasons!
  
In subject line write your personal ID:
[id]
We recommed you to attach 3 encrypted files to your message. We will demonstrate that we can recover your files. 
*   Please note that files must not contain any valuable information and their total size must be less than 5Mb. 

OUR ADVICE!!!
Please be sure that we will find common languge. We will restore all the data and give you recommedations how to configure the protection of your server.

We will definitely reach an agreement ;) !!!

### External analysis
* link: https://www.bleepingcomputer.com/news/security/new-fox-ransomware-matrix-variant-tries-its-best-to-close-all-file-handles/
* text: A new variant of the Matrix Ransomware has been discovered that is renaming encrypted files and then appending the .FOX extension to the file name. Of particular interest, this ransomware could have the most exhaustive process of making sure each and every file is not opened and available for encrypting. Thankfully, this also makes its encryption process very slow so it could be easier to detect.

This ransomware variant was first discovered by security researcher MalwareHunterTeam and is installed through computers running Remote Desktop Services and being openly connected to the Internet. The attackers will scan ranges of IP addresses to find open RDP services and then brute force the password.

### Payload delivery
* email-src: pabfox@protonmail.com
* email-src: foxhelp@cock.li
* email-src: foxhelp@tutanota.com
* filename: %AppData%\random.vbs
* filename: %AppData%\random.bat
* filename: %AppData%\random.bmp
* filename: %DownloadedFolder%\.exe
* filename: %DownloadedFolder%\.bat
* attachment: ransom-note-redacted.jpg — Ransomnote
* attachment: fox-background.jpg — Ransomnote - Desktop background
* attachment: create-task.jpg — At the end of the encryption process, a random named .vbs file in the %AppData% folder will be launched that is used to register a scheduled task named DSHCA. This schedule task is used to run a batch file with administrative privileges that will perform a cleanup of the computer and to disable various repair features.
* attachment: cleanup-batch-file.jpg — This batch file is located in the %AppData% folder as well and will delete shadow volume copies using WMIC, powershell, and vssadmin, remove Windows recovery startup, and delete the VBS file, scheduled task, and itself.

## Objects
### file — File object describing a file with meta-information
* [Payload delivery] sha256: <sha256>
* [Other] text: Malicious

### file — File object describing a file with meta-information
* [Payload delivery] filename: #FOX_README#.rtf
* [Other] text: Malicious

### file — File object describing a file with meta-information
* [Payload delivery] md5: <md5>
* [Payload delivery] sha1: <sha1>
* [Payload delivery] sha256: <sha256>

### virustotal-report — VirusTotal report
* [Other] datetime: 2018-09-27T06:49:04
* [External analysis] link: https://www.virustotal.com/file/0b03bf1c7b596a862978999eebfa0703e6de48912c9a57e2fed3ae5cd747bea7/analysis/1538030944/
* [Other] text: 48/68
