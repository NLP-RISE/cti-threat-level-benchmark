# Threat Report: 2017-05-26: OSINT - Analysis of Emotet v4


## Key Intelligence
* Date: 2017-05-26
* Threat Level: 3 (Low)
* Tags: tlp:white, ms-caro-malware:malware-type="Trojan", misp-galaxy:tool="Emotet"

---

## Indicators of Compromise (IOCs)
### Artifacts dropped
* other: -----BEGIN PUBLIC KEY-----
MHwwDQYJKoZIhvcNAQEBBQADawAwaAJhAJ16QBv5Csq0eruFy4BvTcXmmIyeqUb3
vCCc8K/zOYOpL/Ww6FCdUpvPfs+RR/sLBalwtKmT14iRUaNmJdygnAKUIRWR1HNt
0rQRir0pD4QlkXlnZ9lZazTfyMV8BLCatwIDAQAB
-----END PUBLIC KEY----- — C&C public key
* yara: rule emotet4_basic: trojan
{
meta:
author = "psrok1/mak"
module = "emotet"
strings:
$emotet4_rsa_public = { 8d ?? ?? 5? 8d ?? ?? 5? 6a 00 68 00 80 00 00 ff 35 [4] ff 35 [4] 6a 13 68 01 00 01 00 ff 15 [4] 85 }
$emotet4_cnc_list = { 39 ?? ?5 [4] 0f 44 ?? (FF | A3)}
condition:
all of them
}
* yara: rule emotet4: trojan
{
meta:
author = "psrok1"
module = "emotet"
strings:
$emotet4_x65599 = { 0f b6 ?? 8d ?? ?? 69 ?? 3f 00 01 00 4? 0? ?? 3? ?? 72 }
condition:
any of them and emotet4_basic
}
* yara: rule emotet4_spam : spambot
{
meta:
author="mak"
module="emotet"
strings:
$login="LOGIN" fullword
$startls="STARTTLS" fullword
$mailfrom="MAIL FROM:"
condition:
all of them and emotet4_basic
} — IDS flag not set (false-positive?)

### External analysis
* link: https://www.cert.pl/en/news/single/analysis-of-emotet-v4/
* text: Emotet is a modular Trojan horse, which was firstly noticed in June 2014 by Trend Micro. This malware is related to other types like Geodo, Bugat or Dridex, which are attributed by researches to the same family.

Emotet was discovered as an advanced banker â€“ itâ€™s first campaign targeted clients of German and Austrian banks. Victimsâ€™ bank accounts were infiltrated by a web browser infection which intercept communication between webpage and bank servers. In such scenario, malware hooks specific routines to sniff network activity and steal information. This technique is typical for modern banking malware and is widely known as Man-in-the-Browser attack.

Next, modified release of Emotet banker (v2) has taken advantage of another technique â€“ automation of stealing money from hijacked bank accounts using ATSs (Automated Transfer Systems, more informations on page 20 of CERT Polska Report 2013). This technology is also used in other bankers. Good examples are ISFB (Gozi) or Tinba.

At the beginning of April 2017, we observed wide malspam campaign in Poland, distributing fraudulent mails. E-mails were imitating delivery notifications from DHL logistics company and contained malicious link, which referred to brand-new, unknown variant of Emotet.



Malware distributed in this campaign differed from previously known versions. Behavior and communication methods were similar, but malware used different encryption and we noticed significant changes in its code. Thus we called this modification version 4.
* link: https://www.virustotal.com/file/c53956c95100c5c0ba342977f8fc44fcad35aabc24ec44cb12bb83eee1ed34fa/analysis/1494971561/ — Analysis based on sample - Xchecked via VT: c53956c95100c5c0ba342977f8fc44fcad35aabc24ec44cb12bb83eee1ed34fa
* link: https://www.virustotal.com/file/fe8c3e060969c3e8842bcbcab161cd0ba477d2614115e2cf46588eed30554a12/analysis/1495693771/ — fetched modules (13th April) - Xchecked via VT: 722268bad0d3a2e90aa148d52c60943e
* link: https://www.virustotal.com/file/621c0a11ee0100b8fc3190e471ed4936204e897d97394ba9614ec95f1b69c69c/analysis/1493454650/ — fetched modules (13th April) - Xchecked via VT: 5b2d58b4104309ee9c93b455d39c7314
* link: https://www.virustotal.com/file/1eb9c52548870533246932e12843318a95f876fd873bf4dfec7759214d1c2cc9/analysis/1493439636/ — fetched modules (13th April) - Xchecked via VT: 0497c120248c6f00f1ac37513bd572e5

### Network activity
* url: http://87.106.105.76 — On port 443 C&C
* url: http://173.255.229.121 — On port 443 C&C
* url: http://178.79.177.141 — On port 443 C&C
* url: http://79.170.95.202 — On port 7080 C&C
* url: http://206.214.220.79 — On port 8080 C&C
* url: http://88.198.50.221 — On port 8080 C&C
* url: http://5.39.84.48 — On port 8080 C&C
* url: http://188.68.58.8 — On port 7080 C&C
* url: http://162.214.11.56 — On port 7080 C&C
* url: http://5.196.73.150 — On port 8080 C&C
* url: http://203.121.145.40 — On port 7080 C&C
* url: http://46.165.212.76 — On port 7080 C&C

### Payload delivery
* sha256: <sha256> — Analysis based on sample
* md5: <md5> — fetched modules (13th April)
* md5: <md5> — fetched modules (13th April)
* md5: <md5> — fetched modules (13th April)
* sha1: <sha1> — Analysis based on sample - Xchecked via VT: c53956c95100c5c0ba342977f8fc44fcad35aabc24ec44cb12bb83eee1ed34fa
* md5: <md5> — Analysis based on sample - Xchecked via VT: c53956c95100c5c0ba342977f8fc44fcad35aabc24ec44cb12bb83eee1ed34fa
* sha256: <sha256> — fetched modules (13th April) - Xchecked via VT: 722268bad0d3a2e90aa148d52c60943e
* sha1: <sha1> — fetched modules (13th April) - Xchecked via VT: 722268bad0d3a2e90aa148d52c60943e
* sha256: <sha256> — fetched modules (13th April) - Xchecked via VT: 5b2d58b4104309ee9c93b455d39c7314
* sha1: <sha1> — fetched modules (13th April) - Xchecked via VT: 5b2d58b4104309ee9c93b455d39c7314
* sha256: <sha256> — fetched modules (13th April) - Xchecked via VT: 0497c120248c6f00f1ac37513bd572e5
* sha1: <sha1> — fetched modules (13th April) - Xchecked via VT: 0497c120248c6f00f1ac37513bd572e5
