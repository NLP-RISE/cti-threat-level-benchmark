# Threat Report: 2015-04-07: OSINT Winnti OpSMN new malware RE report by Novetta


## Key Intelligence
* Date: 2015-04-07
* Threat Level: 2 (Medium)
* Tags: tlp:white, type:OSINT

---

## Indicators of Compromise (IOCs)
### Artifacts dropped
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* yara: rule Winnti_Dropper
{
 meta:
  copyright = "Novetta Solutions"
  author = "Novetta Advanced Research Group"

 strings:
  $runner = "%s\\rundll32.exe \"%s\", DlgProc %s"
  $inflate = "Copyright 1995-2005 Mark Adler"
  
 condition:
  $runner and $inflate

}
* yara: rule Winnti_service
{
 meta:
  copyright = "Novetta Solutions"
  author = "Novetta Advanced Research Group"

 strings:
  $newmem = "new memory failed!"
  $value = "can not find value %d\n"
  $onevalue = "find one value %d\n"
  $nofile = "Can not open the file (error %d)"
  
 condition:
  3 of ($newmem, $value, $onevalue, $nofile)

}
* yara: rule Winnti_engine
{
 meta:
  copyright = "Novetta Solutions"
  author = "Novetta Advanced Research Group"

 strings:
  $api1 = "SHCreateItemFromParsingName"
  $datfile = "otfkty.dat"
  $workstart = "work_start"
  $workend = "work_end"
  
 condition:
  ($api1 or $datfile) and ($workstart and $workend)
  

}
* yara: rule Winnti_worker
{
 meta:
  copyright = "Novetta Solutions"
  author = "Novetta Advanced Research Group"

 strings:
  $pango = "pango-basic-win32.dll"
  $tango = "tango.dll"
  $dat = "%s\\%d%d.dat"
  $cryptobase = "%s\\sysprep\\cryptbase.dll"
  
 condition:
  $pango and $tango and $dat and $cryptobase

}
* filename: %SYSDIR%\otfkyt.dat
* filename: %SYSDIR%\wmtsk.dll
* filename: %SYSDIR%\wmm2.dat
* md5: <md5> — Automatically added (via 0798740771dc8f40a5a45a2f58aeab479e2ead6682d67b24fafc46a7ab40c128)
* md5: <md5> — Automatically added (via 0e3d6da65139e01a8f9be0ee63b4510123fc9f644100b00535f7f3b1611ab2ce)
* md5: <md5> — Automatically added (via 2e90ec6594eb5fda2cfb6d46b91e13e9ee3f8941de31b57f366dbe254ee9fc32)
* md5: <md5> — Automatically added (via 4a4e729b5a2212bdcba4314594cbdf8fcbec7146bb1f47b3c99ad6d183bceb38)
* md5: <md5> — Automatically added (via 4a7e8d72dbaf30ebe2328771381912df9387deea6e240f3ad046ba1154250680)
* md5: <md5> — Automatically added (via 52ce11b571aacf298c10d6dce47a60c199f6f58a76b901583bde65d86886cf1f)
* md5: <md5> — Automatically added (via 6aa66eef38c6fcc2d9ab8034723acdaf2af0195749ff713dddaf414d2caea45f)
* md5: <md5> — Automatically added (via 959630cb90c5e3810a8a02c771f37b46388204d2d99a436463cd87411f961ba0)
* md5: <md5> — Automatically added (via b21a5ac48502ff75057f9773bf31abd970ef6c75a2c0ea1c871dd4e81ec5a994)
* md5: <md5> — Automatically added (via bdb451dd67a1101f8437a2f4231abac37d8bcc4b7c7b85bc74ace83e31aaa156)
* md5: <md5> — Automatically added (via df6e40fb0bea1d00c86e0bca493d05a9318ba8e27b015bcadb2fc1d82fa8af04)
* md5: <md5> — Automatically added (via ec198eb746eb1d87315e4ce2cb0d960246da4824f4925d340201288947537bfa)
* md5: <md5> — Automatically added (via f4bf952b5b922a431ad15e4b9a9bc7011a999241187ca93811cec3cdd0a87351)
* md5: <md5> — Automatically added (via f97ba6bdd7893af406d500634d5982184d278b46d392a0f7ad7d7bade0c47fc0)
* sha1: <sha1> — Automatically added (via 0798740771dc8f40a5a45a2f58aeab479e2ead6682d67b24fafc46a7ab40c128)
* sha1: <sha1> — Automatically added (via 0e3d6da65139e01a8f9be0ee63b4510123fc9f644100b00535f7f3b1611ab2ce)
* sha1: <sha1> — Automatically added (via 2e90ec6594eb5fda2cfb6d46b91e13e9ee3f8941de31b57f366dbe254ee9fc32)
* sha1: <sha1> — Automatically added (via 4a4e729b5a2212bdcba4314594cbdf8fcbec7146bb1f47b3c99ad6d183bceb38)
* sha1: <sha1> — Automatically added (via 4a7e8d72dbaf30ebe2328771381912df9387deea6e240f3ad046ba1154250680)
* sha1: <sha1> — Automatically added (via 52ce11b571aacf298c10d6dce47a60c199f6f58a76b901583bde65d86886cf1f)
* sha1: <sha1> — Automatically added (via 6aa66eef38c6fcc2d9ab8034723acdaf2af0195749ff713dddaf414d2caea45f)
* sha1: <sha1> — Automatically added (via 959630cb90c5e3810a8a02c771f37b46388204d2d99a436463cd87411f961ba0)
* sha1: <sha1> — Automatically added (via b21a5ac48502ff75057f9773bf31abd970ef6c75a2c0ea1c871dd4e81ec5a994)
* sha1: <sha1> — Automatically added (via bdb451dd67a1101f8437a2f4231abac37d8bcc4b7c7b85bc74ace83e31aaa156)
* sha1: <sha1> — Automatically added (via df6e40fb0bea1d00c86e0bca493d05a9318ba8e27b015bcadb2fc1d82fa8af04)
* sha1: <sha1> — Automatically added (via ec198eb746eb1d87315e4ce2cb0d960246da4824f4925d340201288947537bfa)
* sha1: <sha1> — Automatically added (via f4bf952b5b922a431ad15e4b9a9bc7011a999241187ca93811cec3cdd0a87351)
* sha1: <sha1> — Automatically added (via f97ba6bdd7893af406d500634d5982184d278b46d392a0f7ad7d7bade0c47fc0)

### External analysis
* link: http://www.novetta.com/wp-content/uploads/2015/04/novetta_winntianalysis.pdf
* link: http://www.novetta.com/wp-content/uploads/2015/04/nov_winnti_yara.txt
* link: http://www.novetta.com/wp-content/uploads/2015/04/vt-winnti.txt
* link: http://www.novetta.com/2015/04/operation-smn-winnti-update/
* text: WinNTI
* text: OpSMN
* text: Operation SMN
