{
    "Event":{
        "threat_level_id":"2",
        "date":"2024-06-19",
        "published":true,
        "info":"New North-Korean based backdoor packs a punch",
        "publish_timestamp":"1719169086",
        "timestamp":"1719169043",
        "Tag":[
            {
                "name":"tlp:white"
            },
            {
                "name":"misp-galaxy:mitre-attack-pattern=\"Boot or Logon Autostart Execution - T1547\""
            },
            {
                "name":"misp-galaxy:mitre-attack-pattern=\"Exfiltration Over C2 Channel - T1041\""
            },
            {
                "name":"misp-galaxy:mitre-attack-pattern=\"Obfuscated Files or Information - T1027\""
            },
            {
                "name":"misp-galaxy:mitre-attack-pattern=\"Application Layer Protocol - T1071\""
            },
            {
                "name":"misp-galaxy:mitre-attack-pattern=\"System Information Discovery - T1082\""
            },
            {
                "name":"misp-galaxy:mitre-attack-pattern=\"User Execution - T1204\""
            },
            {
                "name":"misp-galaxy:mitre-attack-pattern=\"Screen Capture - T1113\""
            },
            {
                "name":"misp-galaxy:mitre-attack-pattern=\"Phishing - T1566\""
            },
            {
                "name":"misp-galaxy:sector=\"Aerospace\""
            },
            {
                "name":"misp-galaxy:sector=\"Defense\""
            },
            {
                "name":"misp-galaxy:country=\"north korea\""
            },
            {
                "name":"misp-galaxy:mitre-intrusion-set=\"Kimsuky - G0094\""
            }
        ],
        "Attribute":[
            {
                "category":"External analysis",
                "comment":"",
                "timestamp":"1719161685",
                "type":"link",
                "value":"https://cyberarmor.tech/new-north-korean-based-backdoor-packs-a-punch/",
                "to_ids":false
            },
            {
                "category":"External analysis",
                "comment":"",
                "timestamp":"1719161685",
                "type":"link",
                "value":"https://cyberarmor.tech/wp-content/uploads/2024/06/New-North-Korean-based-backdoor-packs-a-punch.pdf",
                "to_ids":false
            },
            {
                "category":"Payload delivery",
                "comment":"Payload (encoded)",
                "timestamp":"1719167184",
                "type":"filename",
                "value":"vjVr53p.yOOL",
                "to_ids":false
            },
            {
                "category":"Payload delivery",
                "comment":"Payload",
                "timestamp":"1719167189",
                "type":"filename",
                "value":"zT1fbtn.oN5L",
                "to_ids":false
            },
            {
                "category":"Artifacts dropped",
                "comment":"Payload persistence",
                "timestamp":"1719167209",
                "type":"windows-service-name",
                "value":"CacheDB",
                "to_ids":false
            },
            {
                "category":"Network activity",
                "comment":"C2 server",
                "timestamp":"1719167565",
                "type":"url",
                "value":"http://download.uberlingen.com/index.php",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"C2 server",
                "timestamp":"1719167565",
                "type":"url",
                "value":"http://en.uberlingen.com/index.php",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"C2 server",
                "timestamp":"1719167565",
                "type":"url",
                "value":"http://imagedownload.ignorelist.com/index.php",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"Dropper download server",
                "timestamp":"1719167609",
                "type":"url",
                "value":"http://download-attachments.mooo.com/down.php?ctx=bin&id=danielinternal",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"C2 server",
                "timestamp":"1719167565",
                "type":"url",
                "value":"http://playboys.chickenkiller.com/index.php",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"Payload UA",
                "timestamp":"1719167644",
                "type":"user-agent",
                "value":"Mozilla / 5.0 (Windows NT 10.0; Win64; x64) AppleWebKit / 537.36 (KHTML, like Gecko) Chrome / 109.0.3729.169 Safari / 537.36",
                "to_ids":false
            },
            {
                "category":"Network activity",
                "comment":"Resolved IP from C2 servers",
                "timestamp":"1719167674",
                "type":"ip-dst",
                "value":"67.217.62.219",
                "to_ids":true
            },
            {
                "category":"Payload installation",
                "comment":"",
                "timestamp":"1719167761",
                "type":"yara",
                "value":"import \"pe\"\r\nrule NikiCert\r\n{\r\nmeta:\r\n\tdescription = \"Identifies Nexaweb digital certificate used in (likely) Kimsuky campaign.\"\r\n\tauthor = \"@bartblaze, @nsquar3\"\r\n\tdate = \"2024-06\"\r\n\ttlp = \"White\"\r\n\thash_a = \"cca1705d7a85fe45dce9faec5790d498427b3fa8e546d7d7b57f18a925fdfa5d\"\r\n\thash_b = \"000e2926f6e094d01c64ff972e958cd38590299e9128a766868088aa273599c7\"\r\n\treference = \"https://cyberarmor.tech/new-north-korean-based-backdoor-packs-a-punch/\"\r\n\r\ncondition:\r\n\tuint16(0) == 0x5A4D and\r\n    for any i in (0 .. pe.number_of_signatures) : (\r\n\t\tpe.signatures[i].serial == \"03:15:e1:37:a6:e2:d6:58:f0:7a:f4:54:c6:3a:0a:f2\"\r\n    )\r\n}",
                "to_ids":false
            },
            {
                "category":"Payload installation",
                "comment":"",
                "timestamp":"1719167773",
                "type":"yara",
                "value":"rule NikiGo\r\n{\r\nmeta:\r\n\tdescription = \"Identifies NikiGo, a Go dropper by (likely) Kimsuky.\"\r\n\tauthor = \"@bartblaze, @nsquar3\"\r\n\tdate = \"2024-06\"\r\n\ttlp = \"White\"\r\n\thash = \"000e2926f6e094d01c64ff972e958cd38590299e9128a766868088aa273599c7\"\r\n\treference = \"https://cyberarmor.tech/new-north-korean-based-backdoor-packs-a-punch/\"\r\n\r\nstrings:\r\n\t$go = \"Go build ID:\"\r\n\r\n\t$func1 = \"main.ParseCommandLine\" ascii wide fullword\r\n\t$func2 = \"main.RunCmd\" ascii wide fullword\r\n\t$func3 = \"main.HttpGet\" ascii wide fullword\r\n\t$func4 = \"main.SelfDel\" ascii wide fullword\r\n\t$func5 = \"main.RandomBytes\" ascii wide fullword\r\n\r\n\t$pdb_src = \"C:/Users/niki/go/src/niki/auxiliary/engine-binder/main.go\" ascii wide\r\n\t$pdb_path = \"/Users/niki/go/src/niki/auxiliary/engine-binder/\" ascii wide\r\n\t\r\ncondition:\r\n\tuint16(0) == 0x5A4D and $go and (\r\n\tall of ($func*) or\r\n\tany of ($pdb*)\r\n\t)\r\n}",
                "to_ids":false
            },
            {
                "category":"Payload installation",
                "comment":"",
                "timestamp":"1719167788",
                "type":"yara",
                "value":"rule NikiHTTP\r\n{\r\nmeta:\r\n\tdescription = \"Identifies NikiHTTP, a versatile backdoor by (likely) Kimsuky.\"\r\n\tauthor = \"@bartblaze, @nsquar3\"\r\n\tdate = \"2024-06\"\r\n\ttlp = \"White\"\r\n\thash_a = \"3314b6ea393e180c20db52448ab6980343bc3ed623f7af91df60189fec637744\"\r\n\thash_b = \"c94a5817fcd6a4ea93d47d70b9f2b175923a8b325234a77f127c945ae8649874\"\r\n\treference = \"https://cyberarmor.tech/new-north-korean-based-backdoor-packs-a-punch/\"\r\n\r\nstrings:\r\n\t$cmd = {4? 8d 0d be 2f 03 00 4? 85 c0 4? 8d 15 8c 2f 03 00}\r\n\t$str_1 = \"%s%sc %s >%s 2>&1\" ascii wide\r\n\t$str_2 = \"%s%sc %s 2>%s\" ascii wide\r\n\t$str_3 = \"%s:info\" ascii wide\r\n\t\r\n\t//D:\\02.data\\03.atk-tools\\engine\\niki\\httpSpy\\..\\bin\\httpSpy.pdb\r\n\t$pdb_full = \"\\\\02.data\\\\03.atk-tools\\\\\" ascii wide\r\n\t$pdb_httpspy = \"\\\\bin\\\\httpSpy.pdb\" ascii wide\r\n\t\t\r\n\t$code = { 0f 57 c0 4? 89 7? ?? 33 c0 c7 4? ?? 68 00 00 00 0f 11 4? ?? c7 4? ?? 01 00 00 00 66 4? 89 7? 00 0f 11 4? ?? 4? 89 4? ?? 0f 11 4? ?? c7 44 ?? ?? 53 71 80 60 0f 11 4? ?? c7 44 ?? ?? 71 79 7c 5c 0f 11 4? ?? c7 44 ?? ?? 6d 80 74 63 0f 11 4? ?? 88 44 ?? ?? 0f 11 4? ?? 0f 1f 44 00 00 }\r\n\r\ncondition:\r\n\tuint16(0) == 0x5A4D and (\r\n\t$cmd or (2 of ($str_*)) or\r\n\tany of ($pdb_*) or $code\r\n\t)\r\n}",
                "to_ids":false
            },
            {
                "category":"Artifacts dropped",
                "comment":"",
                "timestamp":"1719168530",
                "type":"pdb",
                "value":"D:\\02.data\\03.atk-tools\\engine\\niki\\httpSpy\\..\\bin\\httpSpy.pdb",
                "to_ids":false
            },
            {
                "category":"External analysis",
                "comment":"",
                "timestamp":"1719169043",
                "type":"link",
                "value":"https://github.com/bartblaze/Yara-rules",
                "to_ids":false
            }
        ],
        "Object":[
            {
                "comment":"",
                "description":"File object describing a file with meta-information",
                "meta-category":"file",
                "name":"file",
                "timestamp":"1719167880",
                "Attribute":[
                    {
                        "category":"Payload delivery",
                        "comment":"RAR archive containing JSE dropper",
                        "timestamp":"1719167817",
                        "type":"sha256",
                        "value":"<sha256>",
                        "to_ids":true
                    },
                    {
                        "category":"Payload delivery",
                        "comment":"",
                        "timestamp":"1719167837",
                        "type":"sha1",
                        "value":"<sha1>",
                        "to_ids":true
                    },
                    {
                        "category":"Payload delivery",
                        "comment":"",
                        "timestamp":"1719167857",
                        "type":"md5",
                        "value":"<md5>",
                        "to_ids":true
                    },
                    {
                        "category":"Payload delivery",
                        "comment":"",
                        "timestamp":"1719167880",
                        "type":"filename",
                        "value":"Safety Manager JD (General Dynamics HR Division II).zip",
                        "to_ids":false
                    }
                ]
            },
            {
                "comment":"",
                "description":"File object describing a file with meta-information",
                "meta-category":"file",
                "name":"file",
                "timestamp":"1719168000",
                "Attribute":[
                    {
                        "category":"Payload delivery",
                        "comment":"JSE Dropper",
                        "timestamp":"1719167931",
                        "type":"sha256",
                        "value":"<sha256>",
                        "to_ids":true
                    },
                    {
                        "category":"Payload delivery",
                        "comment":"",
                        "timestamp":"1719167946",
                        "type":"md5",
                        "value":"<md5>",
                        "to_ids":true
                    },
                    {
                        "category":"Payload delivery",
                        "comment":"",
                        "timestamp":"1719167956",
                        "type":"sha1",
                        "value":"<sha1>",
                        "to_ids":true
                    },
                    {
                        "category":"Payload delivery",
                        "comment":"",
                        "timestamp":"1719168000",
                        "type":"filename",
                        "value":"Safety Manager JD (General Dynamics HR Division II).jse",
                        "to_ids":false
                    }
                ]
            },
            {
                "comment":"decoy file",
                "description":"File object describing a file with meta-information",
                "meta-category":"file",
                "name":"file",
                "timestamp":"1719168134",
                "Attribute":[
                    {
                        "category":"Payload delivery",
                        "comment":"",
                        "timestamp":"1719168114",
                        "type":"sha1",
                        "value":"<sha1>",
                        "to_ids":true
                    },
                    {
                        "category":"Payload delivery",
                        "comment":"",
                        "timestamp":"1719168114",
                        "type":"md5",
                        "value":"<md5>",
                        "to_ids":true
                    },
                    {
                        "category":"Payload delivery",
                        "comment":"",
                        "timestamp":"1719168114",
                        "type":"sha256",
                        "value":"<sha256>",
                        "to_ids":true
                    },
                    {
                        "category":"Payload delivery",
                        "comment":"",
                        "timestamp":"1719168134",
                        "type":"filename",
                        "value":"System Safety Manager JD (General Dynamics HR Division II).pdf",
                        "to_ids":false
                    }
                ]
            },
            {
                "comment":"",
                "description":"File object describing a file with meta-information",
                "meta-category":"file",
                "name":"file",
                "timestamp":"1719168300",
                "Attribute":[
                    {
                        "category":"Payload delivery",
                        "comment":"Payload",
                        "timestamp":"1719168158",
                        "type":"sha256",
                        "value":"<sha256>",
                        "to_ids":true
                    },
                    {
                        "category":"Payload delivery",
                        "comment":"",
                        "timestamp":"1719168172",
                        "type":"md5",
                        "value":"<md5>",
                        "to_ids":true
                    },
                    {
                        "category":"Payload delivery",
                        "comment":"",
                        "timestamp":"1719168182",
                        "type":"sha1",
                        "value":"<sha1>",
                        "to_ids":true
                    },
                    {
                        "category":"Payload delivery",
                        "comment":"",
                        "timestamp":"1719168277",
                        "type":"filename",
                        "value":"zT1fbtn.oN5L",
                        "to_ids":false
                    },
                    {
                        "category":"Payload delivery",
                        "comment":"Internal filename",
                        "timestamp":"1719168300",
                        "type":"filename",
                        "value":"httpSpy.dll",
                        "to_ids":false
                    }
                ]
            },
            {
                "comment":"",
                "description":"File object describing a file with meta-information",
                "meta-category":"file",
                "name":"file",
                "timestamp":"1719168485",
                "Attribute":[
                    {
                        "category":"Payload delivery",
                        "comment":"Payload",
                        "timestamp":"1719168347",
                        "type":"sha256",
                        "value":"<sha256>",
                        "to_ids":true
                    },
                    {
                        "category":"Payload delivery",
                        "comment":"",
                        "timestamp":"1719168363",
                        "type":"md5",
                        "value":"<md5>",
                        "to_ids":true
                    },
                    {
                        "category":"Payload delivery",
                        "comment":"",
                        "timestamp":"1719168374",
                        "type":"sha1",
                        "value":"<sha1>",
                        "to_ids":true
                    },
                    {
                        "category":"Payload delivery",
                        "comment":"Internal filename",
                        "timestamp":"1719168471",
                        "type":"filename",
                        "value":"httpSpy.dll",
                        "to_ids":false
                    },
                    {
                        "category":"Payload delivery",
                        "comment":"",
                        "timestamp":"1719168485",
                        "type":"filename",
                        "value":"icon.ini",
                        "to_ids":false
                    }
                ]
            },
            {
                "comment":"",
                "description":"File object describing a file with meta-information",
                "meta-category":"file",
                "name":"file",
                "timestamp":"1719168600",
                "Attribute":[
                    {
                        "category":"Payload delivery",
                        "comment":"Dropper (ZIP)",
                        "timestamp":"1719168555",
                        "type":"sha256",
                        "value":"<sha256>",
                        "to_ids":true
                    },
                    {
                        "category":"Payload delivery",
                        "comment":"",
                        "timestamp":"1719168571",
                        "type":"md5",
                        "value":"<md5>",
                        "to_ids":true
                    },
                    {
                        "category":"Payload delivery",
                        "comment":"",
                        "timestamp":"1719168585",
                        "type":"sha1",
                        "value":"<sha1>",
                        "to_ids":true
                    },
                    {
                        "category":"Payload delivery",
                        "comment":"",
                        "timestamp":"1719168600",
                        "type":"filename",
                        "value":"Job Description (LM HR Division II).zip",
                        "to_ids":false
                    }
                ]
            },
            {
                "comment":"",
                "description":"File object describing a file with meta-information",
                "meta-category":"file",
                "name":"file",
                "timestamp":"1719168646",
                "Attribute":[
                    {
                        "category":"Payload delivery",
                        "comment":"Dropper",
                        "timestamp":"1719168620",
                        "type":"sha256",
                        "value":"<sha256>",
                        "to_ids":true
                    },
                    {
                        "category":"Payload delivery",
                        "comment":"",
                        "timestamp":"1719168636",
                        "type":"md5",
                        "value":"<md5>",
                        "to_ids":true
                    },
                    {
                        "category":"Payload delivery",
                        "comment":"",
                        "timestamp":"1719168646",
                        "type":"sha1",
                        "value":"<sha1>",
                        "to_ids":true
                    }
                ]
            },
            {
                "comment":"",
                "description":"File object describing a file with meta-information",
                "meta-category":"file",
                "name":"file",
                "timestamp":"1719168819",
                "Attribute":[
                    {
                        "category":"Payload delivery",
                        "comment":"Payload",
                        "timestamp":"1719168705",
                        "type":"sha256",
                        "value":"<sha256>",
                        "to_ids":true
                    },
                    {
                        "category":"Payload delivery",
                        "comment":"",
                        "timestamp":"1719168723",
                        "type":"md5",
                        "value":"<md5>",
                        "to_ids":true
                    },
                    {
                        "category":"Payload delivery",
                        "comment":"",
                        "timestamp":"1719168733",
                        "type":"sha1",
                        "value":"<sha1>",
                        "to_ids":true
                    },
                    {
                        "category":"Payload delivery",
                        "comment":"",
                        "timestamp":"1719168819",
                        "type":"filename",
                        "value":"desktop.ini",
                        "to_ids":false
                    }
                ]
            },
            {
                "comment":"",
                "description":"File object describing a file with meta-information",
                "meta-category":"file",
                "name":"file",
                "timestamp":"1719168929",
                "Attribute":[
                    {
                        "category":"Payload delivery",
                        "comment":"Dropper (Golang)",
                        "timestamp":"1719168858",
                        "type":"sha256",
                        "value":"<sha256>",
                        "to_ids":true
                    },
                    {
                        "category":"Payload delivery",
                        "comment":"",
                        "timestamp":"1719168875",
                        "type":"md5",
                        "value":"<md5>",
                        "to_ids":true
                    },
                    {
                        "category":"Payload delivery",
                        "comment":"",
                        "timestamp":"1719168885",
                        "type":"sha1",
                        "value":"<sha1>",
                        "to_ids":true
                    },
                    {
                        "category":"Payload delivery",
                        "comment":"",
                        "timestamp":"1719168929",
                        "type":"filename",
                        "value":"Automation Manager JD(LM HR II).scr",
                        "to_ids":false
                    }
                ]
            },
            {
                "comment":"",
                "description":"File object describing a file with meta-information",
                "meta-category":"file",
                "name":"file",
                "timestamp":"1719169018",
                "Attribute":[
                    {
                        "category":"Payload delivery",
                        "comment":"Payload",
                        "timestamp":"1719168965",
                        "type":"sha256",
                        "value":"<sha256>",
                        "to_ids":true
                    },
                    {
                        "category":"Payload delivery",
                        "comment":"",
                        "timestamp":"1719168979",
                        "type":"md5",
                        "value":"<md5>",
                        "to_ids":true
                    },
                    {
                        "category":"Payload delivery",
                        "comment":"",
                        "timestamp":"1719168991",
                        "type":"sha1",
                        "value":"<sha1>",
                        "to_ids":true
                    },
                    {
                        "category":"Payload delivery",
                        "comment":"",
                        "timestamp":"1719169018",
                        "type":"filename",
                        "value":"desktop.ini",
                        "to_ids":false
                    }
                ]
            }
        ]
    }
}