{
    "Event":{
        "threat_level_id":"3",
        "date":"2024-04-26",
        "published":true,
        "info":"Unplugging PlugX: Sinkholing the PlugX USB worm botnet",
        "publish_timestamp":"1714158976",
        "timestamp":"1714158837",
        "Tag":[
            {
                "name":"tlp:white"
            },
            {
                "name":"misp-galaxy:mitre-malware=\"PlugX - S0013\""
            },
            {
                "name":"misp-galaxy:mitre-attack-pattern=\"DLL Side-Loading - T1574.002\""
            },
            {
                "name":"misp-galaxy:mitre-intrusion-set=\"Mustang Panda - G0129\""
            }
        ],
        "Attribute":[
            {
                "category":"External analysis",
                "comment":"",
                "timestamp":"1714158164",
                "type":"link",
                "value":"https://blog.sekoia.io/unplugging-plugx-sinkholing-the-plugx-usb-worm-botnet/",
                "to_ids":false
            },
            {
                "category":"Payload delivery",
                "comment":"DLL",
                "timestamp":"1714158511",
                "type":"filename",
                "value":"wsc.dll",
                "to_ids":false
            },
            {
                "category":"Payload delivery",
                "comment":"",
                "timestamp":"1714158777",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"",
                "timestamp":"1714158777",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"",
                "timestamp":"1714158777",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"",
                "timestamp":"1714158777",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"",
                "timestamp":"1714158777",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"",
                "timestamp":"1714158777",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"",
                "timestamp":"1714158777",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"",
                "timestamp":"1714158802",
                "type":"ip-dst",
                "value":"45.251.240.55",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"Sinkholed by Sekoia",
                "timestamp":"1714158802",
                "type":"ip-dst",
                "value":"45.142.166.112",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"",
                "timestamp":"1714158802",
                "type":"ip-dst",
                "value":"103.56.53.46",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"",
                "timestamp":"1714158802",
                "type":"ip-dst",
                "value":"43.254.217.165",
                "to_ids":true
            },
            {
                "category":"Payload installation",
                "comment":"",
                "timestamp":"1714158824",
                "type":"yara",
                "value":"rule apt_MustangPanda_PlugXWorm_lnk {\r\n    meta:\r\n        id = \"bea0b6e6-0999-431d-8ea2-324aa7497657\"\r\n        version = \"1.0\"\r\n        malware = \"PlugXWorm\"\r\n        intrusion_set = \"MustangPanda\"\r\n        description = \"Detects PlugXWorm Malicious LNK\"\r\n        source = \"Sekoia.io\"\r\n        classification = \"TLP:WHITE\"\r\n    strings:\r\n        $ = \"RECYCLER.BIN\\\\1\\\\CEFHelper.exe\" wide\r\n    condition:\r\n        uint32be(0) == 0x4c000000 \r\n        and filesize < 2KB\r\n        and all of them \r\n}",
                "to_ids":false
            },
            {
                "category":"Payload installation",
                "comment":"",
                "timestamp":"1714158837",
                "type":"yara",
                "value":"import \"pe\"\r\nrule apt_MustangPanda_MaliciousDLL_random_exports {\r\n    meta:\r\n        id = \"d14ae417-bc6f-40b1-a027-084522fce516\"\r\n        version = \"1.0\"\r\n        intrusion_set = \"MustangPanda\"\r\n        description = \"Detects malicious DLL used by MustangPanda\"\r\n        source = \"Sekoia.io\"\r\n        classification = \"TLP:WHITE\"\r\n    strings: \r\n    \t$trait = { 66 89 55 FC } \r\n    condition: \r\n    \tpe.is_dll() and filesize < 100KB and \r\n        for any e in pe.export_details: (\r\n        \t$trait in (e.offset..e.offset+50)\r\n            and e.name matches /^[a-z]{10,}$/\r\n        )\r\n        and not pe.is_signed\r\n}",
                "to_ids":false
            }
        ]
    }
}