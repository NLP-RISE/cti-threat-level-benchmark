{
    "Event":{
        "threat_level_id":"1",
        "date":"2023-06-23",
        "published":true,
        "info":"IoT devices and Linux-based systems targeted by OpenSSH trojan campaign",
        "publish_timestamp":"1687502099",
        "timestamp":"1687502095",
        "Tag":[
            {
                "name":"misp-galaxy:malpedia=\"reptile\""
            },
            {
                "name":"tlp:white"
            }
        ],
        "Attribute":[
            {
                "category":"External analysis",
                "comment":"",
                "timestamp":"1687501543",
                "type":"link",
                "value":"https://www.microsoft.com/en-us/security/blog/2023/06/22/iot-devices-and-linux-based-systems-targeted-by-openssh-trojan-campaign/",
                "to_ids":false
            },
            {
                "category":"Other",
                "comment":"",
                "timestamp":"1687501658",
                "type":"comment",
                "value":"The threat actors initiate the attack by attempting to brute force various credentials on misconfigured internet-facing Linux devices. Upon compromising a target device, they disable shell history and retrieve a compromised OpenSSH archive named openssh-8.0p1.tgz from a remote server. The archive contains benign OpenSSH source code alongside several malicious files: the shell script inst.sh, backdoor binaries for multiple architectures (x86-64, arm4l, arm5l, i568, and i686), and an archive containing the shell script vars.sh, which holds embedded files for the backdoor’s operation.",
                "to_ids":false
            },
            {
                "category":"Other",
                "comment":"",
                "timestamp":"1687501686",
                "type":"comment",
                "value":"Once running on a device, the shell script backdoor tests access to /proc to determine whether the device is a honeypot. If it can’t access /proc, it determines the device is a honeypot and exits. Otherwise, it exfiltrates information about the device, including its operating system version, network configuration, and the contents of /etc/passwd and /etc/shadow over email to the hardcoded address dotsysadmin[@]protonmail[.]com, and to any email address provided by the threat actor as an argument to the script.",
                "to_ids":false
            },
            {
                "category":"Other",
                "comment":"",
                "timestamp":"1687501686",
                "type":"comment",
                "value":"On supported systems, the backdoor downloads, compiles, and installs two open-source rootkits available on GitHub, Diamorphine and Reptile. The backdoor configures Reptile to connect to the C2 domain rsh.sys-stat[.]download on port 4444 and to hide its child processes, files, or their content. Microsoft researchers assess that the Diamorphine rootkit is used to hide processes as well.",
                "to_ids":false
            },
            {
                "category":"Network activity",
                "comment":"C2",
                "timestamp":"1687501852",
                "type":"ip-dst",
                "value":"185.161.208.234",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"C2",
                "timestamp":"1687501852",
                "type":"ip-dst",
                "value":"139.180.185.24",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"C2",
                "timestamp":"1687501852",
                "type":"ip-dst",
                "value":"199.247.30.230",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"C2",
                "timestamp":"1687501852",
                "type":"ip-dst",
                "value":"149.28.239.146",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"C2",
                "timestamp":"1687501852",
                "type":"ip-dst",
                "value":"209.250.234.77",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"C2",
                "timestamp":"1687501852",
                "type":"ip-dst",
                "value":"70.34.220.100",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"C2",
                "timestamp":"1687501852",
                "type":"hostname",
                "value":"irc.socialfreedom.party",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"C2",
                "timestamp":"1687501852",
                "type":"hostname",
                "value":"singapore.sg.socialfreedom.party",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"C2",
                "timestamp":"1687501852",
                "type":"hostname",
                "value":"amsterdam.nl.socialfreedom.party",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"C2",
                "timestamp":"1687501852",
                "type":"hostname",
                "value":"frankfurt.de.socialfreedom.party",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"C2",
                "timestamp":"1687501852",
                "type":"hostname",
                "value":"sidney.au.socialfreedom.party",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"C2",
                "timestamp":"1687501852",
                "type":"hostname",
                "value":"losangeles.us.socialfreedom.party",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"C2",
                "timestamp":"1687501852",
                "type":"domain",
                "value":"mumbaitravelers.org",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"C2",
                "timestamp":"1687501852",
                "type":"hostname",
                "value":"sh.madagent.tm",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"C2",
                "timestamp":"1687501852",
                "type":"hostname",
                "value":"ssh.madagent.tm",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"C2",
                "timestamp":"1687501852",
                "type":"hostname",
                "value":"dumpx.madagent.tm",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"C2",
                "timestamp":"1687501852",
                "type":"hostname",
                "value":"reg.madagent.tm",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"C2",
                "timestamp":"1687501852",
                "type":"hostname",
                "value":"sshm.madagent.tm",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"C2",
                "timestamp":"1687501852",
                "type":"hostname",
                "value":"z.madagent.tm",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"C2",
                "timestamp":"1687501852",
                "type":"hostname",
                "value":"ssho.madagent.tm",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"C2",
                "timestamp":"1687501852",
                "type":"hostname",
                "value":"sshr.madagent.tm",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"C2",
                "timestamp":"1687501852",
                "type":"hostname",
                "value":"sshu.madagent.tm",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"C2",
                "timestamp":"1687501852",
                "type":"hostname",
                "value":"user.madagent.tm",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"C2",
                "timestamp":"1687501852",
                "type":"domain",
                "value":"madagent.cc",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"C2",
                "timestamp":"1687501852",
                "type":"hostname",
                "value":"cler.madagent.cc",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"C2",
                "timestamp":"1687501852",
                "type":"hostname",
                "value":"dumpx.madagent.cc",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"C2",
                "timestamp":"1687501852",
                "type":"hostname",
                "value":"mh.madagent.cc",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"C2",
                "timestamp":"1687501852",
                "type":"hostname",
                "value":"ns1.madagent.cc",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"C2",
                "timestamp":"1687501852",
                "type":"hostname",
                "value":"ns2.madagent.cc",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"C2",
                "timestamp":"1687501852",
                "type":"hostname",
                "value":"ns3.madagent.cc",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"C2",
                "timestamp":"1687501852",
                "type":"hostname",
                "value":"ns4.madagent.cc",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"C2",
                "timestamp":"1687501853",
                "type":"hostname",
                "value":"reg.madagent.cc",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"C2",
                "timestamp":"1687501853",
                "type":"hostname",
                "value":"ssh.madagent.cc",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"C2",
                "timestamp":"1687501853",
                "type":"hostname",
                "value":"sshm.madagent.cc",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"C2",
                "timestamp":"1687501853",
                "type":"hostname",
                "value":"ssho.madagent.cc",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"C2",
                "timestamp":"1687501853",
                "type":"hostname",
                "value":"sshr.madagent.cc",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"C2",
                "timestamp":"1687501853",
                "type":"hostname",
                "value":"sshu.madagent.cc",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"C2",
                "timestamp":"1687501853",
                "type":"hostname",
                "value":"user.madagent.cc",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"C2",
                "timestamp":"1687501853",
                "type":"hostname",
                "value":"www.madagent.cc",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"C2",
                "timestamp":"1687501853",
                "type":"hostname",
                "value":"rsh.sys-stat.download",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"C2",
                "timestamp":"1687501853",
                "type":"hostname",
                "value":"sh.sys-stat.download",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"C2",
                "timestamp":"1687501853",
                "type":"hostname",
                "value":"sh.rawdot.net",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"C2",
                "timestamp":"1687501853",
                "type":"hostname",
                "value":"ssho.rawdot.net",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"C2",
                "timestamp":"1687501853",
                "type":"hostname",
                "value":"donate.xmr.rawdot.net",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"C2",
                "timestamp":"1687501853",
                "type":"hostname",
                "value":"pool.rawdot.net",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"C2",
                "timestamp":"1687501853",
                "type":"hostname",
                "value":"2018.rawdot.net",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"C2",
                "timestamp":"1687501853",
                "type":"hostname",
                "value":"blog.rawdot.net",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"C2",
                "timestamp":"1687501853",
                "type":"hostname",
                "value":"clients.rawdot.net",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"C2",
                "timestamp":"1687501853",
                "type":"hostname",
                "value":"ftp.rawdot.net",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"C2",
                "timestamp":"1687501853",
                "type":"hostname",
                "value":"psql01.rawdot.net",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"C2",
                "timestamp":"1687501853",
                "type":"hostname",
                "value":"www.rawdot.net",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"C2",
                "timestamp":"1687501853",
                "type":"hostname",
                "value":"sh.0xbadc0de.stream",
                "to_ids":true
            },
            {
                "category":"Network activity",
                "comment":"C2",
                "timestamp":"1687501853",
                "type":"hostname",
                "value":"ss.0xbadc0de.stream",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"",
                "timestamp":"1687501868",
                "type":"email-src",
                "value":"asterzeu@yahoo.com",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"",
                "timestamp":"1687501868",
                "type":"email-src",
                "value":"dotsysadmin@protonmail.com",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"Script to launch ZiggyStarTux",
                "timestamp":"1687501903",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"ZiggyStarTux",
                "timestamp":"1687501903",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"ZiggyStarTux",
                "timestamp":"1687501903",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"ZiggyStarTux",
                "timestamp":"1687501903",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"ZiggyStarTux",
                "timestamp":"1687501903",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"ZiggyStarTux",
                "timestamp":"1687501903",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"Malicious OpenSSH",
                "timestamp":"1687501923",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"Malicious OpenSSH",
                "timestamp":"1687501923",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"Malicious OpenSSH",
                "timestamp":"1687501923",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"Malicious OpenSSH",
                "timestamp":"1687501923",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"Malicious OpenSSH",
                "timestamp":"1687501923",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"Malicious OpenSSH",
                "timestamp":"1687501923",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"Malicious OpenSSH",
                "timestamp":"1687501923",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"Backdoor",
                "timestamp":"1687501943",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"Backdoor",
                "timestamp":"1687501943",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"Backdoor",
                "timestamp":"1687501943",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"Backdoor",
                "timestamp":"1687501943",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"Backdoor",
                "timestamp":"1687501943",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"Backdoor",
                "timestamp":"1687501943",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"Backdoor",
                "timestamp":"1687501943",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"Backdoor",
                "timestamp":"1687501943",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"Backdoor",
                "timestamp":"1687501943",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"Backdoor",
                "timestamp":"1687501943",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"Backdoor",
                "timestamp":"1687501943",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"Backdoor",
                "timestamp":"1687501943",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"Backdoor",
                "timestamp":"1687501943",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"Backdoor",
                "timestamp":"1687501943",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"vars.sh archive",
                "timestamp":"1687501994",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"vars.sh archive",
                "timestamp":"1687501994",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"vars.sh archive",
                "timestamp":"1687501994",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"Decode utility used by the backdoor",
                "timestamp":"1687502066",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"ss.patch",
                "timestamp":"1687502066",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"inst.sh",
                "timestamp":"1687502066",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"hive-start.tgz",
                "timestamp":"1687502066",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"lssh.tgz",
                "timestamp":"1687502066",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"File from lssh.tgz",
                "timestamp":"1687502088",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"File from lssh.tgz",
                "timestamp":"1687502088",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"File from lssh.tgz",
                "timestamp":"1687502088",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"File from lssh.tgz",
                "timestamp":"1687502088",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"File from lssh.tgz",
                "timestamp":"1687502088",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            }
        ]
    }
}