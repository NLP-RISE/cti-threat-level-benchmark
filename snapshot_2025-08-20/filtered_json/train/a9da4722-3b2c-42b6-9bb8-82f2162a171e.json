{
    "Event":{
        "threat_level_id":"2",
        "date":"2024-01-14",
        "published":true,
        "info":"Cutting Edge: Suspected APT Targets Ivanti Connect Secure VPN in New Zero-Day Exploitation",
        "publish_timestamp":"1705261320",
        "timestamp":"1705261314",
        "Tag":[
            {
                "name":"tlp:white"
            }
        ],
        "Attribute":[
            {
                "category":"External analysis",
                "comment":"",
                "timestamp":"1705261045",
                "type":"link",
                "value":"https://www.mandiant.com/resources/blog/suspected-apt-targets-ivanti-zero-day",
                "to_ids":false
            },
            {
                "category":"External analysis",
                "comment":"",
                "timestamp":"1705261045",
                "type":"link",
                "value":"https://forums.ivanti.com/s/article/CVE-2023-46805-Authentication-Bypass-CVE-2024-21887-Command-Injection-for-Ivanti-Connect-Secure-and-Ivanti-Policy-Secure-Gateways?language=en_US",
                "to_ids":false
            },
            {
                "category":"External analysis",
                "comment":"",
                "timestamp":"1705261070",
                "type":"vulnerability",
                "value":"CVE-2023-46805",
                "to_ids":false
            },
            {
                "category":"External analysis",
                "comment":"",
                "timestamp":"1705261070",
                "type":"vulnerability",
                "value":"CVE-2024-21887",
                "to_ids":false
            },
            {
                "category":"Payload delivery",
                "comment":"Web shell",
                "timestamp":"1705261137",
                "type":"filename",
                "value":"compcheckresult.cgi",
                "to_ids":false
            },
            {
                "category":"Payload delivery",
                "comment":"Web shell dropper",
                "timestamp":"1705261144",
                "type":"filename",
                "value":"sessionserver.sh",
                "to_ids":false
            },
            {
                "category":"Payload delivery",
                "comment":"Credential harvester",
                "timestamp":"1705261149",
                "type":"filename",
                "value":"lastauthserverused.js",
                "to_ids":false
            },
            {
                "category":"Payload delivery",
                "comment":"Web shell",
                "timestamp":"1705261155",
                "type":"filename",
                "value":"visits.py",
                "to_ids":false
            },
            {
                "category":"Payload delivery",
                "comment":"Script",
                "timestamp":"1705261160",
                "type":"filename",
                "value":"sessionserver.pl",
                "to_ids":false
            },
            {
                "category":"Payload delivery",
                "comment":"Passive backdoor",
                "timestamp":"1705261166",
                "type":"filename",
                "value":"libsecure.so.1",
                "to_ids":false
            },
            {
                "category":"Network activity",
                "comment":"WARPWIRE C2",
                "timestamp":"1705261185",
                "type":"domain",
                "value":"symantke.com",
                "to_ids":true
            },
            {
                "category":"Payload installation",
                "comment":"",
                "timestamp":"1705261210",
                "type":"yara",
                "value":"rule M_Hunting_Backdoor_ZIPLINE_1 {\r\n\r\n  meta:\r\n\r\n    author = \"Mandiant\"\r\n\r\n    description = \"This rule detects unique strings in ZIPLINE, a passive ELF backdoor that waits for incoming TCP connections to receive commands from the threat actor.\"\r\n\r\n  strings:\r\n\r\n    $s1 = \"SSH-2.0-OpenSSH_0.3xx\" ascii\r\n\r\n    $s2 = \"$(exec $installer $@)\" ascii\r\n\r\n    $t1 = \"./installer/do-install\" ascii\r\n\r\n    $t2 = \"./installer/bom_files/\" ascii\r\n\r\n    $t3 = \"/tmp/data/root/etc/ld.so.preload\" ascii\r\n\r\n    $t4 = \"/tmp/data/root/home/etc/manifest/exclusion_list\" ascii\r\n\r\n  condition:\r\n\r\n    uint32(0) == 0x464c457f and\r\n\r\n    filesize < 5MB and\r\n\r\n    ((1 of ($s*)) or\r\n\r\n    (3 of ($t*)))\r\n\r\n}",
                "to_ids":false
            },
            {
                "category":"Payload installation",
                "comment":"",
                "timestamp":"1705261223",
                "type":"yara",
                "value":"rule M_Hunting_Dropper_WIREFIRE_1 {\r\n\r\n  meta:\r\n\r\n    author = \"Mandiant\"\r\n\r\n    description = \"This rule detects WIREFIRE, a web shell written in Python that exists as trojanized logic to a component of the pulse secure appliance.\"\r\n\r\n    md5 = \"6de651357a15efd01db4e658249d4981\"\r\n\r\n  strings:\r\n\r\n    $s1 = \"zlib.decompress(aes.decrypt(base64.b64decode(\" ascii\r\n\r\n    $s2 = \"aes.encrypt(t+('\\\\x00'*(16-len(t)%16))\" ascii\r\n\r\n    $s3 = \"Handles DELETE request to delete an existing visits data.\" ascii\r\n\r\n    $s4 = \"request.data.decode().startswith('GIF'):\" ascii\r\n\r\n    $s5 = \"Utils.api_log_admin\" ascii\r\n\r\n  condition:\r\n\r\n    filesize < 10KB\r\n\r\n    and all of them\r\n\r\n}",
                "to_ids":false
            },
            {
                "category":"Payload installation",
                "comment":"",
                "timestamp":"1705261235",
                "type":"yara",
                "value":"rule M_Hunting_Webshell_LIGHTWIRE_2 {\r\n\r\n  meta:\r\n\r\n    author = \"Mandiant\"\r\n\r\n    description = \"Detects LIGHTWIRE based on the RC4 \r\ndecoding and execution 1-liner.\"\r\n\r\n    md5 = \"3d97f55a03ceb4f71671aa2ecf5b24e9\"\r\n\r\n  strings:\r\n\r\n    $re1 = /eval\\{my.{1,20}Crypt::RC4->new\\(\\\".{1,50}->RC4\\\r\n(decode_base64\\(CGI::param\\(\\'.{1,30};eval\\s\\$.{1,30}\\\"Compatibility\r\n\\scheck:\\s\\$@\\\";\\}/\r\n\r\n  condition:\r\n\r\n    filesize < 10KB\r\n\r\n    and all of them\r\n\r\n}",
                "to_ids":false
            },
            {
                "category":"Payload installation",
                "comment":"",
                "timestamp":"1705261246",
                "type":"yara",
                "value":"rule M_Hunting_Dropper_THINSPOOL_1 {\r\n\r\n  meta:\r\n\r\n    author = \"Mandiant\"\r\n\r\n    description = \"This rule detects THINSPOOL, a dropper that \r\ninstalls the LIGHTWIRE web shell onto a Pulse Secure system.\"\r\n\r\n    md5 = \"677c1aa6e2503b56fe13e1568a814754\"\r\n\r\n  strings:\r\n\r\n    $s1 = \"/tmp/qactg/\" ascii\r\n\r\n    $s2 = \"echo '/home/config/dscommands'\" ascii\r\n\r\n    $s3 = \"echo '/home/perl/DSLogConfig.pm'\" ascii\r\n\r\n    $s4 = \"ADM20447\" ascii\r\n\r\n  condition:\r\n\r\n    filesize < 10KB\r\n\r\n    and all of them\r\n\r\n}",
                "to_ids":false
            },
            {
                "category":"Payload installation",
                "comment":"",
                "timestamp":"1705261258",
                "type":"yara",
                "value":"rule M_Hunting_CredTheft_WARPWIRE_1\r\n\r\n{\r\n\r\n  meta:\r\n\r\n    author = \"Mandiant\"\r\n\r\n    description = \"This rule detects WARPWIRE, a credential stealer \r\nwritten in Javascript that is embedded into a legitimate Pulse Secure file.\"\r\n\r\n    md5 = \"d0c7a334a4d9dcd3c6335ae13bee59ea\"\r\n\r\n  strings:\r\n\r\n    $s1 = {76 61 72 20 77 64 61 74 61 20 3d 20 64 6f 63 75 6d 65 6e \r\n74 2e 66 72 6d 4c 6f 67 69 6e 2e 75 73 65 72 6e 61 6d 65 2e 76 61 6c 75 65 3b}\r\n\r\n    $s2 = {76 61 72 20 73 64 61 74 61 20 3d 20 64 6f 63 75 6d 65 6e \r\n74 2e 66 72 6d 4c 6f 67 69 6e 2e 70 61 73 73 77 6f 72 64 2e 76 61 6c 75 65 3b}\r\n\r\n    $s3 = {2b 77 64 61 74 61 2b 27 26 27 2b 73 64 61 74 61 3b}\r\n\r\n    $s4 = {76 61 72 20 78 68 72 20 3d 20 6e 65 77 20 58 4d 4c 48 \r\n74 74 70 52 65 71 75 65 73 74}\r\n\r\n    $s5 = \"Remember the last selected auth realm for 30 days\" ascii\r\n\r\n  condition:\r\n\r\n   filesize < 8KB and \r\n\r\nall of them\r\n\r\n}",
                "to_ids":false
            },
            {
                "category":"Other",
                "comment":"",
                "timestamp":"1705261314",
                "type":"comment",
                "value":"Ivanti Connect Secure VPN (“CS”, formerly Pulse Secure)",
                "to_ids":false
            },
            {
                "category":"Other",
                "comment":"",
                "timestamp":"1705261314",
                "type":"comment",
                "value":"Ivanti Policy Secure (“PS”) appliances",
                "to_ids":false
            }
        ]
    }
}