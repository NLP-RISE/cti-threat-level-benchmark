{
    "Event":{
        "threat_level_id":"3",
        "date":"2017-03-09",
        "published":true,
        "info":"OSINT - RawPOS Malware Rides Again",
        "publish_timestamp":"1489943413",
        "timestamp":"1489943379",
        "Tag":[
            {
                "name":"tlp:white"
            },
            {
                "name":"osint:source-type=\"blog-post\""
            },
            {
                "name":"veris:asset:variety=\"U - POS terminal\""
            }
        ],
        "Attribute":[
            {
                "category":"External analysis",
                "comment":"",
                "timestamp":"1489943379",
                "type":"link",
                "value":"https://www.cylance.com/en_us/blog/rawpos-malware.html",
                "to_ids":false
            },
            {
                "category":"External analysis",
                "comment":"",
                "timestamp":"1489943379",
                "type":"text",
                "value":"As part of a recent forensics investigation by the Cylance Consulting Services team, we uncovered some new RawPOS malware. This family of POS malware has been widely documented in operation since 2008. Numerous retail operations of various sizes have been compromised with this malware and its variants.\r\n\r\nRather than rehash old malware, our intent is to discuss â€˜signature fidelityâ€™ and explain through technical detail why poorly-written signatures give people a false sense of security. This â€˜antivirus is deadâ€™ argument is often presented, but with little technical detail to highlight specifically why this is the case.\r\n\r\nIn our example below, the RawPOS variant went undetected for well over 30 days by a legacy antivirus (AV) vendor. By the time the vendor deployed custom DAT files, the only samples identified were in the quarantine directory of CylancePROTECTÂ®. Fortunately, this customer deployed CylancePROTECT in time and prevented any data exfiltration.\r\n\r\nAt the end of this post, weâ€™ll provide an updated yara file for identifying all variants of the RawPOS dumper, as well as some sha256 hashes of the new variant.",
                "to_ids":false
            },
            {
                "category":"Artifacts dropped",
                "comment":"",
                "timestamp":"1489943379",
                "type":"yara",
                "value":"rule RawPOS_dumper\r\n\r\n{\r\n\r\n meta:\r\n\r\n author = \"Cylance Inc.\"\r\n\r\n date = \"2017-01-24\"\r\n\r\n description = \"Used to detect all RawPOS RAM dumper(s)\"\r\n\r\n               strings:\r\n\r\n                              $time_func = { 55 8b ec 81 c4 ?? ?? ?? ?? 53 56 57 8b ?? ?? 8b ?? ?? 6a 00 e8 ?? ?? ?? ?? 59 a3 ?? ?? ?? ?? 6a 00 e8 ?? ?? ?? ?? 59 3d ?? ?? ?? ?? 7e ?? 33 c0 e9 ?? ?? ?? ??}\r\n\r\n $enum_proc_func = { 55 8b ec 81 c4 ?? ?? ?? ?? 50 81 c4 ?? ?? ?? ?? 53 56 57 be c8 b9 42 00 8d ?? ?? ?? ?? ?? b9 41 00 00 00 f3 ?? 8d ?? ?? 50 68 a0 0f 00 00 8d ?? ?? ?? ?? ?? 52 e8 ?? ?? ?? ?? 85 c0 0f ?? ?? ?? ?? ??}\r\n\r\n $open_proc_func = { 8b f0 85 f6 0f ?? ?? ?? ?? ?? 8d ?? ?? 50 6a 04 8d ?? ?? 52 56 e8 ?? ?? ?? ?? 85 c0 74 ?? 68 04 01 00 00 8d ?? ?? ?? ?? ?? 51 ff ?? ?? 56 e8 ?? ?? ?? ?? 56 e8 ?? ?? ?? ??}\r\n\r\n               condition:\r\n\r\n                              $enum_proc_func or $time_func or $open_proc_func\r\n\r\n}",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"New Variant",
                "timestamp":"1489943379",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"New Variant",
                "timestamp":"1489943379",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"New Variant",
                "timestamp":"1489943379",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"New Variant",
                "timestamp":"1489943379",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"New Variant",
                "timestamp":"1489943379",
                "type":"sha256",
                "value":"<sha256>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"New Variant - Xchecked via VT: 967fcbc7abcb328afb1dbfd72d68636c478d7369e674d622799b8dfd66230112",
                "timestamp":"1489943387",
                "type":"sha1",
                "value":"<sha1>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"New Variant - Xchecked via VT: 967fcbc7abcb328afb1dbfd72d68636c478d7369e674d622799b8dfd66230112",
                "timestamp":"1489943388",
                "type":"md5",
                "value":"<md5>",
                "to_ids":true
            },
            {
                "category":"External analysis",
                "comment":"New Variant - Xchecked via VT: 967fcbc7abcb328afb1dbfd72d68636c478d7369e674d622799b8dfd66230112",
                "timestamp":"1489943389",
                "type":"link",
                "value":"https://www.virustotal.com/file/967fcbc7abcb328afb1dbfd72d68636c478d7369e674d622799b8dfd66230112/analysis/1489006314/",
                "to_ids":false
            },
            {
                "category":"Payload delivery",
                "comment":"New Variant - Xchecked via VT: 4bd1cc0a38117af7d268c29592ef754e51ce5674e26168c6bb613302f3c62fb8",
                "timestamp":"1489943389",
                "type":"sha1",
                "value":"<sha1>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"New Variant - Xchecked via VT: 4bd1cc0a38117af7d268c29592ef754e51ce5674e26168c6bb613302f3c62fb8",
                "timestamp":"1489943390",
                "type":"md5",
                "value":"<md5>",
                "to_ids":true
            },
            {
                "category":"External analysis",
                "comment":"New Variant - Xchecked via VT: 4bd1cc0a38117af7d268c29592ef754e51ce5674e26168c6bb613302f3c62fb8",
                "timestamp":"1489943391",
                "type":"link",
                "value":"https://www.virustotal.com/file/4bd1cc0a38117af7d268c29592ef754e51ce5674e26168c6bb613302f3c62fb8/analysis/1484975136/",
                "to_ids":false
            },
            {
                "category":"Payload delivery",
                "comment":"New Variant - Xchecked via VT: 0ca08c10a79cddbb359354f59ba988e77892e16dce873b5ba8e20eb053af8a18",
                "timestamp":"1489943392",
                "type":"sha1",
                "value":"<sha1>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"New Variant - Xchecked via VT: 0ca08c10a79cddbb359354f59ba988e77892e16dce873b5ba8e20eb053af8a18",
                "timestamp":"1489943393",
                "type":"md5",
                "value":"<md5>",
                "to_ids":true
            },
            {
                "category":"External analysis",
                "comment":"New Variant - Xchecked via VT: 0ca08c10a79cddbb359354f59ba988e77892e16dce873b5ba8e20eb053af8a18",
                "timestamp":"1489943394",
                "type":"link",
                "value":"https://www.virustotal.com/file/0ca08c10a79cddbb359354f59ba988e77892e16dce873b5ba8e20eb053af8a18/analysis/1485335247/",
                "to_ids":false
            },
            {
                "category":"Payload delivery",
                "comment":"New Variant - Xchecked via VT: fe8637ef9be609951aa218942d46a535ba771236668a49a84512b18b02e9fbee",
                "timestamp":"1489943395",
                "type":"sha1",
                "value":"<sha1>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"New Variant - Xchecked via VT: fe8637ef9be609951aa218942d46a535ba771236668a49a84512b18b02e9fbee",
                "timestamp":"1489943395",
                "type":"md5",
                "value":"<md5>",
                "to_ids":true
            },
            {
                "category":"External analysis",
                "comment":"New Variant - Xchecked via VT: fe8637ef9be609951aa218942d46a535ba771236668a49a84512b18b02e9fbee",
                "timestamp":"1489943396",
                "type":"link",
                "value":"https://www.virustotal.com/file/fe8637ef9be609951aa218942d46a535ba771236668a49a84512b18b02e9fbee/analysis/1480241460/",
                "to_ids":false
            },
            {
                "category":"Payload delivery",
                "comment":"New Variant - Xchecked via VT: a2e720a2c538347144aee50ae85ebfdaf3fdffcfc731af732be5d3d82cd08b18",
                "timestamp":"1489943397",
                "type":"sha1",
                "value":"<sha1>",
                "to_ids":true
            },
            {
                "category":"Payload delivery",
                "comment":"New Variant - Xchecked via VT: a2e720a2c538347144aee50ae85ebfdaf3fdffcfc731af732be5d3d82cd08b18",
                "timestamp":"1489943398",
                "type":"md5",
                "value":"<md5>",
                "to_ids":true
            },
            {
                "category":"External analysis",
                "comment":"New Variant - Xchecked via VT: a2e720a2c538347144aee50ae85ebfdaf3fdffcfc731af732be5d3d82cd08b18",
                "timestamp":"1489943399",
                "type":"link",
                "value":"https://www.virustotal.com/file/a2e720a2c538347144aee50ae85ebfdaf3fdffcfc731af732be5d3d82cd08b18/analysis/1489006314/",
                "to_ids":false
            }
        ]
    }
}