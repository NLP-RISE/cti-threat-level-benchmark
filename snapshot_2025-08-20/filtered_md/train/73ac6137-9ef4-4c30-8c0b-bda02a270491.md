# Threat Report: 2023-11-15: Sandworm Disrupts Power in Ukraine Using a Novel Attack Against Operational Technology


## Key Intelligence
* Date: 2023-11-15
* Threat Level: 2 (Medium)
* Tags: tlp:white, misp-galaxy:country="ukraine", misp-galaxy:target-information="Ukraine", misp-galaxy:mitre-attack-pattern="Replication Through Removable Media - T1458", misp-galaxy:mitre-attack-pattern="Indicator Removal - T1070", misp-galaxy:mitre-attack-pattern="Command and Scripting Interpreter - T1623", misp-galaxy:mitre-attack-pattern="Command-Line Interface - T1605", misp-galaxy:mitre-attack-pattern="Data Destruction - T1485", misp-galaxy:mitre-intrusion-set="Sandworm Team - G0034"

---

## Indicators of Compromise (IOCs)
### External analysis
* link: https://www.mandiant.com/resources/blog/sandworm-disrupts-power-ukraine-operational-technology

### Network activity
* ip-dst: 82.180.150.197 — Source IP address for requests to Neo-REGEORG
* ip-dst: 176.119.195.113 — Source IP address for requests to Neo-REGEORG
* ip-dst: 176.119.195.115 — Source IP address for requests to Neo-REGEORG
* ip-dst: 185.220.101.58 — Source IP address for requests to Neo-REGEORG
* ip-dst: 190.2.145.24 — C2 for GOGETTER
* user-agent: Mozilla/5.0 (X11; Linux x86_64; rv:91.0) Gecko/20100101 Firefox/91.0 — User agent for requests to Neo-REGEORG
* user-agent: Mozilla/5.0 (X11; Linux x86_64; rv:38.0) Gecko/20100101 Firefox/38.0 — User agent for requests to Neo-REGEORG

### Payload delivery
* filename: n.bat — Likely runs scilc.exe
* filename: a.iso — Likely runs scilc.exe
* filename: Files.xml — Part of TANKTRAP Group Policy; File Copy
* filename: s1.txt — Likely contains SCIL commands

### Payload installation
* yara: rule M_Methodology_MicroSCADA_SCILC_Strings

{

     meta:

          author = "Mandiant"

          date = "2023-02-13"

          description = "Searching for files containing strings associated with the MicroSCADA Supervisory Control Implementation Language (SCIL) scilc.exe binary." 

          disclaimer = "This rule is for hunting purposes only and has not been tested to run in a production environment."

 

     strings:

          $s1 = "scilc.exe" ascii wide

          $s2 = "Scilc.exe" ascii wide

          $s3 = "SCILC.exe" ascii wide

          $s4 = "SCILC.EXE" ascii wide

 

     condition:

          filesize < 1MB and

          any of them

}
* yara: rule M_Hunting_MicroSCADA_SCILC_Program_Execution_Strings

{

     meta:

          author = "Mandiant"

          date = "2023-02-13"

          description = "Searching for files containing strings associated with execution of the MicroSCADA Supervisory Control Implementation Language (SCIL) scilc.exe binary." 

          disclaimer = "This rule is for hunting purposes only and has not been tested to run in a production environment."

 

     strings:

          $s = "scilc.exe -do" nocase ascii wide

 

     condition:

          filesize < 1MB and 

          all of them

}
* yara: rule M_Methodology_MicroSCADA_Path_Strings

{

     meta:

          author = "Mandiant"

          date = "2023-02-27"

          description = "Searching for files containing references to MicroSCADA filesystem path containing native MicroSCADA binaries and resources." 

          disclaimer = "This rule is for hunting purposes only and has not been tested to run in a production environment."

 

     strings:

          $s1 = "sc\\prog\\exec" nocase ascii wide

 

     condition:

          filesize < 1MB and

          $s1

}
* yara: rule M_Hunting_VBS_Batch_Launcher_Strings

{

     meta:

          author = "Mandiant"

          date = "2023-02-13"

          description = "Searching for VBS files used to launch a batch script."

          disclaimer = "This rule is for hunting purposes only and has not been tested to run in a production environment."

 

     strings:

          $s1 = "CreateObject(\"WScript.Shell\")" ascii

          $s2 = "WshShell.Run chr(34) &" ascii

          $s3 = "& Chr(34), 0" ascii

          $s4 = "Set WshShell = Nothing" ascii

          $s5 = ".bat" ascii

    

     condition:

          filesize < 400 and 

          all of them

}
* yara: rule M_Hunting_APT_Webshell_PHP_NEOREGEORG 

{

     meta:

          author = "Mandiant"

          description = "Searching for REGEORG webshells."

          disclaimer = "This rule is for hunting purposes only and has not been tested to run in a production environment."

 

     strings:

          $php = "<?php" nocase

          $regeorg1 = {24 72 61 77 50 6f 73 74 44 61 74 61 20 3d 20 66 69 6c 65 5f 67 65 74 5f 63 6f 6e 74 65 6e 74 73 28 22 70 68 70 3a 2f 2f 69 6e 70 75 74 22 29 3b}

          $regeorg2 = {20 24 77 72 69 74 65 42 75 66 66 20 3d 20 24 5f 53 45 53 53 49 4f 4e 5b 24 77 72 69 74 65 62 75 66 5d 3b}

          $regeorg3 = {20 75 73 6c 65 65 70 28 35 30 30 30 30 29 3b}

          $regeorg4 = {20 24 61 72 68 5f 6b 65 79 20 3d 20 70 72 65 67 5f 72 65 70 6c 61 63 65 28 24 72 78 5f 68 74 74 70 2c 20 27 27 2c 20 24 6b 65 79 29 3b}

          $regeorg5 = {20 24 72 75 6e 6e 69 6e 67 20 3d 20 24 5f 53 45 53 53 49 4f 4e 5b 24 72 75 6e 5d 3b}

          $regeorg6 = {20 24 72 78 5f 68 74 74 70 20 3d 20 27 2f 5c 41 48 54 54 50 5f 2f 27 3b}

 

     condition:

          (5 of ($regeorg*)) and

          $php

}
* yara: rule M_Hunting_GOGETTER_SystemdConfiguration_1

{

     meta:

          author = "Mandiant"

          description = "Searching for Systemd Unit Configuration Files but with some known filenames observed with GOGETTER"

          disclaimer = "This rule is for hunting purposes only and has not been tested to run in a production environment."

 

     strings:

          $a1 = "[Install]" ascii fullword

          $a2 = "[Service]" ascii fullword

          $a3 = "[Unit]" ascii fullword

          $v1 = "Description=" ascii 

          $v2 = "ExecStart=" ascii 

          $v3 = "Restart=" ascii 

          $v4 = "RestartSec=" ascii 

          $v5 = "WantedBy=" ascii 

          $f1 = "fail2ban-settings" ascii fullword

          $f2 = "system-sockets" ascii fullword

          $f3 = "oratredb" ascii fullword

          $f4 = "cloud-online" ascii fullword

 

     condition:

          filesize < 1MB and (3 of ($a*)) and (3 of ($v*)) and (1 of ($f*))

}

## Objects
### file — File object describing a file with meta-information
* [Payload delivery] filename: Functions.php — Neo-REGEORG
* [Payload delivery] md5: <md5> — Neo-REGEORG

### file — File object describing a file with meta-information
* [Payload delivery] filename: lun.vbs — Runs n.bat
* [Payload delivery] md5: <md5> — Runs n.bat

### file — File object describing a file with meta-information
* [Payload delivery] filename: msserver.exe — CADDYWIPER
* [Payload delivery] filename: lhh.exe — CADDYWIPER
* [Payload delivery] md5: <md5> — CADDYWIPER

### file — File object describing a file with meta-information
* [Payload delivery] filename: ScheduledTasks.xml — Part of TANKTRAP Group Policy; Task
* [Payload delivery] md5: <md5> — Part of TANKTRAP Group Policy; Task

### file — File object describing a file with meta-information
* [Payload delivery] md5: <md5> — Part of TANKTRAP Group Policy; Task
* [Payload delivery] filename: ScheduledTasks.xml — Part of TANKTRAP Group Policy; Task

### file — File object describing a file with meta-information
* [Payload delivery] md5: <md5> — GOGETTER
* [Payload delivery] filename: cloud-online
