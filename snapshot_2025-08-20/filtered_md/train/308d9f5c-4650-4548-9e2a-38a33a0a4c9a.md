# Threat Report: 2024-10-07: OSINT - Mamba 2FA: A new contender in the AiTM phishing ecosystem


## Key Intelligence
* Date: 2024-10-07
* Threat Level: 3 (Low)
* Tags: type:OSINT, osint:lifetime="perpetual", osint:certainty="50", tlp:white, tlp:clear, misp-galaxy:producer="Sekoia", misp-galaxy:mitre-attack-pattern="Phishing - T1566"

---

## Indicators of Compromise (IOCs)
### Network activity
* domain: drensyoons1sedt.com — Outgoing connection to domains of Mamba 2FA relay servers:
* domain: sandoom2notnt.com — Outgoing connection to domains of Mamba 2FA relay servers:
* domain: grastoonm3vides.com — Outgoing connection to domains of Mamba 2FA relay servers:
* domain: ccokies1cakes.com — Outgoing connection to domains of Mamba 2FA relay servers:
* domain: ccokies2mangoes.com — Outgoing connection to domains of Mamba 2FA relay servers:
* domain: ccokies3tomatoes.com — Outgoing connection to domains of Mamba 2FA relay servers:
* domain: m1tis-apicookies.com — Outgoing connection to domains of Mamba 2FA relay servers:
* domain: m2fes-apicookies.com — Outgoing connection to domains of Mamba 2FA relay servers:
* domain: m3mas-apicookies.com — Outgoing connection to domains of Mamba 2FA relay servers:
* domain: winss0conect.click — Outgoing connection to domains of Mamba 2FA relay servers:
* domain: winstnet80nss.cfd — Outgoing connection to domains of Mamba 2FA relay servers:
* domain: tenetur.top — Outgoing connection to domains of Mamba 2FA relay servers:
* domain: tenetur.xyz — Outgoing connection to domains of Mamba 2FA relay servers:
* domain: hypexfinancial.com — The following domains were used previously, between November 2023 and July 2024:
* domain: voltampereactive.com — The following domains were used previously, between November 2023 and July 2024:
* domain: planchereserver.com — The following domains were used previously, between November 2023 and July 2024:
* domain: thirdmandomavis.com — The following domains were used previously, between November 2023 and July 2024:
* domain: fourthmanservice.com — The following domains were used previously, between November 2023 and July 2024:
* domain: sithchibb.com — The following domains were used previously, between November 2023 and July 2024:
* domain: copelustration.xyz — The following domains were used previously, between November 2023 and July 2024:
* domain: copefood.xyz — The following domains were used previously, between November 2023 and July 2024:
* domain: seven-oranges.com — The following domains were used previously, between November 2023 and July 2024:
* domain: onemanforest.com — The following domains were used previously, between November 2023 and July 2024:
* domain: twomancake.com — The following domains were used previously, between November 2023 and July 2024:
* domain: threemanshop.com — The following domains were used previously, between November 2023 and July 2024:
* domain: fourmanchurch.com — The following domains were used previously, between November 2023 and July 2024:
* domain: fivemanchool.com — The following domains were used previously, between November 2023 and July 2024:
* domain: sixmanteams.com — The following domains were used previously, between November 2023 and July 2024:
* domain: sevenmanjungle.com — The following domains were used previously, between November 2023 and July 2024:
* domain: 88mansession.com — The following domains were used previously, between November 2023 and July 2024:
* domain: fiveradio-newbam.com — The following domains were used previously, between November 2023 and July 2024:
* domain: nine9manforest.com — The following domains were used previously, between November 2023 and July 2024:
* domain: 10decadesmen.com — The following domains were used previously, between November 2023 and July 2024:
* domain: 11cyclesforest.com — The following domains were used previously, between November 2023 and July 2024:
* domain: 1messisnfarm.com — The following domains were used previously, between November 2023 and July 2024:
* domain: 2moniunesson.com — The following domains were used previously, between November 2023 and July 2024:
* domain: 3alphabetjay.com — The following domains were used previously, between November 2023 and July 2024:
* domain: 4sessionmoon.com — The following domains were used previously, between November 2023 and July 2024:
* domain: 5poleanalhy.com — The following domains were used previously, between November 2023 and July 2024:
* domain: 6treesmangle.com — The following domains were used previously, between November 2023 and July 2024:
* domain: 7motionmansa.com — The following domains were used previously, between November 2023 and July 2024:
* domain: 8boomandool.com — The following domains were used previously, between November 2023 and July 2024:
* domain: 9cantronnfit.com — The following domains were used previously, between November 2023 and July 2024:
* domain: 10trioneyue8ss.com — The following domains were used previously, between November 2023 and July 2024:
* domain: 11beamgools.com — The following domains were used previously, between November 2023 and July 2024:
* ip-dst: 45.61.130.11 — The following IP addresses were used previously, between November 2023 and July 2024 (non-exhaustive list):
* ip-dst: 45.61.169.4 — The following IP addresses were used previously, between November 2023 and July 2024 (non-exhaustive list):
* ip-dst: 172.86.64.212 — The following IP addresses were used previously, between November 2023 and July 2024 (non-exhaustive list):
* ip-dst: 172.86.96.84 — The following IP addresses were used previously, between November 2023 and July 2024 (non-exhaustive list):
* ip-dst: 172.86.96.128 — The following IP addresses were used previously, between November 2023 and July 2024 (non-exhaustive list):
* ip-dst: 172.86.97.78 — The following IP addresses were used previously, between November 2023 and July 2024 (non-exhaustive list):
* ip-dst: 172.86.97.165 — The following IP addresses were used previously, between November 2023 and July 2024 (non-exhaustive list):
* ip-dst: 172.86.104.33 — The following IP addresses were used previously, between November 2023 and July 2024 (non-exhaustive list):
* ip-dst: 172.86.104.64 — The following IP addresses were used previously, between November 2023 and July 2024 (non-exhaustive list):
* ip-dst: 172.86.104.178 — The following IP addresses were used previously, between November 2023 and July 2024 (non-exhaustive list):
* ip-dst: 172.86.105.59 — The following IP addresses were used previously, between November 2023 and July 2024 (non-exhaustive list):
* ip-dst: 172.86.105.72 — The following IP addresses were used previously, between November 2023 and July 2024 (non-exhaustive list):
* ip-dst: 172.86.106.94 — The following IP addresses were used previously, between November 2023 and July 2024 (non-exhaustive list):
* ip-dst: 2607:5500:3000:1cab::2 — Between August and October 2024, Entra/M365 sign-ins from IP addresses of Mamba 2FA relay servers:
* ip-dst: 2607:5500:3000:7bc::2 — Between August and October 2024, Entra/M365 sign-ins from IP addresses of Mamba 2FA relay servers:
* ip-dst: 2607:5500:3000:312::2 — Between August and October 2024, Entra/M365 sign-ins from IP addresses of Mamba 2FA relay servers:
* ip-dst: 2607:5500:3000:7a5::2 — Between August and October 2024, Entra/M365 sign-ins from IP addresses of Mamba 2FA relay servers:
* ip-dst: 2607:5500:3000:a8c::2 — Between August and October 2024, Entra/M365 sign-ins from IP addresses of Mamba 2FA relay servers:
* ip-dst: 2607:5500:3000:fea::2 — Between August and October 2024, Entra/M365 sign-ins from IP addresses of Mamba 2FA relay servers:
* ip-dst: 2607:5500:3000:b16::2 — Between August and October 2024, Entra/M365 sign-ins from IP addresses of Mamba 2FA relay servers:
* ip-dst: 23.26.35.67 — Since October 2024, Entra/M365 sign-ins from IP addresses of IPRoyal proxies used by Mamba 2FA (non-exhaustive list):
* ip-dst: 23.26.206.99 — Since October 2024, Entra/M365 sign-ins from IP addresses of IPRoyal proxies used by Mamba 2FA (non-exhaustive list):
* ip-dst: 45.86.54.206 — Since October 2024, Entra/M365 sign-ins from IP addresses of IPRoyal proxies used by Mamba 2FA (non-exhaustive list):
* ip-dst: 45.9.153.102 — Since October 2024, Entra/M365 sign-ins from IP addresses of IPRoyal proxies used by Mamba 2FA (non-exhaustive list):

## Objects
### report — Report object to describe a report along with its metadata.
* [External analysis] link: https://blog.sekoia.io/mamba-2fa-a-new-contender-in-the-aitm-phishing-ecosystem/
* [Other] text: In late May 2024, Sekoia’s Threat Detection & Research (TDR) team received an insight from a partner about an ongoing phishing campaign leveraging HTML attachments that mimicked Microsoft 365 login pages. The phishing pages were able to relay some methods of multi-factor authentication (MFA), and made use of the Socket.IO JavaScript library to communicate via websockets with a backend server. At first, these characteristics look like the Tycoon 2FA phishing-as-a-service platform, but further inspection found that the campaign leveraged a previously unknown adversary-in-the-middle (AiTM) phishing kit, that Sekoia track as Mamba 2FA.

TDR illuminated the infrastructure hosting the phishing pages and developed detection rules to identify Entra ID accounts compromised via this kit. Retro-hunting uncovered that several Sekoia XDR customers have been targeted by campaigns leveraging Mamba 2FA in the previous months, suggesting a widespread threat. Finally, during this investigation we identified that the kit was sold as phishing-as-a-service (PhaaS).

On 26 June 2024, ANY.RUN published an analysis of a phishing campaign that matched the characteristics and infrastructure of Mamba 2FA. Since then, and likely in reaction to this publication, the phishing kit and associated infrastructure have undergone several significant changes.
* [Other] text: Blog
