# Threat Report: 2018-03-16: OSINT - Sofacy Uses DealersChoice to Target European Government Agency


## Key Intelligence
* Date: 2018-03-16
* Threat Level: 3 (Low)
* Tags: misp-galaxy:threat-actor="Sofacy", misp-galaxy:mitre-mobile-attack-intrusion-set="APT28", misp-galaxy:microsoft-activity-group="STRONTIUM", tlp:white, osint:source-type="blog-post", admiralty-scale:source-reliability="b"

---

## Indicators of Compromise (IOCs)
### External analysis
* link: https://researchcenter.paloaltonetworks.com/2018/03/unit42-sofacy-uses-dealerschoice-target-european-government-agency/
* text: Back in October 2016, Unit 42 published an initial analysis on a Flash exploitation framework used by the Sofacy threat group called DealersChoice. The attack consisted of Microsoft Word delivery documents that contained Adobe Flash objects capable of loading additional malicious Flash objects embedded in the file or directly provided by a command and control server. Sofacy continued to use DealersChoice throughout the fall of 2016, which we also documented in our December 2016 publication discussing Sofacyâ€™s larger campaign.

On March 12 and March 14, we observed the Sofacy group carrying out an attack on a European government agency involving an updated variant of DealersChoice. The updated DealersChoice documents used a similar process to obtain a malicious Flash object from a C2 server, but the inner mechanics of the Flash object contained significant differences in comparison to the original samples we analyzed.

One of the differences was a particularly clever evasion technique: to our knowledge this has never been observed in use. With the previous iterations of DealersChoice samples, the Flash object would immediately load and begin malicious tasks. In the March attacks, the Flash object is only loaded if the user scrolls through the entire content of the delivery document and views the specific page the Flash object is embedded on. Also, DealersChoice requires multiple interactions with an active C2 server to successfully exploit an end system.

The overall process to result in a successful exploitation is:

    User must open the Microsoft Word email attachment
    User must scroll to page three of the document, which will run the DealersChoice Flash object
    The Flash object must contact an active C2 server to download an additional Flash object containing exploit code
    The initial Flash object must contact the same C2 server to download a secondary payload
    Victim host must have a vulnerable version of Flash installed

### Network activity
* domain: ndpmedia24.com

### Payload delivery
* sha256: <sha256> — Macro-ladened documents
* sha256: <sha256> — Macro-ladened documents
* sha256: <sha256> — Macro-ladened documents

## Objects
### file — File object describing a file with meta-information
* [Other] text: DealersChoice
* [Payload delivery] filename: Defence & Security 2018 Conference Agenda.docx
* [Payload delivery] sha256: <sha256>
* [Other] text: Malicious

### file — File object describing a file with meta-information
* [Payload delivery] sha1: <sha1>
* [Payload delivery] sha256: <sha256>
* [Payload delivery] md5: <md5>

### virustotal-report — VirusTotal report
* [External analysis] link: https://www.virustotal.com/file/0cd9ac328d858d8d83c9eb73bfdc59a958873b3d71b24c888d7408d9512a41d7/analysis/1521229058/
* [Other] text: 7/60
* [Other] datetime: 2018-03-16T19:37:38

### file — File object describing a file with meta-information
* [Payload delivery] sha1: <sha1> — Macro-ladened documents
* [Payload delivery] sha256: <sha256> — Macro-ladened documents
* [Payload delivery] md5: <md5> — Macro-ladened documents

### virustotal-report — VirusTotal report
* [External analysis] link: https://www.virustotal.com/file/efb235776851502672dba5ef45d96cc65cb9ebba1b49949393a6a85b9c822f52/analysis/1521222896/ — Macro-ladened documents
* [Other] text: 37/59 — Macro-ladened documents
* [Other] datetime: 2018-03-16T17:54:56 — Macro-ladened documents

### file — File object describing a file with meta-information
* [Payload delivery] sha1: <sha1> — Macro-ladened documents
* [Payload delivery] sha256: <sha256> — Macro-ladened documents
* [Payload delivery] md5: <md5> — Macro-ladened documents

### virustotal-report — VirusTotal report
* [External analysis] link: https://www.virustotal.com/file/e5511b22245e26a003923ba476d7c36029939b2d1936e17a9b35b396467179ae/analysis/1521222684/ — Macro-ladened documents
* [Other] text: 37/57 — Macro-ladened documents
* [Other] datetime: 2018-03-16T17:51:24 — Macro-ladened documents

### file — File object describing a file with meta-information
* [Payload delivery] sha1: <sha1> — Macro-ladened documents
* [Payload delivery] sha256: <sha256> — Macro-ladened documents
* [Payload delivery] md5: <md5> — Macro-ladened documents

### virustotal-report — VirusTotal report
* [External analysis] link: https://www.virustotal.com/file/c4be15f9ccfecf7a463f3b1d4a17e7b4f95de939e057662c3f97b52f7fa3c52f/analysis/1521222974/ — Macro-ladened documents
* [Other] text: 17/39 — Macro-ladened documents
* [Other] datetime: 2018-03-16T17:56:14 — Macro-ladened documents
