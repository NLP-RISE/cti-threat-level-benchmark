# Threat Report: 2019-10-03: COMpfun successor Reductor: compromise TLS traffic


## Key Intelligence
* Date: 2019-10-03
* Threat Level: 3 (Low)
* Tags: misp-galaxy:threat-actor="Turla Group", type:OSINT, osint:lifetime="perpetual", tlp:white, osint:source-type="blog-post", estimative-language:likelihood-probability="very-likely", misp-galaxy:tool="COMpfun", misp-galaxy:tool="Reductor"

---

## Indicators of Compromise (IOCs)
### External analysis
* link: https://securelist.com/compfun-successor-reductor/93633/
* text: In April 2019, we discovered new malware that compromises encrypted web communications in an impressive way. Analysis of the malware allowed us to confirm that the operators have some control over the target’s network channel and could replace legitimate installers with infected ones on the fly. That places the actor in a very exclusive club, with capabilities that few other actors in the world have.

We called these new modules ‘Reductor’ after a .pdb path left in some samples. Besides typical RAT functions such as uploading, downloading and executing files, Reductor’s authors put a lot of effort into manipulating digital certificates and marking outbound TLS traffic with unique host-related identifiers.

The Kaspersky Attribution Engine shows strong code similarities between this family and the COMPfun Trojan. Moreover, further research showed that the original COMpfun Trojan most probably is used as a downloader in one of the distribution schemes. Based on these similarities, we’re quite sure the new malware was developed by the COMPfun authors.

The COMpfun malware was initially documented by G-DATA in 2014. Although G-DATA didn’t identify which actor was using this malware, Kaspersky tentatively linked it to the Turla APT, based on the victimology. Our telemetry indicates that the current campaign using Reductor started at the end of April 2019 and remained active at the time of writing (August 2019). We identified targets in Russia and Belarus.

We registered two initial infection schemes: Reductor spreads by either infecting popular software distributions (Internet Downloader Manager, WinRAR, etc. and, for at least one victim, through a popular warez website over HTTP); or its decryptor/dropper is spread using COMpfun’s ability to download files on already infected hosts.

### Network activity
* domain: adstat.pw
* domain: bill-tat.pw
* ip-src: 200.63.45.192 — Attribute #7635901 enriched by dns.

### Payload delivery
* md5: <md5>
* md5: <md5>
* md5: <md5>
* md5: <md5>
* md5: <md5>
* md5: <md5>
* md5: <md5>
* md5: <md5>
* md5: <md5>

## Objects
### file — File object describing a file with meta-information
* [Payload delivery] md5: <md5>
* [Payload delivery] sha1: <sha1>
* [Payload delivery] sha256: <sha256>

### virustotal-report — VirusTotal report
* [Other] datetime: 2019-05-19 16:41:15
* [Payload delivery] link: https://www.virustotal.com/file/4e2d038e9d72ee4d660755ba973a31471dda167d1a51bfdfe60abb2b3de78ba1/analysis/1558284075/
* [Payload delivery] text: 26/68

### x509 — x509 object describing a X.509 certificate
* [Network activity] x509-fingerprint-sha1: 119b2be9c17d8c7c5ab0fa1a17aaf69082bab21d
* [Other] text: ie-paypal
* [Other] datetime: 20311117T000000-0800

### x509 — x509 object describing a X.509 certificate
* [Network activity] x509-fingerprint-sha1: 546f7a565920aeb0021a1d05525ff0b3df51d020
* [Other] text: GeoTrust Rsa CA
* [Other] datetime: 20311117T000000-0800

### x509 — x509 object describing a X.509 certificate
* [Network activity] x509-fingerprint-sha1: 959eb6c7f45b7c5c761d5b758e65d9ef7ea20cf3
* [Other] text: GeoTrust Rsa CA
* [Other] datetime: 20311117T000000-0800

### x509 — x509 object describing a X.509 certificate
* [Network activity] x509-fingerprint-sha1: 992bace0bc815e43626d59d790cef50907c6ea9b
* [Other] text: VeriSign, Inc.
* [Other] datetime: 20311117T000000-0800

### command — Command functionalities related to a software malicious or not to execute specific commands. Command-line are attached to this object for the related commands.
* [Other] text: All C2 communications are handled in a standalone malware thread. Reductor sends HTTP POST queries to the /query.php scripts on the C2s listed in its configuration. The POST query contains the target’s unique hardware ID encrypted with AES 128. The C2 returns one of the following encrypted commands.
* [Other] text: Network
* [Other] text: Bundled

### command-line — Command line and option related to a software malicious or not to execute specific commands.
* [Other] text: Get the host name
* [Other] text: hostinfo

### command-line — Command line and option related to a software malicious or not to execute specific commands.
* [Other] text: Get the timeout value from the corresponding registry value
* [Other] text: gettimeout

### command-line — Command line and option related to a software malicious or not to execute specific commands.
* [Other] text: Parse strings and set corresponding values in the system registries. So far only one option is supported – timeout
* [Other] text: options

### command-line — Command line and option related to a software malicious or not to execute specific commands.
* [Other] text: Transmit the current C2 domains used by target
* [Other] text: domainlist

### command-line — Command line and option related to a software malicious or not to execute specific commands.
* [Other] text: Download the file of interest
* [Other] text: downfile

### command-line — Command line and option related to a software malicious or not to execute specific commands.
* [Other] text: Upload the file of interest
* [Other] text: upfile

### command-line — Command line and option related to a software malicious or not to execute specific commands.
* [Other] text: Create the process that executes mentioned file
* [Other] text: execfile

### command-line — Command line and option related to a software malicious or not to execute specific commands.
* [Other] text: Do nothing. Possibly used to check the connection with the host
* [Other] text: nop

### command-line — Command line and option related to a software malicious or not to execute specific commands.
* [Other] text: Delete installed digital certificates, files, cookies and system registry values including those related to COM CLSID or LSA notification package persistence
* [Other] text: kill

### command-line — Command line and option related to a software malicious or not to execute specific commands.
* [Other] text: Delete file at a specified path
* [Other] text: deletefile

### command-line — Command line and option related to a software malicious or not to execute specific commands.
* [Other] text: Renew the digital certificates installed on target
* [Other] text: certlist
