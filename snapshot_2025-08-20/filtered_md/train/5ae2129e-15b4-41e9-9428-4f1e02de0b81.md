# Threat Report: 2018-04-26: OSINT - Analyzing Operation GhostSecret: Attack Seeks to Steal Data Worldwide


## Key Intelligence
* Date: 2018-04-26
* Threat Level: 2 (Medium)
* Tags: tlp:white, misp-galaxy:mitre-enterprise-attack-attack-pattern="Exfiltration Over Command and Control Channel - T1041", misp-galaxy:mitre-enterprise-attack-attack-pattern="Commonly Used Port - T1043", misp-galaxy:mitre-enterprise-attack-attack-pattern="Service Execution - T1035", misp-galaxy:mitre-enterprise-attack-attack-pattern="Automated Collection - T1119", misp-galaxy:mitre-enterprise-attack-attack-pattern="Data from Local System - T1005", misp-galaxy:mitre-enterprise-attack-attack-pattern="Process Discovery - T1057", misp-galaxy:mitre-enterprise-attack-attack-pattern="System Time Discovery - T1124", misp-galaxy:mitre-enterprise-attack-attack-pattern="File Deletion - T1107", workflow:todo="create-missing-misp-galaxy-cluster-values"

---

## Indicators of Compromise (IOCs)
### Antivirus detection
* text: Trojan-Bankshot2

### External analysis
* link: https://securingtomorrow.mcafee.com/mcafee-labs/analyzing-operation-ghostsecret-attack-seeks-to-steal-data-worldwide/
* text: McAfee Advanced Threat Research analysts have uncovered a global data reconnaissance campaign assaulting a wide number of industries including critical infrastructure, entertainment, finance, health care, and telecommunications. This campaign, dubbed Operation GhostSecret, leverages multiple implants, tools, and malware variants associated with the state-sponsored cyber group Hidden Cobra. The infrastructure currently remains active. In this post, we dive deeply into this campaign. For a brief overview of this threat, see â€œGlobal Malware Campaign Pilfers Data from Critical Infrastructure, Entertainment, Finance, Health Care, and Other Industries.â€

Our investigation into this campaign reveals that the actor used multiple malware implants, including an unknown implant with capabilities similar to Bankshot. From March 18 to 26 we observed the malware operating in multiple areas of the world. This new variant resembles parts of the Destover malware, which was used in the 2014 Sony Pictures attack.

Furthermore, the Advanced Threat Research team has discovered Proxysvc, which appears to be an undocumented implant. We have also uncovered additional control servers that are still active and associated with these new implants. Based on our analysis of public and private information from submissions, along with product telemetry, it appears Proxysvc was used alongside the 2017 Destover variant and has operated undetected since mid-2017.

The attackers behind Operation GhostSecret used a similar infrastructure to earlier threats, including SSL certificates used by FakeTLS in implants found in the Destover backdoor variant known as Escad, which was used in the Sony Pictures attack. Based on our technical analysis, telemetry, and data from submissions, we can assert with high confidence that this is the work of the Hidden Cobra group. The Advanced Threat Research team uncovered activity related to this campaign in March 2018, when the actors targeted Turkish banks. These initial findings appear to be the first stage of Operation GhostSecret. For more on the global aspect of this threat, see â€œGlobal Malware Campaign Pilfers Data from Critical Infrastructure of Entertainment, Finance, Health Care, and Other Industries.â€

### Network activity
* ip-dst: 203.131.222.83
* ip-dst: 14.140.116.172
* ip-dst: 203.131.222.109
* ip-src: 121.240.155.74 — Proxysvc makes an interesting check while accepting connections from a potential control server. It checks against a list of IP addresses to make sure the incoming connection is not from any of the following addresses. If the incoming request does come from one of these, the implant offers a zero response (ASCII â€œ0â€) and shuts down the connection.
* ip-src: 121.240.155.76 — Proxysvc makes an interesting check while accepting connections from a potential control server. It checks against a list of IP addresses to make sure the incoming connection is not from any of the following addresses. If the incoming request does come from one of these, the implant offers a zero response (ASCII â€œ0â€) and shuts down the connection.
* ip-src: 121.240.155.77 — Proxysvc makes an interesting check while accepting connections from a potential control server. It checks against a list of IP addresses to make sure the incoming connection is not from any of the following addresses. If the incoming request does come from one of these, the implant offers a zero response (ASCII â€œ0â€) and shuts down the connection.
* ip-src: 121.240.155.78 — Proxysvc makes an interesting check while accepting connections from a potential control server. It checks against a list of IP addresses to make sure the incoming connection is not from any of the following addresses. If the incoming request does come from one of these, the implant offers a zero response (ASCII â€œ0â€) and shuts down the connection.
* ip-src: 223.30.98.169 — Proxysvc makes an interesting check while accepting connections from a potential control server. It checks against a list of IP addresses to make sure the incoming connection is not from any of the following addresses. If the incoming request does come from one of these, the implant offers a zero response (ASCII â€œ0â€) and shuts down the connection.
* ip-src: 223.30.98.170 — Proxysvc makes an interesting check while accepting connections from a potential control server. It checks against a list of IP addresses to make sure the incoming connection is not from any of the following addresses. If the incoming request does come from one of these, the implant offers a zero response (ASCII â€œ0â€) and shuts down the connection.
* ip-src: 14.140.116.172 — Proxysvc makes an interesting check while accepting connections from a potential control server. It checks against a list of IP addresses to make sure the incoming connection is not from any of the following addresses. If the incoming request does come from one of these, the implant offers a zero response (ASCII â€œ0â€) and shuts down the connection.
* ip-dst: 193.248.247.59 — The 2015 implant does not contain a hardcoded value of the IP address it must connect to. Instead it contains a hardcoded sockaddr_in data structure (positioned at 0x270 bytes before the end of the binary) used by the connect() API to specify port 443 and control server IP addresses:
* ip-dst: 196.4.67.45 — The 2015 implant does not contain a hardcoded value of the IP address it must connect to. Instead it contains a hardcoded sockaddr_in data structure (positioned at 0x270 bytes before the end of the binary) used by the connect() API to specify port 443 and control server IP addresses:
* ip-dst: 203.131.222.95 — Further investigation into the control server infrastructure reveals the SSL certificate d0cb9b2d4809575e1bc1f4657e0eb56f307c7a76, which is tied to the control server 203.131.222.83, used by the February 2018 implant. This server resides at Thammasat University in Bangkok, Thailand. The same entity hosted the control server for the Sony Pictures implants. This SSL certificate has been used in Hidden Cobra operations since the Sony Pictures attack. Analyzing this certificate reveals additional control servers using the same PolarSSL certificate. Further analysis of McAfee telemetry data reveals several IP addresses that are active, two within the same network block as the 2018 Destover-like implant.

### Payload delivery
* sha1: <sha1>
* sha1: <sha1>
* sha1: <sha1>
* x509-fingerprint-sha1: d0cb9b2d4809575e1bc1f4657e0eb56f307c7a76 — Both of these control servers used the PolarSSL certificate

## Objects
### file — File object describing a file with meta-information
* [Payload delivery] md5: <md5>
* [Payload delivery] sha1: <sha1>
* [Payload delivery] sha256: <sha256>

### virustotal-report — VirusTotal report
* [Other] datetime: 2018-04-26T00:30:02
* [External analysis] link: https://www.virustotal.com/file/ae65288f5c96b4656402853b14acd1d060b2a6303d833df5b1f10cc7a34b0025/analysis/1524702602/
* [Other] text: 48/67

### file — File object describing a file with meta-information
* [Payload delivery] md5: <md5>
* [Payload delivery] sha1: <sha1>
* [Payload delivery] sha256: <sha256>

### virustotal-report — VirusTotal report
* [Other] datetime: 2018-04-26T00:30:05
* [External analysis] link: https://www.virustotal.com/file/45e68dce0f75353c448865b9abafbef5d4ed6492cd7058f65bf6aac182a9176a/analysis/1524702605/
* [Other] text: 44/66

### file — File object describing a file with meta-information
* [Payload delivery] md5: <md5>
* [Payload delivery] sha1: <sha1>
* [Payload delivery] sha256: <sha256>

### virustotal-report — VirusTotal report
* [Other] datetime: 2018-04-26T00:29:58
* [External analysis] link: https://www.virustotal.com/file/05a567fe3f7c22a0ef78cc39dcf2d9ff283580c82bdbe880af9549e7014becfc/analysis/1524702598/
* [Other] text: 49/67
