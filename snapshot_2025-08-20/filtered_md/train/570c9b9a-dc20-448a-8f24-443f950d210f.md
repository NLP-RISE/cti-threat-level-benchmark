# Threat Report: 2016-04-12: Rokku Ransomware shows possible link with Chimera


## Key Intelligence
* Date: 2016-04-12
* Threat Level: 3 (Low)
* Tags: tlp:white, type:OSINT

---

## Indicators of Compromise (IOCs)
### Artifacts dropped
* comment: wmic shadowcopy delete /nointeractive
vssadmin delete shadows /all /quiet
reg add "HKLM\SYSTEM\CurrentControlSet\services\VSS" /v Start /t REG_DWORD /d 4 /f
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\SystemRestore" /v DisableSR /t REG_DWORD /d 1 /f
net stop vss
net stop swprv
net stop srservice — Finally, removing backups and stopping backup services is performed â€“ by execution of the following commands:

### External analysis
* comment: Rokku is yet another ransomware, discovered in recent weeks. Currently, itâ€™s most common distribution method is spam where a malicious executable is dropped by a VB script belonging to the e-mailâ€™s attachment.

The building blocks of Rokku reminded us of the Chimera ransomware. Thatâ€™s why we decided to take a closer look, not only at the internal structure of this malware but also at the similarities and differences between these two products.
* link: https://blog.malwarebytes.org/threat-analysis/2016/04/rokku-ransomware/
* link: https://www.virustotal.com/file/09eecd70914e38a1ee83295db5834cfdf848bab987a51afa6ed1c3b2dff027fc/analysis/1459878434/
* link: https://www.virustotal.com/file/e477e3337636b44477bb2feaf4016a0d2ad9eca273b0c2ef9b55ccb2c9902d87/analysis/1459878217/
* link: https://www.virustotal.com/file/186073cd4539725cbc26f8dac867c97e21d4c88836305a16acf50a70d6121f51/analysis/1459758054/
* link: https://www.virustotal.com/file/1c40b5c96d13580f1dfa38f59f177502349aa1c962ff95559e0ec805155eb983/analysis/1459828258/
* link: https://www.virustotal.com/file/438888ef36bad1079af79daf152db443b4472c5715a7b3da0ba24cc757c53499/analysis/1459900992/

### Payload delivery
* md5: <md5> — original executable  (malware)
* md5: <md5> — UPX layer removed (malware)
* md5: <md5> — payload: encryptor.dll (malware) - the analysis
* md5: <md5> — original executable: decryptor.exe (decryptor)
* md5: <md5> — UPX layer removed  (decryptor)
* sha256: <sha256> — UPX layer removed  (decryptor) - Xchecked via VT: 1be4a0932a66ebdb9ede56214d8ccdf9
* sha1: <sha1> — UPX layer removed  (decryptor) - Xchecked via VT: 1be4a0932a66ebdb9ede56214d8ccdf9
* sha256: <sha256> — original executable: decryptor.exe (decryptor) - Xchecked via VT: 82fea20bb4c96050b4cf55f83de0f3e6
* sha1: <sha1> — original executable: decryptor.exe (decryptor) - Xchecked via VT: 82fea20bb4c96050b4cf55f83de0f3e6
* sha256: <sha256> — payload: encryptor.dll (malware) - the analysis - Xchecked via VT: be6552aed5e7509b3b539cef8a965131
* sha1: <sha1> — payload: encryptor.dll (malware) - the analysis - Xchecked via VT: be6552aed5e7509b3b539cef8a965131
* sha256: <sha256> — UPX layer removed (malware) - Xchecked via VT: 5a0e3a6e3106e754381bd1cc3295c97f
* sha1: <sha1> — UPX layer removed (malware) - Xchecked via VT: 5a0e3a6e3106e754381bd1cc3295c97f
* sha256: <sha256> — original executable  (malware) - Xchecked via VT: 97512f4617019c907cd0f88193039e7c
* sha1: <sha1> — original executable  (malware) - Xchecked via VT: 97512f4617019c907cd0f88193039e7c
