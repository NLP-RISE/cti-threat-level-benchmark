# Threat Report: 2019-03-07: OSINT -  New SLUB Backdoor Uses GitHub, Communicates via Slack


## Key Intelligence
* Date: 2019-03-07
* Threat Level: 3 (Low)
* Tags: type:OSINT, osint:lifetime="perpetual", osint:certainty="50", tlp:white, misp-galaxy:mitre-attack-pattern="Exfiltration Over Alternative Protocol - T1048", misp-galaxy:mitre-attack-pattern="Scripting - T1064"

---

## Indicators of Compromise (IOCs)
### External analysis
* link: https://blog.trendmicro.com/trendlabs-security-intelligence/new-slub-backdoor-uses-github-communicates-via-slack/
* text: We recently came across a previously unknown malware that piqued our interest in multiple ways. For starters, we discovered it being spread via watering hole attacks, a technique that involves an attacker compromising a website before adding code to it so visitors are redirected to the infecting code. In this case, each visitor is redirected only once. The infection was done by exploiting CVE-2018-8174, a VBScript engine vulnerability that was patched by Microsoft back in May 2018.

Second, it uses a multi-stage infection scheme. After it exploits the vulnerability, it downloads a DLL and runs it in PowerShell (PS). This file, which is a downloader, then downloads and runs the second executable file containing a backdoor. The first stage downloader also checks for the existence of different kinds of antivirus software processes, and then proceeds to exit if any is found. At the time of discovery, the backdoor was seemingly unknown to AV products.

In addition to the previously mentioned facts, we quickly noticed that the malware was connecting to the Slack platform, a collaborative messaging system that lets users create and use their own workspaces through the use of channels, similar to the IRC chatting system. We found this quite interesting, since we havenâ€™t observed any malware to date that communicates using Slack.

Our technical investigation and analysis of the attackerâ€™s tools, techniques, and procedures (TTP) lead us to think that this threat is actually a stealthy targeted attack run by capable actors, and not a typical cybercriminal scheme.

Note that as soon as this malware was discovered, we informed the Canadian Centre for Cyber Security, which acts as Canadaâ€™s National Computer Security Incident Response Team (CSIRT). The Cyber Centre alerted the site operator, helped them understand the malware that was found, and offered mitigation advice.
* attachment: SLUB-Figure-5-1.jpg
* attachment: SLUB-Figure-9.jpg — Timeline

### Network activity
* url: https://gist.github.com/kancc14522/626a3a68a2cc2a91c1ece1eed7610c8a

### Payload delivery
* vulnerability: CVE-2018-8174
* sha256: <sha256> — Trojan.Win32.CVE20151701.E
* sha256: <sha256> — Backdoor.Win32.SLUB.A

## Objects
### file — File object describing a file with meta-information
* [Payload delivery] md5: <md5> — Trojan.Win32.CVE20151701.E
* [Payload delivery] sha1: <sha1> — Trojan.Win32.CVE20151701.E
* [Payload delivery] sha256: <sha256> — Trojan.Win32.CVE20151701.E

### virustotal-report — VirusTotal report
* [Other] datetime: 2019-03-01T01:49:19 — Trojan.Win32.CVE20151701.E
* [Payload delivery] link: https://www.virustotal.com/file/3ba00114d0ae766cf77edcdcc953ec6ee7527181968c02d4ffc36b9f89c4ebc7/analysis/1551404959/ — Trojan.Win32.CVE20151701.E
* [Payload delivery] text: 32/63 — Trojan.Win32.CVE20151701.E

### file — File object describing a file with meta-information
* [Payload delivery] md5: <md5> — Backdoor.Win32.SLUB.A
* [Payload delivery] sha1: <sha1> — Backdoor.Win32.SLUB.A
* [Payload delivery] sha256: <sha256> — Backdoor.Win32.SLUB.A

### virustotal-report — VirusTotal report
* [Other] datetime: 2019-03-06T16:37:38 — Backdoor.Win32.SLUB.A
* [Payload delivery] link: https://www.virustotal.com/file/43221eb160733ea694b4fdda70e7eab4a86d59c5f9749fd2f9b71783e5da6dd7/analysis/1551890258/ — Backdoor.Win32.SLUB.A
* [Payload delivery] text: 7/69 — Backdoor.Win32.SLUB.A
