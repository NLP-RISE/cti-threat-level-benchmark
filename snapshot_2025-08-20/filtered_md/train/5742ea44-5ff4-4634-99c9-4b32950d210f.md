# Threat Report: 2016-05-23: OSINT - Operation Ke3chang Resurfaces With New TidePool Malware


## Key Intelligence
* Date: 2016-05-23
* Threat Level: 2 (Medium)
* Tags: tlp:white, type:OSINT

---

## Indicators of Compromise (IOCs)
### Artifacts dropped
* filename: %USERPROFILE%\IEHelper\mshtml.dll

### External analysis
* link: http://researchcenter.paloaltonetworks.com/2016/05/operation-ke3chang-resurfaces-with-new-tidepool-malware/
* comment: Little has been published on the threat actors responsible for Operation Ke3chang since the report was released more than two years ago. However, Unit 42 has recently discovered the actors have continued to evolve their custom malware arsenal. Weâ€™ve discovered a new malware family weâ€™ve named TidePool. It has strong behavioral ties to Ke3chang and is being used in an ongoing attack campaign against Indian embassy personnel worldwide. This targeting is also consistent with previous attacker TTPs; Ke3chang historically targeted the Ministry of Affairs, and also conducted several prior campaigns against India.
Though we donâ€™t have comprehensive targeting information, the spear phishing emails we found targeted several Indian embassies in different countries. One decoy references an annual report filed by over 30 Indian embassies across the globe. The sender addresses of the phishing emails spoof real people with ties to Indian embassies, adding legitimacy to the emails to prompt the recipients to open the attached file. Also noteworthy, the actors are exploiting a relatively new vulnerability in their attacks with TidePool, which is detailed below.
In this report we will highlight the reuse of the code responsible for a variety of registry changes and command and control traffic over time as the Ke3chang actor has evolved their codebase to TidePool since the 2013 report.

### Network activity
* hostname: goback.strangled.net — TidePool

### Payload delivery
* vulnerability: CVE-2015-2545
* sha256: <sha256> — TidePool DLL
* sha256: <sha256> — TidePool DLL
* sha256: <sha256> — TidePool DLL
* sha256: <sha256> — TidePool Dropper
* sha256: <sha256> — Weaponized document attachment
* sha256: <sha256> — Weaponized document attachment
* sha256: <sha256> — Phishing email
* sha256: <sha256> — Phishing email
* sha256: <sha256> — Phishing email
* sha256: <sha256> — Group 1: 3/1/2012 â€“ 3/22/2012 (BS2005)
* sha256: <sha256> — Group 1: 3/1/2012 â€“ 3/22/2012
* sha256: <sha256> — Group 2: 6/1/2012 â€“ 7/10/2012 - BS2005
* sha256: <sha256> — Group 2: 6/1/2012 â€“ 7/10/2012 - BS2005
* sha256: <sha256> — Group 2: 6/1/2012 â€“ 7/10/2012

### Payload installation
* sha256: <sha256> — Group 1: 3/1/2012 â€“ 3/22/2012 (BS2005)

## Objects
### file — File object describing a file with meta-information
* [Payload delivery] sha1: <sha1> — Group 1: 3/1/2012 â€“ 3/22/2012 (BS2005)
* [Payload delivery] md5: <md5> — Group 1: 3/1/2012 â€“ 3/22/2012 (BS2005)
* [Payload delivery] sha256: <sha256> — Group 1: 3/1/2012 â€“ 3/22/2012 (BS2005)

### virustotal-report — VirusTotal report
* [External analysis] link: https://www.virustotal.com/file/71b548e09fd51250356111f394e5fc64ac54d5a07d9bc57852315484c2046093/analysis/1464602237/ — Group 1: 3/1/2012 â€“ 3/22/2012 (BS2005)
* [Other] text: 42/57 — Group 1: 3/1/2012 â€“ 3/22/2012 (BS2005)
* [Other] datetime: 2016-05-30T09:57:17 — Group 1: 3/1/2012 â€“ 3/22/2012 (BS2005)

### file — File object describing a file with meta-information
* [Payload delivery] sha1: <sha1> — Weaponized document attachment
* [Payload delivery] md5: <md5> — Weaponized document attachment
* [Payload delivery] sha256: <sha256> — Weaponized document attachment

### virustotal-report — VirusTotal report
* [External analysis] link: https://www.virustotal.com/file/785e8a39eb66e872ff5abee48b7226e99bed2e12bc0f68fc430145a00fe523db/analysis/1505182043/ — Weaponized document attachment
* [Other] text: 26/58 — Weaponized document attachment
* [Other] datetime: 2017-09-12T02:07:23 — Weaponized document attachment

### file — File object describing a file with meta-information
* [Payload delivery] sha1: <sha1> — Group 1: 3/1/2012 â€“ 3/22/2012 (BS2005)
* [Payload delivery] md5: <md5> — Group 1: 3/1/2012 â€“ 3/22/2012 (BS2005)
* [Payload delivery] sha256: <sha256> — Group 1: 3/1/2012 â€“ 3/22/2012 (BS2005)

### virustotal-report — VirusTotal report
* [External analysis] link: https://www.virustotal.com/file/39fdcdf019c0fca350ec5bd3de31b6649456993b3f9642f966d610e0190f9297/analysis/1501706637/ — Group 1: 3/1/2012 â€“ 3/22/2012 (BS2005)
* [Other] text: 49/65 — Group 1: 3/1/2012 â€“ 3/22/2012 (BS2005)
* [Other] datetime: 2017-08-02T20:43:57 — Group 1: 3/1/2012 â€“ 3/22/2012 (BS2005)

### file — File object describing a file with meta-information
* [Payload delivery] sha1: <sha1> — Weaponized document attachment
* [Payload delivery] md5: <md5> — Weaponized document attachment
* [Payload delivery] sha256: <sha256> — Weaponized document attachment

### virustotal-report — VirusTotal report
* [External analysis] link: https://www.virustotal.com/file/eea3f90db41f872da8ed542b37948656b1fb93b12a266e8de82c6c668e60e9fc/analysis/1464690554/ — Weaponized document attachment
* [Other] text: 21/56 — Weaponized document attachment
* [Other] datetime: 2016-05-31T10:29:14 — Weaponized document attachment

### file — File object describing a file with meta-information
* [Payload delivery] sha1: <sha1> — Group 2: 6/1/2012 â€“ 7/10/2012 - BS2005
* [Payload delivery] md5: <md5> — Group 2: 6/1/2012 â€“ 7/10/2012 - BS2005
* [Payload delivery] sha256: <sha256> — Group 2: 6/1/2012 â€“ 7/10/2012 - BS2005

### virustotal-report — VirusTotal report
* [External analysis] link: https://www.virustotal.com/file/12cc0fdc4f80942f0ba9039a22e701838332435883fa62d0cefd3992867a9e88/analysis/1480255582/ — Group 2: 6/1/2012 â€“ 7/10/2012 - BS2005
* [Other] text: 41/56 — Group 2: 6/1/2012 â€“ 7/10/2012 - BS2005
* [Other] datetime: 2016-11-27T14:06:22 — Group 2: 6/1/2012 â€“ 7/10/2012 - BS2005

### file — File object describing a file with meta-information
* [Payload delivery] sha1: <sha1> — TidePool Dropper
* [Payload delivery] md5: <md5> — TidePool Dropper
* [Payload delivery] sha256: <sha256> — TidePool Dropper

### virustotal-report — VirusTotal report
* [External analysis] link: https://www.virustotal.com/file/38f2c86041e0446730479cdb9c530298c0c4936722975c4e7446544fd6dcac9f/analysis/1513864598/ — TidePool Dropper
* [Other] text: 41/68 — TidePool Dropper
* [Other] datetime: 2017-12-21T13:56:38 — TidePool Dropper

### file — File object describing a file with meta-information
* [Payload delivery] sha1: <sha1> — TidePool DLL
* [Payload delivery] md5: <md5> — TidePool DLL
* [Payload delivery] sha256: <sha256> — TidePool DLL

### virustotal-report — VirusTotal report
* [External analysis] link: https://www.virustotal.com/file/2252dcd1b6afacde3f94d9557811bb769c4f0af3cb7a48ffe068d31bb7c30e18/analysis/1512091554/ — TidePool DLL
* [Other] text: 49/67 — TidePool DLL
* [Other] datetime: 2017-12-01T01:25:54 — TidePool DLL

### file — File object describing a file with meta-information
* [Payload delivery] sha1: <sha1> — Phishing email
* [Payload delivery] md5: <md5> — Phishing email
* [Payload delivery] sha256: <sha256> — Phishing email

### virustotal-report — VirusTotal report
* [External analysis] link: https://www.virustotal.com/file/1896d190ed5c5d04d74f8c2bfe70434f472b43441be824e81a31b7257b717e51/analysis/1474270852/ — Phishing email
* [Other] text: 20/55 — Phishing email
* [Other] datetime: 2016-09-19T07:40:52 — Phishing email

### file — File object describing a file with meta-information
* [Payload delivery] sha1: <sha1> — Phishing email
* [Payload delivery] md5: <md5> — Phishing email
* [Payload delivery] sha256: <sha256> — Phishing email

### virustotal-report — VirusTotal report
* [External analysis] link: https://www.virustotal.com/file/de5060b7e9aaaeb8d24153fe35b77c27c95dadda5a5e727d99f407c8703db649/analysis/1464236275/ — Phishing email
* [Other] text: 20/56 — Phishing email
* [Other] datetime: 2016-05-26T04:17:55 — Phishing email

### file — File object describing a file with meta-information
* [Payload delivery] sha1: <sha1> — Group 2: 6/1/2012 â€“ 7/10/2012 - BS2005
* [Payload delivery] md5: <md5> — Group 2: 6/1/2012 â€“ 7/10/2012 - BS2005
* [Payload delivery] sha256: <sha256> — Group 2: 6/1/2012 â€“ 7/10/2012 - BS2005

### virustotal-report — VirusTotal report
* [External analysis] link: https://www.virustotal.com/file/a4fae981b687fe230364508a3324cf6e6daa45ecddd6b7c7b532cdc980679076/analysis/1502697388/ — Group 2: 6/1/2012 â€“ 7/10/2012 - BS2005
* [Other] text: 44/64 — Group 2: 6/1/2012 â€“ 7/10/2012 - BS2005
* [Other] datetime: 2017-08-14T07:56:28 — Group 2: 6/1/2012 â€“ 7/10/2012 - BS2005

### file — File object describing a file with meta-information
* [Payload delivery] sha1: <sha1> — Phishing email
* [Payload delivery] md5: <md5> — Phishing email
* [Payload delivery] sha256: <sha256> — Phishing email

### virustotal-report — VirusTotal report
* [External analysis] link: https://www.virustotal.com/file/4d5e0eddcd014c63123f6a46af7e53b5ac25a7ff7de86f56277fe39bff32c7b5/analysis/1474272871/ — Phishing email
* [Other] text: 18/55 — Phishing email
* [Other] datetime: 2016-09-19T08:14:31 — Phishing email

### file — File object describing a file with meta-information
* [Payload delivery] sha1: <sha1> — Group 2: 6/1/2012 â€“ 7/10/2012
* [Payload delivery] md5: <md5> — Group 2: 6/1/2012 â€“ 7/10/2012
* [Payload delivery] sha256: <sha256> — Group 2: 6/1/2012 â€“ 7/10/2012

### virustotal-report — VirusTotal report
* [External analysis] link: https://www.virustotal.com/file/c1a83a9600d69c91c19207a8ee16347202d50873b6dc4613ba4d6a6059610fa1/analysis/1477459761/ — Group 2: 6/1/2012 â€“ 7/10/2012
* [Other] text: 39/56 — Group 2: 6/1/2012 â€“ 7/10/2012
* [Other] datetime: 2016-10-26T05:29:21 — Group 2: 6/1/2012 â€“ 7/10/2012

### file — File object describing a file with meta-information
* [Payload delivery] sha1: <sha1> — TidePool DLL
* [Payload delivery] md5: <md5> — TidePool DLL
* [Payload delivery] sha256: <sha256> — TidePool DLL

### virustotal-report — VirusTotal report
* [External analysis] link: https://www.virustotal.com/file/9d0a47bdf00f7bd332ddd4cf8d95dd11ebbb945dda3d72aac512512b48ad93ba/analysis/1512091725/ — TidePool DLL
* [Other] text: 48/67 — TidePool DLL
* [Other] datetime: 2017-12-01T01:28:45 — TidePool DLL

### file — File object describing a file with meta-information
* [Payload delivery] sha1: <sha1> — TidePool DLL
* [Payload delivery] md5: <md5> — TidePool DLL
* [Payload delivery] sha256: <sha256> — TidePool DLL

### virustotal-report — VirusTotal report
* [External analysis] link: https://www.virustotal.com/file/67c4e8ab0f12fae7b4aeb66f7e59e286bd98d3a77e5a291e8d58b3cfbc1514ed/analysis/1512091712/ — TidePool DLL
* [Other] text: 49/66 — TidePool DLL
* [Other] datetime: 2017-12-01T01:28:32 — TidePool DLL

### file — File object describing a file with meta-information
* [Payload delivery] sha1: <sha1> — Group 1: 3/1/2012 â€“ 3/22/2012
* [Payload delivery] md5: <md5> — Group 1: 3/1/2012 â€“ 3/22/2012
* [Payload delivery] sha256: <sha256> — Group 1: 3/1/2012 â€“ 3/22/2012

### virustotal-report — VirusTotal report
* [External analysis] link: https://www.virustotal.com/file/25a3b374894cacd922e7ff870bb19c84a9abfd69405dded13c3a6ceb5abe4d27/analysis/1464323932/ — Group 1: 3/1/2012 â€“ 3/22/2012
* [Other] text: 43/57 — Group 1: 3/1/2012 â€“ 3/22/2012
* [Other] datetime: 2016-05-27T04:38:52 — Group 1: 3/1/2012 â€“ 3/22/2012
