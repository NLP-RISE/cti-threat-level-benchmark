# Threat Report: 2017-12-14: OSINT - Attackers Deploy New ICS Attack Framework â€œTRITONâ€ and Cause Operational Disruption to Critical Infrastructure


## Key Intelligence
* Date: 2017-12-14
* Threat Level: 3 (Low)
* Tags: tlp:white, circl:topic="industry", veris:asset:variety="S - SCADA"

---

## Indicators of Compromise (IOCs)
### Artifacts dropped
* yara: rule TRITON_ICS_FRAMEWORK
{
      meta:
          author = "nicholas.carr @itsreallynick"
          md5 = "0face841f7b2953e7c29c064d6886523"
          description = "TRITON framework recovered during Mandiant ICS incident response"
      strings:
          $python_compiled = ".pyc" nocase ascii wide
          $python_module_01 = "__module__" nocase ascii wide
          $python_module_02 = "<module>" nocase ascii wide
          $python_script_01 = "import Ts" nocase ascii wide
          $python_script_02 = "def ts_" nocase ascii wide  

          $py_cnames_01 = "TS_cnames.py" nocase ascii wide
          $py_cnames_02 = "TRICON" nocase ascii wide
          $py_cnames_03 = "TriStation " nocase ascii wide
          $py_cnames_04 = " chassis " nocase ascii wide  

          $py_tslibs_01 = "GetCpStatus" nocase ascii wide
          $py_tslibs_02 = "ts_" ascii wide
          $py_tslibs_03 = " sequence" nocase ascii wide
          $py_tslibs_04 = /import Ts(Hi|Low|Base)[^:alpha:]/ nocase ascii wide
          $py_tslibs_05 = /module\s?version/ nocase ascii wide
          $py_tslibs_06 = "bad " nocase ascii wide
          $py_tslibs_07 = "prog_cnt" nocase ascii wide  

          $py_tsbase_01 = "TsBase.py" nocase ascii wide
          $py_tsbase_02 = ".TsBase(" nocase ascii wide 
         
          $py_tshi_01 = "TsHi.py" nocase ascii wide
          $py_tshi_02 = "keystate" nocase ascii wide
          $py_tshi_03 = "GetProjectInfo" nocase ascii wide
          $py_tshi_04 = "GetProgramTable" nocase ascii wide
          $py_tshi_05 = "SafeAppendProgramMod" nocase ascii wide
          $py_tshi_06 = ".TsHi(" ascii nocase wide  

          $py_tslow_01 = "TsLow.py" nocase ascii wide
          $py_tslow_02 = "print_last_error" ascii nocase wide
          $py_tslow_03 = ".TsLow(" ascii nocase wide
          $py_tslow_04 = "tcm_" ascii wide
          $py_tslow_05 = " TCM found" nocase ascii wide  

          $py_crc_01 = "crc.pyc" nocase ascii wide
          $py_crc_02 = "CRC16_MODBUS" ascii wide
          $py_crc_03 = "Kotov Alaxander" nocase ascii wide
          $py_crc_04 = "CRC_CCITT_XMODEM" ascii wide
          $py_crc_05 = "crc16ret" ascii wide
          $py_crc_06 = "CRC16_CCITT_x1D0F" ascii wide
          $py_crc_07 = /CRC16_CCITT[^_]/ ascii wide  

          $py_sh_01 = "sh.pyc" nocase ascii wide  

          $py_keyword_01 = " FAILURE" ascii wide
          $py_keyword_02 = "symbol table" nocase ascii wide  

          $py_TRIDENT_01 = "inject.bin" ascii nocase wide
          $py_TRIDENT_02 = "imain.bin" ascii nocase wide  

      condition:
          2 of ($python_*) and 7 of ($py_*) and filesize < 3MB
}

### External analysis
* text: Mandiant recently responded to an incident at a critical infrastructure organization where an attacker deployed malware designed to manipulate industrial safety systems. The targeted systems provided emergency shutdown capability for industrial processes. We assess with moderate confidence that the attacker was developing the capability to cause physical damage and inadvertently shutdown operations. This malware, which we call TRITON, is an attack framework built to interact with Triconex Safety Instrumented System (SIS) controllers. We have not attributed the incident to a threat actor, though we believe the activity is consistent with a nation state preparing for an attack.

TRITON is one of a limited number of publicly identified malicious software families targeted at industrial control systems (ICS). It follows Stuxnet which was used against Iran in 2010 and Industroyer which we believe was deployed by Sandworm Team against Ukraine in 2016. TRITON is consistent with these attacks, in that it could prevent safety mechanisms from executing their intended function, resulting in a physical consequence.
* link: https://www.fireeye.com/blog/threat-research/2017/12/attackers-deploy-new-ics-attack-framework-triton.html
* attachment: Fig4.png — TRITON Architecture and Attack Scenario

## Objects
### file — File object describing a file with meta-information
* [Payload delivery] filename: trilog.exe
* [Payload delivery] md5: <md5>
* [Other] text: Malicious
* [Payload delivery] sha256: <sha256>

### file — File object describing a file with meta-information
* [Payload delivery] filename: imain.bin
* [Payload delivery] md5: <md5>
* [Other] text: Malicious
* [Payload delivery] sha256: <sha256>

### file — File object describing a file with meta-information
* [Payload delivery] filename: inject.bin
* [Payload delivery] md5: <md5>
* [Other] text: Malicious
* [Payload delivery] sha256: <sha256>

### file — File object describing a file with meta-information
* [Payload delivery] filename: library.zip
* [Payload delivery] md5: <md5>
* [Other] text: Malicious
* [Payload delivery] sha256: <sha256>

### file — File object describing a file with meta-information
* [Payload delivery] filename: TS_cnames.pyc
* [Payload delivery] md5: <md5>
* [Other] text: Malicious
* [Payload delivery] sha256: <sha256>

### file — File object describing a file with meta-information
* [Payload delivery] filename: TsBase.pyc
* [Payload delivery] md5: <md5>
* [Other] text: Malicious
* [Payload delivery] sha256: <sha256>

### file — File object describing a file with meta-information
* [Payload delivery] filename: TsHi.pyc
* [Payload delivery] md5: <md5>
* [Other] text: Malicious
* [Payload delivery] sha256: <sha256>

### file — File object describing a file with meta-information
* [Payload delivery] filename: TsLow.pyc
* [Payload delivery] md5: <md5>
* [Other] text: Malicious
* [Payload delivery] sha256: <sha256>

### file — File object describing a file with meta-information
* [Payload delivery] filename: sh.pyc
* [Payload delivery] md5: <md5>
* [Other] text: Malicious
* [Payload delivery] sha256: <sha256>

### file — File object describing a file with meta-information
* [Payload delivery] sha1: <sha1>
* [Payload delivery] md5: <md5>
* [Payload delivery] sha256: <sha256>

### virustotal-report — VirusTotal report
* [External analysis] link: https://www.virustotal.com/file/e8542c07b2af63ee7e72ce5d97d91036c5da56e2b091aa2afe737b224305d230/analysis/1513264635/
* [Other] text: 1/66
* [Other] datetime: 2017-12-14T15:17:15
