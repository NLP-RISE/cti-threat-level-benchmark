# Threat Report: 2016-06-01: A Universal Windows Bootkit An analysis of the MBR bootkit referred to as â€œHDRootâ€


## Key Intelligence
* Date: 2016-06-01
* Threat Level: 3 (Low)
* Tags: tlp:white, type:OSINT

---

## Indicators of Compromise (IOCs)
### External analysis
* link: http://williamshowalter.com/a-universal-windows-bootkit/
* link: https://github.com/williamshowalter/hdroot-bootkit-analysis
* comment: In October, 2015 Kaspersky released an analysis of a family of malware they dubbed â€œHDRootâ€ on their Securelist blog. It was an installment in their ongoing series on the WINNTI group, known for targeting gaming companies in their APT campaigns. The Securelist blog was dismissive of the HDRoot bootkit and called out a number of mistakes they claimed the authors made, which brought it to be the focus of their ridicule.

The bootkit in question uses two stolen signing certificates and is capable of running without problem on any Windows system that was released in the last 16 years, from Windows 2000 to Windows 10. The one limitation is that it will only run as an MBR bootkit and will not work on systems using UEFI. It contains the ability to install any backdoor payload to be launched in the context of a system service when Windows starts up on both 32 and 64-bit systems. It also does a fairly good job of concealing the actual bootkit code, only failing to remove the backdoor after running it at boot. This likely a conscious choice made by the authors to have the backdoor responsible for removing itself, and not an oversight.

HDRoot represents a serious commitment in time and effort to develop, and likely has been in use or development since at least 2006. The sample analyzed here dates to sometime in 2012 or 2013, and is the same sample Kasperky reports to have analyzed in their debut post on HDRoot. However, all evidence points to Kaspersky doing their analysis with a 2006 sample, criticizing problems in the malware that are not actually present. Additionally, they provide no hashes or other information on the actual sample they used.
* link: https://www.virustotal.com/file/a9a8dc4ae77b1282f0c8bdebd2643458fc1ceb3145db4e30120dd81676ff9b61/analysis/1461169271/ — dropper64.bin - Xchecked via VT: 4c3171b48d600e6337f1495142c43172d3b01770

### Payload delivery
* sha1: <sha1> — dropper64.bin
* sha1: <sha1> — driver32.sys.bin
* sha1: <sha1> — driver64.sys.bin
* sha1: <sha1> — pe1_decrypted.bin
* sha1: <sha1> — pe2_decrypted.bin
* sha1: <sha1> — rkimage_encrypted.bin
* sha1: <sha1> — rkimage_decrypted.bin
* sha1: <sha1> — C_932.NLS.bin
* md5: <md5> — dropper64.bin
* md5: <md5> — driver32.sys.bin
* md5: <md5> — driver64.sys.bin
* md5: <md5> — pe1_decrypted.bin
* md5: <md5> — pe2_decrypted.bin
* md5: <md5> — rkimage_encrypted.bin
* md5: <md5> — rkimage_decrypted.bin
* md5: <md5> — C_932.NLS.bin
* sha256: <sha256> — dropper64.bin - Xchecked via VT: 4c3171b48d600e6337f1495142c43172d3b01770

### Payload installation
* malware-sample: verifier_win7_encrypted.bin|15b243d2d0656caab06171d227555656
* filename|sha1: <sha1>
* filename|sha256: <sha256>
* malware-sample: verifier_win7_decrypted.bin|7cf9c43524c3864c9f74089cf08b8bd5
* filename|sha1: <sha1>
* filename|sha256: <sha256>
* malware-sample: verifier_win10_encrypted.bin|0d076a0be196d3441627a98b73d21afa
* filename|sha1: <sha1>
* filename|sha256: <sha256>
* malware-sample: verifier_win10_decrypted.bin|be210b16f1f6dd30796a59eacd6f6b0b
* filename|sha1: <sha1>
* filename|sha256: <sha256>
* malware-sample: rkimage_encrypted.bin|76e1e42988befbf13b4f934604206250
* filename|sha1: <sha1>
* filename|sha256: <sha256>
* malware-sample: rkimage_decrypted.bin|613fd19d0abc3d018ead52afabd59fec
* filename|sha1: <sha1>
* filename|sha256: <sha256>
* malware-sample: rkimage_backdoor_encrypted.bin|d7faa9b9ccb62e3822157d771c07270c
* filename|sha1: <sha1>
* filename|sha256: <sha256>
* malware-sample: rkimage_backdoor_decrypted.bin|c29505330199d6a9b1d479e1586f806d
* filename|sha1: <sha1>
* filename|sha256: <sha256>
* malware-sample: pe2_encrypted_b61e8d81.bin|1370e029e6d20bad3e49d95c7d935112
* filename|sha1: <sha1>
* filename|sha256: <sha256>
* malware-sample: pe2_decrypted.bin|d0cb0eb5588eb3b14c9b9a3fa7551c28
* filename|sha1: <sha1>
* filename|sha256: <sha256>
* malware-sample: pe1_encrypted_b61e1dcf.bin|8a463f466e167500c15527ffca5c301c
* filename|sha1: <sha1>
* filename|sha256: <sha256>
* malware-sample: pe1_decrypted.bin|c7fee0e094ee43f22882fb141c089cea
* filename|sha1: <sha1>
* filename|sha256: <sha256>
* malware-sample: mbr-inst.bin|fe9d665fd007774ee3423612f6833105
* filename|sha1: <sha1>
* filename|sha256: <sha256>
* malware-sample: mbr-clean.bin|daa0a9032ee38987e496c7acbc5d0fa8
* filename|sha1: <sha1>
* filename|sha256: <sha256>
* malware-sample: dropper64.bin|2c85404fe7d1891fd41fcee4c92ad305
* filename|sha1: <sha1>
* filename|sha256: <sha256>
* malware-sample: driver64.sys.bin|8062cbccb2895fb9215b3423cdefa396
* filename|sha1: <sha1>
* filename|sha256: <sha256>
* malware-sample: driver32.sys.bin|4dc2fc6ad7d9ed9fcf13d914660764cd
* filename|sha1: <sha1>
* filename|sha256: <sha256>
* malware-sample: C_932.NLS.bin|287fac6f4dac57253ac0061be1508f9d
* filename|sha1: <sha1>
* filename|sha256: <sha256>
