# Threat Report: 2022-12-07: Always Another Secret: Lifting the Haze on China-nexus Espionage in Southeast Asia | Mandiant


## Key Intelligence
* Date: 2022-12-07
* Threat Level: 2 (Medium)
* Tags: misp:tool="misp-scraper", osint:source-type="blog-post", misp:event-type="collection", tlp:white, misp-galaxy:mitre-attack-pattern="Command and Scripting Interpreter - T1059", misp-galaxy:mitre-attack-pattern="Replication Through Removable Media - T1091", misp-galaxy:mitre-attack-pattern="Rundll32 - T1218.011", misp-galaxy:mitre-attack-pattern="Invalid Code Signature - T1036.001", misp-galaxy:mitre-attack-pattern="Hijack Execution Flow - T1574", misp-galaxy:country="philippines"

---

## Indicators of Compromise (IOCs)
### External analysis
* link: https://www.mandiant.com/resources/blog/china-nexus-espionage-southeast-asia — Blog URL

### Payload delivery
* filename: G:\project\APT\U盘劫持\new\shellcode\Release\shellcode.pdb
* filename: G:\project\APT\U盘劫持\new\u2ec\Release\u2ec.pdb
* filename: %ALLUSERSPROFILE%\udisk\rzlog4cpp\_logger.dll — Files that are copied by DARKDEW from the removable drive to a compromised system
* filename: system%ALLUSERSPROFILE%\udisk\disk_watch.exe — Checked by DARKDEW
* filename: %ALLUSERSPROFILE%\udisk\disk_watch.exe — Files that are copied by DARKDEW from the removable drive to a compromised system
* filename: %ALLUSERSPROFILE%\udisk\UsbConfig.exe — Files that are copied by DARKDEW from the removable drive to a compromised system
* filename: %ALLUSERSPROFILE%\udisk\rzlog4cpp.dll — Files that are copied by DARKDEW from the removable drive to a compromised system
* filename: %ALLUSERSPROFILE%\udisk\DateCheck.exe — Checked by DARKDEW
* filename: %ALLUSERSPROFILE%\udisk\example.xlsx — Files that are copied by DARKDEW from the removable drive to a compromised system
* md5: <md5> — BLUEHAZE
* md5: <md5> — Razer Chromium Render Process (Legitimate Binary used for DLL Side-Loading)
* md5: <md5> — USB Network Gate (Legitimate Binary used for DLL Side-Loading)
* md5: <md5> — DARKDEW (usb.ini file)
* md5: <md5> — USB Network Gate (Legitimate Binary used for DLL Side-Loading)
* md5: <md5> — NCAT
* filename: %ALLUSERSPROFILE%\udisk\example.jpg
* md5: <md5> — MISTCLOAK
* md5: <md5> — DARKDEW (decrypted payload)
* filename: %ALLUSERSPROFILE%\udisk\wuwebv.exe — Files that are copied by DARKDEW from the removable drive to a compromised system
* filename: %ALLUSERSPROFILE%\udisk\u2ec.dll — Files that are copied by DARKDEW from the removable drive to a compromised system
* hostname: closed.theworkpc.com — NCAT C2

### Payload installation
* yara: rule M_Hunting_Launcher_BLUEHAZE_1 { 

    meta: 

        author = "Mandiant" 

    strings: 

        $s1 = "Libraries\\CNNUDTV" ascii 

        $s2 = "closed.theworkpc.com" ascii 

        $s3 = "cmd.exe /C wuwebv.exe -t -e" ascii 

    condition: 

        uint16(0) == 0x5a4d and 

        filesize < 500KB and 

        (2 of ($s*)) 

}  — BLUEHAZE
* yara: rule M_Hunting_Dropper_DARKDEW_1 { 

    meta: 

        author = "Mandiant" 

    strings: 

        $s1 = "do inroot" ascii 

        $s2 = "disk_watch" ascii 

        $s5 = "G:\\project\\APT\\" ascii 

        $s3 = "c:\\programdata\\udisk" ascii 

        $s4 = "new\\shellcode\\Release\\shellcode.pdb" ascii 

    condition: 

        filesize < 500KB and 

        (2 of ($s*)) 

}  — DARKDEW
* yara: rule M_Hunting_Launcher_MISTCLOAK_1 { 

    meta: 

        author = "Mandiant" 

    strings: 

        $s1 = "CheckUsbService" ascii 

        $s2 = "new\\u2ec\\Release\\u2ec.pdb" ascii 

        $s3 = "autorun.inf\\Protection for Autorun" ascii 

    condition: 

        uint16(0) == 0x5a4d and 

        filesize < 200KB and 

        (2 of ($s*)) 

}  — MISTCLOAK
