# Threat Report: 2024-03-22: APT29 Uses WINELOADER to Target German Political Parties


## Key Intelligence
* Date: 2024-03-22
* Threat Level: 1 (High)
* Tags: misp-galaxy:mitre-intrusion-set="APT29 - G0016", misp-galaxy:target-information="Germany", misp-galaxy:sector="Political party", misp-galaxy:country="russia", misp-galaxy:mitre-attack-pattern="Obfuscated Files or Information - T1027", misp-galaxy:mitre-attack-pattern="File and Directory Discovery - T1083", misp-galaxy:mitre-attack-pattern="Thread Execution Hijacking - T1055.003", misp-galaxy:mitre-attack-pattern="System Service Discovery - T1007", misp-galaxy:mitre-attack-pattern="System Information Discovery - T1082", misp-galaxy:mitre-attack-pattern="Access Token Manipulation - T1134", misp-galaxy:mitre-attack-pattern="File Deletion - T1070.004", misp-galaxy:mitre-attack-pattern="Windows Service - T1543.003", misp-galaxy:mitre-attack-pattern="Query Registry - T1012", misp-galaxy:mitre-attack-pattern="Process Discovery - T1057", tlp:white

---

## Indicators of Compromise (IOCs)
### External analysis
* link: https://www.mandiant.com/resources/blog/apt29-wineloader-german-political-parties
* link: https://urlscan.io/result/1df7e6f6-0cbc-4764-9e30-4c9f709c4fc1/ — URLscan.io - Submission: On March 05 via manual (March 5th 2024, 10:47:39 am UTC) from DE  — Scanned from DE

### Network activity
* url: https://waterforvoiceless.org/invite.php — actor-controlled compromised website
* ip-src: 162.241.169.194 — waterforvoiceless.org: Enriched via the dns module
* url: https://waterforvoiceless.org/util.php
* url: https://siestakeying.com/auth.php

### Payload delivery
* filename: %WINDIR%\Tasks\invite.txt — ROOTSAW
* filename: %WINDIR%\Tasks\invite.zip — ROOTSAW

### Payload installation
* yara: rule M_APT_Dropper_Rootsaw_Obfuscated

{

    meta:

        author = "Mandiant"

        disclaimer = "This rule is meant for hunting and is not tested to run in a production environment."

        description = "Detects obfuscated ROOTSAW payloads"

 

    strings:

        $ = "function _"

        $ = "new XMLHttpRequest();"

        $ = "'\\x2e\\x7a\\x69\\x70'"

        $ = "'\\x4f\\x70\\x65\\x6e'"

        $ = "\\x43\\x3a\\x5c\\x57"

 

    condition: 

        all of them

}
* yara: rule M_APT_Downloader_WINELOADER_1

{

    meta:

        author = "Mandiant"

        disclaimer = "This rule is meant for hunting and is not tested to run in a production environment."

        description = "Detects rc4 decryption logic in WINELOADER samples"

 

    strings:

        $ = {B9 00 01 00 00 99 F7 F9 8B 44 24 [50-200] 0F B6 00 3D FF 00 00 00} // Key initialization

        $ = {0F B6 00 3D FF 00 00 00} // Key size

 

    condition:

        all of them

 

}
* yara: rule M_APT_Downloader_WINELOADER_2

{

    meta:

        author = "Mandiant"

        disclaimer = "This rule is meant for hunting and is not tested to run in a production environment."

        description = "Detects payload invocation stub in WINELOADER"

 

    strings:

        // 48 8D 0D ?? ?? 00 00  lea rcx, module_start (Pointer to encrypted resource)

        // 48 C7 C2 ?? ?? 00 00  mov rdx, ???? (size of encrypted source)

        // E8 [4]  call decryption

        // 48 8D 05 [4]  lea rcx, ??

        // 48 8D 0D [4]  lea rax, module_start (decrypted resource)

        // 48 89 05 [4]  mov ptr_mod, rax

        //

        $ = {48 8D 0D ?? ?? 00 00 48 C7 C2 ?? ?? 00 00 E8 [4] 48 8d 0D [4] 48 8D 05 [4] 48 89 05 }

 

    condition:

        all of them

}

## Objects
### url — url object describes an url along with its normalized field (like extracted using faup parsing library) and its metadata.
* [Network activity] url: https://waterforvoiceless.org/invite.php
* [Other] text: ]org
* [Other] text: /invite.php
* [Network activity] hostname: waterforvoiceless.org
* [Other] text: waterforvoiceless[
* [Network activity] domain: waterforvoiceless.org

### file — File object describing a file with meta-information
* [Payload delivery] md5: <md5>
* [Payload delivery] filename: Invite.pdf

### file — File object describing a file with meta-information
* [Payload delivery] md5: <md5>
* [Payload delivery] filename: invite.php

### file — File object describing a file with meta-information
* [Payload delivery] md5: <md5>
* [Payload delivery] filename: invite.txt

### file — File object describing a file with meta-information
* [Payload delivery] md5: <md5>
* [Payload delivery] filename: invite.hta

### file — File object describing a file with meta-information
* [Payload delivery] md5: <md5>
* [Payload delivery] filename: invite.zip

### file — File object describing a file with meta-information
* [Payload delivery] md5: <md5>
* [Payload delivery] filename: sqldumper.exe

### file — File object describing a file with meta-information
* [Payload delivery] filename: Vcruntime140.dll
* [Payload delivery] md5: <md5>

### file — File object describing a file with meta-information
* [Payload delivery] md5: <md5>
* [Payload delivery] filename: vcruntime140.dll
