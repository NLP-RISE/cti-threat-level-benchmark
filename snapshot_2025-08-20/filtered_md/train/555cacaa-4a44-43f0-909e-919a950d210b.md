# Threat Report: 2015-05-18: OSINT Cmstar Downloader: Lurid and Enfalâ€™s New Cousin by Palo Alto Unit 42


## Key Intelligence
* Date: 2015-05-18
* Threat Level: 2 (Medium)
* Tags: type:OSINT, tlp:white

---

## Indicators of Compromise (IOCs)
### Artifacts dropped
* mutex: {53A4988C-F91F-4054-9076-220AC5EC03F3}
* filename: coyote_load.dll
* filename: xpsfiltsvcs.dll
* filename: xpsfiltsvcs.tmp
* filename: xpsfiltsvcs.txt
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* md5: <md5>
* md5: <md5>
* md5: <md5>
* md5: <md5>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* yara: rule ce_enfal_cmstar_debug_msg
 
{
 
meta:
 
author = "rfalcone"
 
description = "Detects the static debug strings within CMSTAR"
 
reference = "9b9cc7e2a2481b0472721e6b87f1eba4faf2d419d1e2c115a91ab7e7e6fc7f7c"
 
date = "5/10/2015"
 
strings:
 
$d1 = "EEE\x0d\x0a" fullword
 
$d2 = "TKE\x0d\x0a" fullword
 
$d3 = "VPE\x0d\x0a" fullword
 
$d4 = "VPS\x0d\x0a" fullword
 
$d5 = "WFSE\x0d\x0a" fullword
 
$d6 = "WFSS\x0d\x0a" fullword
 
$d7 = "CM**\x0d\x0a" fullword
 
condition:
 
uint16(0) == 0x5a4d and all of ($d*)
 
}
* md5: <md5> — Automatically added (via 239a25ac2b38f0be9392ceeaeab0d64cb239f033af07ed56565ba9d6a7ddcf1f)
* md5: <md5> — Automatically added (via 2e00a98212c5a2015d12612f0d26039a0c2dfee3e1b384675f613e683f276e02)
* md5: <md5> — Automatically added (via 42ed2edc37b957266ff7b02955a007dd82d955c09ef7be23e685d938e40ad61d)
* md5: <md5> — Automatically added (via 6b557c22ab12e8ea43d29e4f9f8a9483e3e75cd41338a674c9069b6dacdf7ba7)
* md5: <md5> — Automatically added (via 7ade616a8f1750cecba944a02e2bce1340b18a55697b29f721ccc4701aadba6e)
* md5: <md5> — Automatically added (via 88184983733f4d4fa767ad4e7993b01c5754f868470dd78ac1bad2b02c9e5001)
* md5: <md5> — Automatically added (via a330c52b7643de9d8be51a4ae0150b7b8390dbabaea9704069694835fbd3298e)
* md5: <md5> — Automatically added (via a8fa487d9f2152738bf49c8c69e8a147aae55c06f37c7e25026a28f21601ad7f)
* md5: <md5> — Automatically added (via adb05c1eecd789582886b3354b53831df9c9a06e891bb687633ee7ce21417edc)
* md5: <md5> — Automatically added (via b9d597aea53023727d8564e47e903b652f5e98a2c32bdc23bc4936448fb2d593)
* md5: <md5> — Automatically added (via c99c0b37f2fd64fa523d39c35ead6416a684ae203ae728feb5feff8490eb902c)
* md5: <md5> — Automatically added (via d541280b37dd5e2101cc5cd47b0991b8320714f5627b37646330136cddef0c23)
* md5: <md5> — Automatically added (via e0b3cc07d3a9b509480b240368dee2a29713ea1e240674c0ccf610c84810a7c5)
* md5: <md5> — Automatically added (via f4b8f71c0e10a345a855763e01033e2144e949c8f98c271755cc025e3f55b7da)
* sha1: <sha1> — Automatically added (via 30a6c3c7723fe14c4b6960fa3e4e57ba)
* sha1: <sha1> — Automatically added (via d05f012c9c1a7fb669a07070be821072)
* sha1: <sha1> — Automatically added (via e0417547ba54b58bb2c8f795bca0345c)
* sha1: <sha1> — Automatically added (via 239a25ac2b38f0be9392ceeaeab0d64cb239f033af07ed56565ba9d6a7ddcf1f)
* sha1: <sha1> — Automatically added (via 2e00a98212c5a2015d12612f0d26039a0c2dfee3e1b384675f613e683f276e02)
* sha1: <sha1> — Automatically added (via 42ed2edc37b957266ff7b02955a007dd82d955c09ef7be23e685d938e40ad61d)
* sha1: <sha1> — Automatically added (via 6b557c22ab12e8ea43d29e4f9f8a9483e3e75cd41338a674c9069b6dacdf7ba7)
* sha1: <sha1> — Automatically added (via 7ade616a8f1750cecba944a02e2bce1340b18a55697b29f721ccc4701aadba6e)
* sha1: <sha1> — Automatically added (via 88184983733f4d4fa767ad4e7993b01c5754f868470dd78ac1bad2b02c9e5001)
* sha1: <sha1> — Automatically added (via a330c52b7643de9d8be51a4ae0150b7b8390dbabaea9704069694835fbd3298e)
* sha1: <sha1> — Automatically added (via a8fa487d9f2152738bf49c8c69e8a147aae55c06f37c7e25026a28f21601ad7f)
* sha1: <sha1> — Automatically added (via adb05c1eecd789582886b3354b53831df9c9a06e891bb687633ee7ce21417edc)
* sha1: <sha1> — Automatically added (via b9d597aea53023727d8564e47e903b652f5e98a2c32bdc23bc4936448fb2d593)
* sha1: <sha1> — Automatically added (via c99c0b37f2fd64fa523d39c35ead6416a684ae203ae728feb5feff8490eb902c)
* sha1: <sha1> — Automatically added (via d541280b37dd5e2101cc5cd47b0991b8320714f5627b37646330136cddef0c23)
* sha1: <sha1> — Automatically added (via e0b3cc07d3a9b509480b240368dee2a29713ea1e240674c0ccf610c84810a7c5)
* sha1: <sha1> — Automatically added (via f4b8f71c0e10a345a855763e01033e2144e949c8f98c271755cc025e3f55b7da)

### Attribution
* text: WANGMINGHUA6@GMAIL.COM — Registrant

### External analysis
* link: http://researchcenter.paloaltonetworks.com/2015/05/cmstar-downloader-lurid-and-enfals-new-cousin/
* text: Cmstar
* text: Lurid
* text: Enfal
* link: http://la.trendmicro.com/media/misc/lurid-downloader-enfal-report-en.pdf
* link: http://researchcenter.paloaltonetworks.com/2014/08/attacks-east-asia-using-google-code-command-control/
* link: https://www.bluecoat.com/security-blog/2014-10-08/linking-apts-2011-and-2014-active-scam-network

### Network activity
* url: http://happy.launchtrue.com:8080/cgl-bin/update.cgi
* url: /cgl-bin/update.cgi
* hostname: links.dogsforhelp.com
* hostname: three.earewq.com
* hostname: question.eboregi.com
* hostname: here.pechooin.com
* hostname: sarey.phdreport.com
* hostname: bakler.featurvoice.com
* hostname: help.ubxpi0s.com
* hostname: forever.cowforhelp.com
* hostname: question.shiesiido.com
* hostname: endline.biortherm.com
* hostname: right.marubir.com
* hostname: baby.brabbq.com
* hostname: lind.kruptcy.com
* hostname: under.suttgte.com
* hostname: finally.basiccompare.com
* hostname: crystal.diskfunc.com
* hostname: queenfansclub.com
* hostname: novnitie.com
* hostname: flash-vip.com
* hostname: replyfunt.com
* hostname: natcongress.com
* hostname: keep.regebky.com
* hostname: love.regebky.com
* hostname: happy.launchtrue.com
* hostname: turber.xoxcobbs.com
* hostname: dns.thinkttun.com
* hostname: error.yandex-pro.com
* hostname: help.redhag.com
* hostname: mssage.hotoicq.com
* hostname: new.hoticq.com
* hostname: stone.timmf.com
* hostname: xphome.mailru-vip.com

### Payload delivery
* md5: <md5>
* md5: <md5>
* md5: <md5>
* md5: <md5>
* md5: <md5>
* md5: <md5>
* md5: <md5>
* md5: <md5>
* md5: <md5>
* md5: <md5>
* md5: <md5>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
