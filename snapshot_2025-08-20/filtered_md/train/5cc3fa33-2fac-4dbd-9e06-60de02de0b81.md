# Threat Report: 2019-04-27: OSINT - BabyShark Malware Part Two â€“ Attacks Continue Using KimJongRAT and PCRat


## Key Intelligence
* Date: 2019-04-27
* Threat Level: 3 (Low)
* Tags: misp-galaxy:tool="BabyShark", type:OSINT, osint:lifetime="perpetual", osint:certainty="50", tlp:white

---

## Indicators of Compromise (IOCs)
### External analysis
* text: In February 2019, Unit 42 published a blog about the BabyShark malware family and the associated spear phishing campaigns targeting U.S. national think tanks. Since that publication, malicious attacks leveraging BabyShark have continued through March and April 2019. The attackers expanded targeting to the cryptocurrency industry, showing that those behind these attacks also have interests in financial gain.

While tracking the latest activities of the threat group, Unit 42 researchers were able to collect both the BabyShark malwareâ€™s server-side and client-side files, as well as two encoded secondary PE payload files that the malware installs on the victim hosts upon receiving an operatorâ€™s command. By analyzing the files, we were able to further understand the overall multi-staging structure of the BabyShark malware and features, such as how it attempts to maintain operational security and supported remote administration commands. Based on our research, it appears the malware author calls the encoded secondary payload â€œCowboyâ€ regardless of what malware family is delivered.

Our research shows the most recent malicious activities involving BabyShark malware appear to be carried out for two purposes:

    Espionage on nuclear security and the Korean peninsulaâ€™s national security issues
    Financial gain with focus on the cryptocurrency industry based on the decoy contents used in the samples, shown in Figure 1. Xcryptocrash is an online cryptocurrency gambling game.

### Payload delivery
* attachment: Fig-2.-BabyShark-flowchart.png
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256> — Malicious Word Macro Document
* sha256: <sha256>
* sha256: <sha256>

## Objects
### script — Object describing a computer program written to be run in a special run-time environment. The script or shell script can be used for malicious activities but also as support tools for threat analysts.
* [Other] text: import base64

with open(â€˜cowboyâ€™, â€˜râ€™) as file_in, open(â€˜cowboy_clear.binâ€™, â€˜wbâ€™) as file_out:

    EncStr = file_in.read()

    BlkSz = 10

    len_EncStr = len(EncStr)

    NonBlk10_ptr = len_EncStr â€“ (BlkSz -1) * (len_EncStr // BlkSz)

    NonBlk10 = EncStr [:NonBlk10_ptr]

    result = â€

    EncStr = EncStr [NonBlk10_ptr::]

    #print EncStr

    x = range (-1,BlkSz-1)

    Blksize1 = len_EncStr // BlkSz

    for n in x:

        loop_buff1_ptr = n * (len_EncStr // BlkSz)

        loop_buff1 = EncStr [loop_buff1_ptr:loop_buff1_ptr+Blksize1]

        #print loop_buff1

        result = loop_buff1 + result

    result = result + NonBlk10

    clear = base64.b64decode(result)[::-1]

    print clear

file_out.write(clear)
* [Other] text: Python
* [Other] text: Python Script for Decoding Cowboy
* [Other] text: Trusted

### file — File object describing a file with meta-information
* [Payload delivery] md5: <md5>
* [Payload delivery] sha1: <sha1>
* [Payload delivery] sha256: <sha256>

### virustotal-report — VirusTotal report
* [Other] datetime: 2019-04-27T00:43:44
* [Payload delivery] link: https://www.virustotal.com/file/75917cc1bd9ecd7ef57b7ef428107778b19f46e8c38c00f1c70efc118cb8aab5/analysis/1556325824/
* [Payload delivery] text: 24/63

### file — File object describing a file with meta-information
* [Payload delivery] md5: <md5>
* [Payload delivery] sha1: <sha1>
* [Payload delivery] sha256: <sha256>

### virustotal-report — VirusTotal report
* [Other] datetime: 2019-04-24T20:00:44
* [Payload delivery] link: https://www.virustotal.com/file/bd6efb16527b025a5fd256bb357a91b4ff92aff599105252e50b87f1335db9e1/analysis/1556136044/
* [Payload delivery] text: 3/71

### file — File object describing a file with meta-information
* [Payload delivery] md5: <md5> — Malicious Word Macro Document
* [Payload delivery] sha1: <sha1> — Malicious Word Macro Document
* [Payload delivery] sha256: <sha256> — Malicious Word Macro Document

### virustotal-report — VirusTotal report
* [Other] datetime: 2019-04-26T09:23:39 — Malicious Word Macro Document
* [Payload delivery] link: https://www.virustotal.com/file/4b3416fb6d1ed1f762772b4dd4f4f652e63ba41f7809b25c5fa0ee9010f7dae7/analysis/1556270619/ — Malicious Word Macro Document
* [Payload delivery] text: 5/71 — Malicious Word Macro Document

### file — File object describing a file with meta-information
* [Payload delivery] md5: <md5>
* [Payload delivery] sha1: <sha1>
* [Payload delivery] sha256: <sha256>

### virustotal-report — VirusTotal report
* [Other] datetime: 2018-12-31T07:08:17
* [Payload delivery] link: https://www.virustotal.com/file/d50a0980da6297b8e4cec5db0a8773635cee74ac6f5c1ff18197dfba549f6712/analysis/1546240097/
* [Payload delivery] text: 11/68
