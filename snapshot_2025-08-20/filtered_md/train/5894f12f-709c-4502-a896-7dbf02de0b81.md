# Threat Report: 2017-02-03: OSINT - Windows SMBv3 Denial of Service Proof of Concept (0 Day Exploit)


## Key Intelligence
* Date: 2017-02-03
* Threat Level: 3 (Low)
* Tags: tlp:white

---

## Indicators of Compromise (IOCs)
### External analysis
* link: https://isc.sans.edu/diary/Windows%2BSMBv3%2BDenial%2Bof%2BService%2BProof%2Bof%2BConcept%2B%280%2BDay%2BExploit%29/22029

### Network activity
* snort: alert tcp $EXTERNAL_NET 445 -> $HOME_NET any  (sid: 10001515; msg: "SMB Excessive Large Tree Connect Response"; byte_test: 3,>,1000,1; content: "|fe 53 4d 42 40 00|"; offset: 4; depth: 6; content: "|03 00|"; offset: 16; depth:2 ;) â€” Based on this understanding of the exploit (please let me know if I didn't get it right or missed something), I wrote a simple snort signature that looks for Tree Connect messages that exceed 1000 bytes in size. Use this at your own risk. It is in "works for me" state:

### Payload delivery
* link: https://github.com/lgandx/PoC/tree/master/SMBv3%20Tree%20Connect
