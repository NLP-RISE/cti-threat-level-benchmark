# Threat Report: 2016-12-22: OSINT - New Linux/Rakos threat: devices and servers under SSH scan (again)


## Key Intelligence
* Date: 2016-12-22
* Threat Level: 3 (Low)
* Tags: ms-caro-malware:malware-platform="Linux", osint:source-type="blog-post", tlp:white

---

## Indicators of Compromise (IOCs)
### Artifacts dropped
* yara: rule linux_rakos
{
    meta:
        description = "Linux/Rakos.A executable"
        author = "Peter KÃ¡lnai"
        date = "2016-12-13"
        reference = "http://www.welivesecurity.com/2016/12/20/new-linuxrakos-threat-devices-servers-ssh-scan/"
        version = "1"
        contact = "threatintel@eset.com"
        license = "BSD 2-Clause"


    strings:
        $ = "upgrade/vars.yaml"
        $ = "MUTTER"
        $ = "/tmp/.javaxxx"
        $ = "uckmydi"

    condition:
        3 of them
}

### External analysis
* link: http://www.welivesecurity.com/2016/12/20/new-linuxrakos-threat-devices-servers-ssh-scan/
* comment: Apparently, frustrated users complain more often recently on various forums about their embedded devices being overloaded with computing and network tasks. What these particular posts have in common is the name of the process causing the problem. It is executed from a temporary directory and disguised as a part of the Java framework, namely â€œ.javaxxxâ€. Additional names like â€œ.swapâ€ or â€œkworkerâ€ are also used. A few weeks ago, we discussed the recent Mirai incidents and Mirai-connected IoT security problems in The Hive Mind: When IoT devices go rogue and all that was written then still holds true.
Attack vector

The attack is performed via brute force attempts at SSH logins, in a similar way to that in which many Linux worms operate, including Linux/Moose (which spread by attacking Telnet logins) â€“ also referenced here â€“ as analyzed by ESET since last year. The targets include both embedded devices and servers with an open SSH port and where a very weak password has been set. The obvious aim of this trojan is to assemble a list of unsecured devices and to have an opportunity to create a botnet consisting of as many zombies as possible. The scan starts with not too extensive list of IPs and spreads incrementally to more targets. Only machines that represent low-hanging fruit from the security perspective are compromised. Note that victims reported cases when they had had a strong password but they forgot their device that had online service enabled and it was reverted to a default password after a factory reset. Just a couple of hours of online exposure was enough for such a reset machine to end up compromised!
* link: https://github.com/eset/malware-ioc/tree/master/rakos
* link: https://www.virustotal.com/file/62f875a31c5f8541a68176d03c3b9d6d0ee6fa90cf54307d7d07aed5fc573797/analysis/1481878860/ — EM_386	 - 711 - Xchecked via VT: 0492e5c07c1426af9ce73ad33e00a3fd8477c6c2
* link: https://www.virustotal.com/file/90cd3e16d6d0069e758bb7c1ec929354be24f52857bd77fdd246e20e4aaca75d/analysis/1481878661/ — EM_386	 - 708 - Xchecked via VT: e46e8e5e823eb0466981afb7683fd918d6fe78a9
* link: https://www.virustotal.com/file/2a77e8d43b347c4ccf80271493eedf7b7b7f45d1e30e818e321657cf9a14f1d9/analysis/1482355624/ — EM_386 - 706 - Xchecked via VT: 36b2fffe98f517355425797fc242f2cb82271c0c
* link: https://www.virustotal.com/file/efedce38a1908a27115e05b3e62fab52f68fae2db5ae1c50c455f007f964c6d2/analysis/1482355624/ — EM_386 - 700 - Xchecked via VT: c54d50025d9f66ce2ace3361a8626aee468d94ba
* link: https://www.virustotal.com/file/a7ce7dc40bb8abf835efae5ebacc82cb8af2cc57b5021f0d28dc14924022c85d/analysis/1482355624/ — EM_MIPS - ??? - Xchecked via VT: 14af6254d9ca310b4d52778d050cb8dd7a5de1d8
* link: https://www.virustotal.com/file/d59ffe12b75f596a4a30074690f96497800a6ed97be8248c573e4048adac7e05/analysis/1482355623/ — EM_X86_64 - 698 - Xchecked via VT: c93bddd9cdb4f2e185b54a4931257954e25e7c37
* link: https://www.virustotal.com/file/3fe9e1e0a2e626ef10cc443ec1725a8c17cbfa323864e0eb9359399177998470/analysis/1482355623/ — EM_X86_64	- 697 - Xchecked via VT: e53c73fe6a552eab720e7ee685ea4e159ebd4fdd
* link: https://www.virustotal.com/file/d731ccb407a924ca56fa9b3690e0b7debd1cce61c6de8ec63ede3a992c8af33e/analysis/1482355623/ — EM_X86_64 - 695 - Xchecked via VT: 3435ca5505ce8dfe8e1b22e0ebd4f41c60050cc0
* link: https://www.virustotal.com/file/83160da5a4cb335ea2a9a72bc96c833cd7eab9df96a61c1d6f01e13668046b25/analysis/1482355623/ — EM_X86_64 - 694 - Xchecked via VT: def04ec688ac6b41580dd3a6e78445b56536ba34
* link: https://www.virustotal.com/file/ce4bb2ce2bf66ab721b808acf9d74a7a8afddd03cbaa6aa56c7788ff7b7251bb/analysis/1482247676/ — EM_X86_64 - 688 - Xchecked via VT: f80836349d6e97251030190ecd30dda0047f1ee6

### Network activity
* ip-dst: 217.12.208.28 — C&C Servers
* ip-dst: 217.12.203.31 — C&C Servers
* ip-dst: 193.169.245.68 — C&C Servers
* ip-dst: 46.8.44.55 — C&C Servers
* ip-dst: 195.123.210.100 — C&C Servers
* ip-dst: 5.34.183.231 — C&C Servers
* ip-dst: 5.34.180.64 — C&C Servers
* ip-dst: 185.82.216.125 — C&C Servers
* ip-dst: 185.14.30.78 — C&C Servers
* ip-dst: 185.14.29.65 — C&C Servers
* ip-dst: 185.20.184.117 — C&C Servers

### Payload delivery
* sha1: <sha1> — EM_X86_64 - 688
* sha1: <sha1> — EM_X86_64 - 694
* sha1: <sha1> — EM_X86_64 - 695
* sha1: <sha1> — EM_X86_64	- 697
* sha1: <sha1> — EM_X86_64 - 698
* sha1: <sha1> — EM_MIPS - ???
* sha1: <sha1> — EM_386 - 700
* sha1: <sha1> — EM_386 - 706
* sha1: <sha1> — EM_386	 - 708
* sha1: <sha1> — EM_386	 - 711
* sha256: <sha256> — EM_386	 - 711 - Xchecked via VT: 0492e5c07c1426af9ce73ad33e00a3fd8477c6c2
* md5: <md5> — EM_386	 - 711 - Xchecked via VT: 0492e5c07c1426af9ce73ad33e00a3fd8477c6c2
* sha256: <sha256> — EM_386	 - 708 - Xchecked via VT: e46e8e5e823eb0466981afb7683fd918d6fe78a9
* md5: <md5> — EM_386	 - 708 - Xchecked via VT: e46e8e5e823eb0466981afb7683fd918d6fe78a9
* sha256: <sha256> — EM_386 - 706 - Xchecked via VT: 36b2fffe98f517355425797fc242f2cb82271c0c
* md5: <md5> — EM_386 - 706 - Xchecked via VT: 36b2fffe98f517355425797fc242f2cb82271c0c
* sha256: <sha256> — EM_386 - 700 - Xchecked via VT: c54d50025d9f66ce2ace3361a8626aee468d94ba
* md5: <md5> — EM_386 - 700 - Xchecked via VT: c54d50025d9f66ce2ace3361a8626aee468d94ba
* sha256: <sha256> — EM_MIPS - ??? - Xchecked via VT: 14af6254d9ca310b4d52778d050cb8dd7a5de1d8
* md5: <md5> — EM_MIPS - ??? - Xchecked via VT: 14af6254d9ca310b4d52778d050cb8dd7a5de1d8
* sha256: <sha256> — EM_X86_64 - 698 - Xchecked via VT: c93bddd9cdb4f2e185b54a4931257954e25e7c37
* md5: <md5> — EM_X86_64 - 698 - Xchecked via VT: c93bddd9cdb4f2e185b54a4931257954e25e7c37
* sha256: <sha256> — EM_X86_64	- 697 - Xchecked via VT: e53c73fe6a552eab720e7ee685ea4e159ebd4fdd
* md5: <md5> — EM_X86_64	- 697 - Xchecked via VT: e53c73fe6a552eab720e7ee685ea4e159ebd4fdd
* sha256: <sha256> — EM_X86_64 - 695 - Xchecked via VT: 3435ca5505ce8dfe8e1b22e0ebd4f41c60050cc0
* md5: <md5> — EM_X86_64 - 695 - Xchecked via VT: 3435ca5505ce8dfe8e1b22e0ebd4f41c60050cc0
* sha256: <sha256> — EM_X86_64 - 694 - Xchecked via VT: def04ec688ac6b41580dd3a6e78445b56536ba34
* md5: <md5> — EM_X86_64 - 694 - Xchecked via VT: def04ec688ac6b41580dd3a6e78445b56536ba34
* sha256: <sha256> — EM_X86_64 - 688 - Xchecked via VT: f80836349d6e97251030190ecd30dda0047f1ee6
* md5: <md5> — EM_X86_64 - 688 - Xchecked via VT: f80836349d6e97251030190ecd30dda0047f1ee6
