# Threat Report: 2021-05-04: Shining a Light on DARKSIDE Ransomware Operations


## Key Intelligence
* Date: 2021-05-04
* Threat Level: 1 (High)
* Tags: misp-galaxy:ransomware="Darkside", tlp:white

---

## Indicators of Compromise (IOCs)
### Artifacts dropped
* windows-service-name: spservice
* yara: rule Backdoor_Win_C3_1
{
    meta:
        author = â€œFireEyeâ€
        date_created = "2021-05-11"
        description = "Detection to identify the Custom Command and Control (C3) binaries."
        md5 = "7cdac4b82a7573ae825e5edb48f80be5"
    strings:
        $dropboxAPI = "Dropbox-API-Arg"
        $knownDLLs1 = "WINHTTP.dll" fullword
        $knownDLLs2 = "SHLWAPI.dll" fullword
        $knownDLLs3 = "NETAPI32.dll" fullword
        $knownDLLs4 = "ODBC32.dll" fullword
        $tokenString1 = { 5B 78 5D 20 65 72 72 6F 72 20 73 65 74 74 69 6E 67 20 74 6F 6B 65 6E }
        $tokenString2 = { 5B 78 5D 20 65 72 72 6F 72 20 63 72 65 61 74 69 6E 67 20 54 6F 6B 65 6E }
        $tokenString3 = { 5B 78 5D 20 65 72 72 6F 72 20 64 75 70 6C 69 63 61 74 69 6E 67 20 74 6F 6B 65 6E }
    condition:
        filesize < 5MB and uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550 and (((all of ($knownDLLs*)) and ($dropboxAPI or (1 of ($tokenString*)))) or (all of ($tokenString*))) — Custom Command and Control (C3) YARA rule
* yara: rule Dropper_Win_Darkside_1
{
    meta:
        author = "FireEye"
        date_created = "2021-05-11"
        description = "Detection for on the binary that was used as the dropper leading to DARKSIDE."
    strings:
        $CommonDLLs1 = "KERNEL32.dll" fullword
        $CommonDLLs2 = "USER32.dll" fullword
        $CommonDLLs3 = "ADVAPI32.dll" fullword
        $CommonDLLs4 = "ole32.dll" fullword
        $KeyString1 = { 74 79 70 65 3D 22 77 69 6E 33 32 22 20 6E 61 6D 65 3D 22 4D 69 63 72 6F 73 6F 66 74 2E 57 69 6E 64 6F 77 73 2E 43 6F 6D 6D 6F 6E 2D 43 6F 6E 74 72 6F 6C 73 22 20 76 65 72 73 69 6F 6E 3D 22 36 2E 30 2E 30 2E 30 22 20 70 72 6F 63 65 73 73 6F 72 41 72 63 68 69 74 65 63 74 75 72 65 3D 22 78 38 36 22 20 70 75 62 6C 69 63 4B 65 79 54 6F 6B 65 6E 3D 22 36 35 39 35 62 36 34 31 34 34 63 63 66 31 64 66 22 }
        $KeyString2 = { 74 79 70 65 3D 22 77 69 6E 33 32 22 20 6E 61 6D 65 3D 22 4D 69 63 72 6F 73 6F 66 74 2E 56 43 39 30 2E 4D 46 43 22 20 76 65 72 73 69 6F 6E 3D 22 39 2E 30 2E 32 31 30 32 32 2E 38 22 20 70 72 6F 63 65 73 73 6F 72 41 72 63 68 69 74 65 63 74 75 72 65 3D 22 78 38 36 22 20 70 75 62 6C 69 63 4B 65 79 54 6F 6B 65 6E 3D 22 31 66 63 38 62 33 62 39 61 31 65 31 38 65 33 62 22 }
        $Slashes = { 7C 7C 7C 7C 7C 7C 7C 7C 7C 7C 7C 7C 7C 7C 7C 7C 7C 7C 7C 7C }
    condition:
        filesize < 2MB and filesize > 500KB and uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550 and (all of ($CommonDLLs*)) and (all of ($KeyString*)) and $Slashes — DARKSIDE Dropper YARA rule
* yara: rule Ransomware_Win_DARKSIDE_v1__1
{
    meta:
        author = â€œFireEyeâ€
        date_created = â€œ2021-03-22â€
        description = â€œDetection for early versions of DARKSIDE ransomware samples based on the encryption mode configuration values.â€
        md5 = â€œ1a700f845849e573ab3148daef1a3b0bâ€   
    strings:
        $consts = { 80 3D [4] 01 [1-10] 03 00 00 00 [1-10] 03 00 00 00 [1-10] 00 00 04 00 [1-10] 00 00 00 00 [1-30] 80 3D [4] 02 [1-10] 03 00 00 00 [1-10] 03 00 00 00 [1-10] FF FF FF FF [1-10] FF FF FF FF [1-30] 03 00 00 00 [1-10] 03 00 00 00 }
    condition:
        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and $consts
} — DARKSIDE YARA rule

### External analysis
* link: https://www.fireeye.com/blog/threat-research/2021/05/shining-a-light-on-darkside-ransomware-operations.html
* link: https://krebsonsecurity.com/2021/05/a-closer-look-at-the-darkside-ransomware-gang/
* link: https://www.flashpoint-intel.com/blog/darkside-faces-xss-ban-servers-seized/
* link: https://www.flashpoint-intel.com/blog/darkside-ransomware-links-to-revil-difficult-to-dismiss/

### Network activity
* url: http://sol-doc.xyz/sol/ID-482875588 — UNC2465 Downloader URL
* domain: sol-doc.xyz — UNC2465 Malicious Infrastructure
* domain: los-web.xyz — UNC2465  EMPIRE C2
* domain: koliz.xyz — UNC2465 File Hosting
* ip-dst: 81.91.177.54 — UNC2465 Remote Access
* ip-dst: 73.234.155.208 — UNC2659 Login Source
* ip-dst|port: 104.193.252.197|443 — UNC2628 BEACON C2
* ip-dst|port: 162.244.81.253|443 — UNC2628 BEACON C2
* ip-dst|port: 185.180.197.86|443 — UNC2628 BEACON C2
* domain: athaliaoriginals.com — UNC2628 BEACON C2
* domain: lagrom.com — UNC2628 BEACON C2
* hostname: ctxinit.azureedge.net — UNC2628 BEACON C2
* ip-dst: 45.77.64.111 — UNC2628 Login Source
* url: https://104.193.252.197:443/
* url: https://162.244.81.253:443/
* url: https://185.180.197.86:443/
* url: https://athaliaoriginals.com/
* url: https://lagrom.com:443/font.html
* url: https://lagrom.com:443/night.html
* url: https://lagrom.com:443/online.html
* url: https://lagrom.com:443/send.html
* url: https://lagrom.com/find.html?key=id#-

### Payload delivery
* md5: <md5> — DARKSIDE Sample MD5
* md5: <md5> — DARKSIDE Sample MD5
* md5: <md5> — DARKSIDE Sample MD5
* md5: <md5> — DARKSIDE Sample MD5
* md5: <md5> — DARKSIDE Sample MD5
* md5: <md5> — DARKSIDE Sample MD5
* md5: <md5> — DARKSIDE Sample MD5
* md5: <md5> — DARKSIDE Sample MD5
* md5: <md5> — DARKSIDE Sample MD5
* md5: <md5> — DARKSIDE Sample MD5
* md5: <md5> — DARKSIDE Sample MD5
* md5: <md5> — DARKSIDE Sample MD5
* md5: <md5> — DARKSIDE Sample MD5
* md5: <md5> — DARKSIDE Sample MD5
* md5: <md5> — DARKSIDE Sample MD5
* md5: <md5> — DARKSIDE Sample MD5
* md5: <md5> — DARKSIDE Sample MD5
* md5: <md5> — DARKSIDE Sample MD5
* md5: <md5> — DARKSIDE Sample MD5
* md5: <md5> — DARKSIDE Sample MD5
* md5: <md5> — DARKSIDE Sample MD5
* md5: <md5> — DARKSIDE Sample MD5
* md5: <md5> — DARKSIDE Sample MD5
* md5: <md5> — DARKSIDE Sample MD5
* md5: <md5> — DARKSIDE Sample MD5
* md5: <md5> — DARKSIDE Sample MD5
* md5: <md5> — DARKSIDE Sample MD5
* md5: <md5> — DARKSIDE Sample MD5
* md5: <md5> — DARKSIDE Sample MD5
* md5: <md5> — DARKSIDE Sample MD5
* md5: <md5> — DARKSIDE Sample MD5
* md5: <md5> — DARKSIDE Sample MD5
* md5: <md5> — DARKSIDE Sample MD5
* md5: <md5> — DARKSIDE Sample MD5
* md5: <md5> — DARKSIDE Sample MD5
* md5: <md5> — DARKSIDE Sample MD5
* md5: <md5> — UNC2465  Ngrok Utility
* md5: <md5> — UNC2465 VBS Launcher
* md5: <md5> — UNC2465 Downloader LNK
* md5: <md5> — UNC2628  BEACON sample
