# Threat Report: 2017-08-05: OSINT - Tale of the Two Payloads â€“ TrickBot and Nitol


## Key Intelligence
* Date: 2017-08-05
* Threat Level: 3 (Low)
* Tags: misp-galaxy:tool="Trick Bot", tlp:white, europol-incident:availability="dos-ddos"

---

## Indicators of Compromise (IOCs)
### External analysis
* link: https://www.trustwave.com/Resources/SpiderLabs-Blog/Tale-of-the-Two-Payloads-%E2%80%93-TrickBot-and-Nitol/
* text: A couple of weeks ago, we observed the Necurs botnet distributing a new malware spam campaign with a payload combo that includes Trickbot and Nitol. Trickbot is a banking trojan that first appeared late last year targeting banks in Europe, UK, Australia and other countries. This trojan injects malicious code into a web browser process and siphons sensitive data when the victim visits a target banking website. The Nitol family is well-known for its distributed denial of service (DDOS) and backdoor capabilities.
* attachment: 6a01676411d5a7970b01b7c9124d75970b-800wi.png — Payloads â€“ Nitol and Trickbot Packages
* link: https://www.virustotal.com/file/b50904ae9527ed6ea09576db81bca8dc46a1921ae4e90f7c388e17ee034123b2/analysis/1501775685/ — Both spam campaign have the same payload: - Xchecked via VT: d127c60b32fb4a83f711a4a38e9053f347ed90ec

### Network activity
* hostname: e.googlex.me — On port 40

### Payload delivery
* sha1: <sha1> — Both spam campaign have the same payload:
* sha256: <sha256> — Both spam campaign have the same payload: - Xchecked via VT: d127c60b32fb4a83f711a4a38e9053f347ed90ec
* md5: <md5> — Both spam campaign have the same payload: - Xchecked via VT: d127c60b32fb4a83f711a4a38e9053f347ed90ec

### Support Tool
* text: def trickbot_decode(text):
	ts = "aZbwIiWO39SuApBFcPC/RGYomVxUNL01nr56le47Hv8DJsjQgEkKy+fT2dXtzhMq"
	alphabet = [n for n in ts]
	bit_str = ""
	text_str = ""

	for char in text:
		if char in alphabet:
			bin_char = bin(alphabet.index(char)).lstrip("0b")
			bin_char = bin_char.zfill(6)
			bit_str += bin_char

	brackets = [bit_str[x:x+8] for x in range(0,len(bit_str),8)]

	for bracket in brackets:
		text_str += chr(int(bracket,2))

	return text_str.encode("UTF-8") — This malware avoids static analysis by encoding most of its strings using a lookup algorithm that involves a decoder table represented by this code:
