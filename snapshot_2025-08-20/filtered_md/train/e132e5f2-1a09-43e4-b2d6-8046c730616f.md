# Threat Report: 2022-12-13: OSINT - Fortinet says SSL-VPN pre-auth RCE bug is exploited in attacks


## Key Intelligence
* Date: 2022-12-13
* Threat Level: 1 (High)
* Tags: type:OSINT, osint:lifetime="perpetual", osint:certainty="50", tlp:white, misp-galaxy:mitre-attack-pattern="Exploit Public-Facing Application - T1190", misp-galaxy:mitre-attack-pattern="External Remote Services - T1133"

---

## Indicators of Compromise (IOCs)
### Artifacts dropped
* filename-pattern: /data/lib/libips.bak — IDS not flag not set (as many FPs are possible) but for forensic evaluation it could be useful (as mentioned in Fortinet report as "Presence of the following artifacts in the filesystem:").
* filename-pattern: /data/lib/libgif.so — IDS not flag not set (as many FPs are possible) but for forensic evaluation it could be useful (as mentioned in Fortinet report as "Presence of the following artifacts in the filesystem:").
* filename-pattern: /data/lib/libiptcp.so — IDS not flag not set (as many FPs are possible) but for forensic evaluation it could be useful (as mentioned in Fortinet report as "Presence of the following artifacts in the filesystem:").
* filename-pattern: /data/lib/libipudp.so — IDS not flag not set (as many FPs are possible) but for forensic evaluation it could be useful (as mentioned in Fortinet report as "Presence of the following artifacts in the filesystem:").
* filename-pattern: /data/lib/libjepg.so — IDS not flag not set (as many FPs are possible) but for forensic evaluation it could be useful (as mentioned in Fortinet report as "Presence of the following artifacts in the filesystem:").
* filename-pattern: /var/.sslvpnconfigbk — IDS not flag not set (as many FPs are possible) but for forensic evaluation it could be useful (as mentioned in Fortinet report as "Presence of the following artifacts in the filesystem:").
* filename-pattern: /data/etc/wxd.conf — IDS not flag not set (as many FPs are possible) but for forensic evaluation it could be useful (as mentioned in Fortinet report as "Presence of the following artifacts in the filesystem:").
* filename-pattern: /flash — IDS not flag not set (as many FPs are possible) but for forensic evaluation it could be useful (as mentioned in Fortinet report as "Presence of the following artifacts in the filesystem:").

### Network activity
* ip-dst: 139.180.184.197
* ip-dst: 66.42.91.32
* ip-dst: 158.247.221.101
* ip-dst: 107.148.27.117
* ip-dst: 139.180.128.142
* ip-dst: 155.138.224.122
* ip-dst: 185.174.136.20

## Objects
### report — Metadata used to generate an executive level report
* [External analysis] link: https://www.bleepingcomputer.com/news/security/fortinet-says-ssl-vpn-pre-auth-rce-bug-is-exploited-in-attacks/
* [Other] text: Fortinet urges customers to patch their appliances against an actively exploited FortiOS SSL-VPN vulnerability that could allow unauthenticated remote code execution on devices.

The security flaw is tracked as CVE-2022-42475 and is a heap-based buffer overflow bug in FortiOS sslvpnd. When exploited, the flaw could allow unauthenticated users to crash devices remotely and potentially perform code execution.
* [Other] text: Webpage

### ip-port — An IP address (or domain or hostname) and a port seen as a tuple (or as a triple) in a specific time frame.
* [Network activity] port: 444
* [Network activity] ip-dst: 188.34.130.40

### ip-port — An IP address (or domain or hostname) and a port seen as a tuple (or as a triple) in a specific time frame.
* [Network activity] port: 30080
* [Network activity] port: 30081
* [Network activity] port: 30443
* [Network activity] port: 20443
* [Network activity] ip-dst: 103.131.189.143

### ip-port — An IP address (or domain or hostname) and a port seen as a tuple (or as a triple) in a specific time frame.
* [Network activity] port: 8443
* [Network activity] port: 444
* [Network activity] ip-dst: 192.36.119.61

### ip-port — An IP address (or domain or hostname) and a port seen as a tuple (or as a triple) in a specific time frame.
* [Network activity] port: 8033
* [Network activity] ip-dst: 172.247.168.153

### report — Metadata used to generate an executive level report
* [External analysis] link: https://www.fortiguard.com/psirt/FG-IR-22-398
* [Other] text: A heap-based buffer overflow vulnerability [CWE-122] in FortiOS SSL-VPN may allow a remote unauthenticated attacker to execute arbitrary code or commands via specifically crafted requests.
* [Other] text: Report

### vulnerability — Vulnerability object describing a common vulnerability enumeration which can describe published, unpublished, under review or embargo vulnerability for software, equipments or hardware.
* [Other] text: FG-IR-22-398
* [External analysis] vulnerability: CVE-2022-42475
* [Internal reference] text: Vulnerability ID Assigned
* [Other] text: FortiOS version 7.2.0 through 7.2.2
FortiOS version 7.0.0 through 7.0.8
FortiOS version 6.4.0 through 6.4.10
FortiOS version 6.2.0 through 6.2.11
FortiOS-6K7K version 7.0.0 through 7.0.7
FortiOS-6K7K version 6.4.0 through 6.4.9
FortiOS-6K7K version 6.2.0 through 6.2.11
FortiOS-6K7K version 6.0.0 through 6.0.14
are vulnerable
