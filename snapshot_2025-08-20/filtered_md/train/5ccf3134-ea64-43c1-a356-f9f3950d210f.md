# Threat Report: 2019-05-05: SystemTen (ELF trojan installer, miner, bot and rootkit) / ex-Rocke


## Key Intelligence
* Date: 2019-05-05
* Threat Level: 3 (Low)
* Tags: tlp:white, ms-caro-malware:malware-platform="Linux", adversary:infrastructure-state="active", circl:incident-classification="malware", malware_classification:malware-category="Downloader", malware_classification:malware-category="Rootkit", malware_classification:malware-category="Botnet", OSINT

---

## Indicators of Compromise (IOCs)
### Artifacts dropped
* md5: <md5>
* md5: <md5>
* md5: <md5>
* md5: <md5>
* md5: <md5>

### External analysis
* link: https://imgur.com/a/H7YuWuj — MalwareMustDie incident analysis and reports of infection campaign from early March 2019 to end of April 2019
* link: https://old.reddit.com/r/LinuxMalware/comments/bfaea2/fun_in_dissecting_lsd_packer_elf_golang_miner/ — MalwareMustDie incident analysis and reports of infection campaign from early March 2019 to end of April 2019

### Internal reference
* text: hwlh3wlh44lh
Circle_MI
xmr
xig
ddgs
qW3xT
wnTKYg
t00ls.ru
sustes
thisxxs
hashfish
kworkerds
tmp/devtool
systemctI
plfsbce
luyybce
6Tx3Wq
dblaunchs
vmlinuz
get.bi-chi.com
hashvault.pro
nanopool.org
119.9.106.27
104.130.210.206 — The data to be grep'ed by the malware for the upgrade and anti-competitive function which is useful to prevent similar threat.
* link: https://community.atlassian.com/t5/Confluence-questions/How-come-my-confluence-installation-was-hacked-by-Kerberods/qaq-p/1054605#M141274 — MalwareMustDie incident analysis and reports of the ELF bot for command execution installed by adversary

### Network activity
* hostname: d.heheda.tk. — Malware contacted C2 hostnames
* hostname: c.heheda.tk — Malware contacted C2 hostnames
* hostname: dd.heheda.tk — Malware contacted C2 hostnames
* hostname: systemten.org — Malware contacted C2 hostnames
* hostname: w.3ei.xyz — Malware contacted C2 hostnames
* hostname: w.21-3n.xyz — Malware contacted C2 hostnames
* hostname: t.w2wz.cn — Malware contacted C2 hostnames
* hostname: 1.z9ls.com — Malware contacted C2 hostnames
* hostname: yxarsh.shop — Malware contacted C2 hostnames
* hostname: i.ooxx.ooo — Malware contacted C2 hostnames
* hostname: baocangwh.cn — Malware contacted C2 hostnames
* hostname: img.sobot.com — Malware contacted C2 hostnames
* hostname: sowcar.com — Malware contacted C2 hostnames
* ip-dst: 42.56.76.104 — The origin of IP addresses used by the adversaries for their C2 servers
* ip-dst: 47.90.213.21 — The origin of IP addresses used by the adversaries for their C2 servers
* ip-dst: 116.62.232.226 — The origin of IP addresses used by the adversaries for their C2 servers
* ip-dst: 211.91.160.238 — The origin of IP addresses used by the adversaries for their C2 servers
* ip-dst: 221.204.60.69 — The origin of IP addresses used by the adversaries for their C2 servers
* ip-dst: 103.52.216.35 — The origin of IP addresses used by the adversaries for their C2 servers
* ip-dst: 45.63.0.102 — The origin of IP addresses used by the adversaries for their C2 servers
* ip-dst: 104.238.151.101 — The origin of IP addresses used by the adversaries for their C2 servers
* ip-dst: 104.248.53.213 — The origin of IP addresses used by the adversaries for their C2 servers
* ip-dst: 134.209.104.20 — The origin of IP addresses used by the adversaries for their C2 servers
* ip-dst: 198.204.231.250 — The origin of IP addresses used by the adversaries for their C2 servers
* other: Handshake Protocol: Certificate
Certificate Length: 1374
Certificate (id-at-commonName=d.heheda.tk)
version: v3 (2)
serialNumber : 0x0391959ec679153960186df2c0768f78425e
signature (sha256WithRSAEncryption)
Algorithm Id: 1.2.840.113549.1.1.11 (sha256WithRSAEncryption)
rdnSequence: 3 items
(id-at-commonName=Let's Encrypt Authority X3,
id-at-organizationName=Let's Encrypt,
id-at-countryName=US )
Validity not before: utcTime: 19-04-22 01:13:26 (UTC)
Validity not after: utcTime: 19-07-21 01:13:26 (UTC)
issuer: rdnSequence (0) rdnSequence: 2 items
(id-at-commonName=DST Root CA X3,
id-at-organizationName=Digital Signature Trust Co.) — SSL Certification used by the adversary for encrypting the SSL traffic communication
* ip-dst|port: 1.1.1.1|53 — Malware (the bot type) is using these hardcoded DNS IP (and port) for lookup C2 hostnames
* ip-dst|port: 8.8.8.8|53 — Malware (the bot type) is using these hardcoded DNS IP (and port) for lookup C2 hostnames
* ip-dst|port: 208.67.222.222|5353 — Malware (the bot type) is using these hardcoded DNS IP (and port) for lookup C2 hostnames
* ip-dst|port: 208.67.222.222|443 — Malware (the bot type) is using these hardcoded DNS IP (and port) for lookup C2 hostnames
* ip-dst: 47.95.85.22 — The origin of IP addresses used by the adversaries for their C2 servers
* hostname: gwjyhs.com — Malware contacted C2 hostnames

### Payload delivery
* filename: /tmp/kerberods (elf trojan installer)
* filename: /tmp/khugepageds (elf monero miner xmrig)
* filename: /tmp/kthrotlds (elf trojan bot)
* filename: /tmp/kintegrityds (elf trojan bot)
* filename: /tmp/kpsmouseds (elf trojan installer)
* filename: /tmp/kerb  (elf trojan bot)
* filename: /etc/cron.d/tomcat (persistence)
* filename: /etc/cron.d/root (persistence)
* filename: /var/spool/cron/root (persistence)
* filename: /var/spool/cron/crontabs/root (persistence)
* filename: /usr/sbin/kthrotlds (elf trojan bot)
* filename: /usr/sbin/kintegrityds (elf trojan bot)
* filename: /usr/sbin/kerberods (elf trojan installer)
* filename: /usr/sbin/kpsmouseds (elf trojan installer)
* filename: /etc/rc.d/init.d/kthrotlds (persistence)
* filename: /etc/rc.d/init.d/kerberods (persistence)
* filename: /etc/rc.d/init.d/kpsmouseds (persistence)
* filename: /etc/rc.d/init.d/kintegrityds (persistence)
* filename: /tmp/ld.so.preload (rootkit preload module)
* filename: /usr/local/lib/libpamcd.so (rootkit preload module)
* filename: /usr/local/lib/libcset.so (rootkit preload module)
* filename: /usr/local/lib/libdb-0.1.so (rootkit preload module)
* vulnerability: CVE-2019-3395 — Vulnerabilities used by adversary to infect affected Linux systems
* vulnerability: CVE-2019-3396 — Vulnerabilities used by adversary to infect affected Linux systems
* vulnerability: CVE-2019-1003033 — Vulnerabilities used by adversary to infect affected Linux systems
* vulnerability: CVE-2019-1003030 — Vulnerabilities used by adversary to infect affected Linux systems
* vulnerability: CVE-2019-1003029 — Vulnerabilities used by adversary to infect affected Linux systems
* other: -----BEGIN CERTIFICATE-----
MIIDhzCCAm+gAwIBAgIBADANBgkqhkiG9w0BAQUFADA7MQswCQYDVQQGEwJOTDER
MA8GA1UEChMIUG9sYXJTU0wxGTAXBgNVBAMTEFBvbGFyU1NMIFRlc3QgQ0EwHhcN
MTEwMjEyMTQ0NDAwWhcNMjEwMjEyMTQ0NDAwWjA7MQswCQYDVQQGEwJOTDERMA8G
A1UEChMIUG9sYXJTU0wxGTAXBgNVBAMTEFBvbGFyU1NMIFRlc3QgQ0EwggEiMA0G
CSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQDA3zf8F7vglp0/ht6WMn1EpRagzSHx
mdTs6st8GFgIlKXsm8WL3xoemTiZhx57wI053zhdcHgH057Zk+i5clHFzqMwUqny
50BwFMtEonILwuVA+T7lpg6z+exKY8C4KQB0nFc7qKUEkHHxvYPZP9al4jwqj+8n
YMPGn8u67GB9t+aEMr5P+1gmIgNb1LTV+/Xjli5wwOQuvfwu7uJBVcA0Ln0kcmnL
R7EUQIN9Z/SG9jGr8XmksrUuEvmEF/Bibyc+E1ixVA0hmnM3oTDPb5Lc9un8rNsu
KNF+AksjoBXyOGVkCeoMbo4bF6BxyLObyavpw/LPh5aPgAIynplYb6LVAgMBAAGj
gZUwgZIwDAYDVR0TBAUwAwEB/zAdBgNVHQ4EFgQUtFrkpbPe0lL2udWmlQ/rPrzH
/f8wYwYDVR0jBFwwWoAUtFrkpbPe0lL2udWmlQ/rPrzH/f+hP6Q9MDsxCzAJBgNV
BAYTAk5MMREwDwYDVQQKEwhQb2xhclNTTDEZMBcGA1UEAxMQUG9sYXJTU0wgVGVz
dCBDQYIBADANBgkqhkiG9w0BAQUFAAOCAQEAuP1U2ABUkIslsCfdlc2i94QHHYeJ
SsR4EdgHtdciUI5I62J6Mom+Y0dT/7a+8S6MVMCZP6C5NyNyXw1GWY/YR82XTJ8H
DBJiCTok5DbZ6SzaONBzdWHXwWwmi5vg1dxn7YxrM9d0IjxM27WNKs4sDQhZBQkF
pjmfs2cb4oPl4Y9T9meTx/lvdkRYEug61Jfn6cA+qHpyPYdTH+UshITnmp5/Ztkf
m/UTSLBNFNHesiTZeH31NcxYGdHSme9Nc/gfidRa0FLOCfWxRlFqAI47zG9jAQCZ
7Z2mCGDNMhjQc+BYcdnl0lPXjdDK6V0qCg1dVewhUBcW5gZKzV7e9+DpVA==
-----END CERTIFICATE----- — Certification attached in the malware sample (the ELF binary installer ones)
* vulnerability: CVE-2018-1000861 — The adversary aimed Apache Jenkins on this vulnerability

### Social network
* github-repository: helegedada — The alleged account utilized by adversary
* other: https://pastebin.com/u/SYSTEMTEN — The pastebin account that is allegedly owned by adversary
* whois-registrant-email: 4592248@qq.com — QQ identification used by adversary's utilized payload domains  "gwjyhs .com", "baocangwh .cn"
* whois-registrant-email: 4592248@gmail.com — Same number as QQ ID used to register "w2wz .cn under Gmail address
