# Threat Report: 2024-01-24: NSPX30: A sophisticated AitM-enabled implant evolving since 2005


## Key Intelligence
* Date: 2024-01-24
* Threat Level: 1 (High)
* Tags: tlp:white, misp-galaxy:country="china", misp-galaxy:target-information="China", misp-galaxy:target-information="Japan", misp-galaxy:target-information="United Kingdom"

---

## Indicators of Compromise (IOCs)
### External analysis
* link: https://www.welivesecurity.com/en/eset-research/que-tipos-de-hackers-existem-e-o-que-os-distingue/

### Other
* comment: cmd /c powershell -inputformat none -outputformat none -NonInteractive -Command Set-MpPreference -SubmitSamplesConsent 0 — The installer attempts to disable the submission of samples by Windows Defender, and adds an exclusion rule for the loader DLL msnsp.dll.
* comment: cmd /c powershell -inputformat none -outputformat none -NonInteractive -Command Add-MpPreference -ExclusionPath “%PROGRAMFILES%\(x86)\Common Files\microsoft shared\TextConv\msnsp.dll” — The installer attempts to disable the submission of samples by Windows Defender, and adds an exclusion rule for the loader DLL msnsp.dll.

### Payload delivery
* filename: Z:\Workspace\mm\32\NSPX30\Plugins\plugin\b001.pdb — PDB paths found in plugin samples
* filename: Z:\Workspace\Code\MM\X30Pro\trunk\MM\Plugins\hookdll\Release\hookdll.pdb — PDB paths found in plugin samples
* filename: %PROGRAMFILES%\(x86)\Common Files\microsoft shared\TextConv\msnsp.dll — persistent loader DLL
* filename: %ALLUSERSPROFILE%\Windows\mshlp.dll
* filename: %ALLUSERSPROFILE%\Windows\WIN.cfg

## Objects
### file — File object describing a file with meta-information
* [Payload delivery] sha1: <sha1>
* [Payload delivery] filename: comx3.dll.txt

### file — File object describing a file with meta-information
* [Payload delivery] sha1: <sha1>
* [Payload delivery] filename: WIN.cfg

### file — File object describing a file with meta-information
* [Payload delivery] sha1: <sha1>
* [Payload delivery] filename: msfmtkl.dat

### file — File object describing a file with meta-information
* [Payload delivery] sha1: <sha1>
* [Payload delivery] filename: c001.dat

### file — File object describing a file with meta-information
* [Payload delivery] sha1: <sha1>
* [Payload delivery] filename: mshlp.dll

### file — File object describing a file with meta-information
* [Payload delivery] sha1: <sha1>
* [Payload delivery] filename: c002.dat

### file — File object describing a file with meta-information
* [Payload delivery] sha1: <sha1>
* [Payload delivery] filename: c003.dat

### file — File object describing a file with meta-information
* [Payload delivery] sha1: <sha1>
* [Payload delivery] filename: a010.dat

### file — File object describing a file with meta-information
* [Payload delivery] sha1: <sha1>
* [Payload delivery] filename: b011.dat

### file — File object describing a file with meta-information
* [Payload delivery] sha1: <sha1>
* [Payload delivery] filename: msnsp.dll

### file — File object describing a file with meta-information
* [Payload delivery] sha1: <sha1>
* [Payload delivery] filename: comx3.dll

### file — File object describing a file with meta-information
* [Payload delivery] sha1: <sha1>
* [Payload delivery] filename: minibrowser_shell.dll

### file — File object describing a file with meta-information
* [Payload delivery] sha1: <sha1>
* [Payload delivery] filename: b010.dat

### domain-ip — A domain/hostname and IP address seen as a tuple in a specific time frame.
* [Network activity] ip-dst: 104.193.88.123
* [Network activity] hostname: www.baidu.com

### domain-ip — A domain/hostname and IP address seen as a tuple in a specific time frame.
* [Network activity] ip-dst: 183.134.93.171
* [Network activity] domain: dl_dir.qq.com
