# Threat Report: 2024-04-26: Unplugging PlugX: Sinkholing the PlugX USB worm botnet


## Key Intelligence
* Date: 2024-04-26
* Threat Level: 3 (Low)
* Tags: tlp:white, misp-galaxy:mitre-malware="PlugX - S0013", misp-galaxy:mitre-attack-pattern="DLL Side-Loading - T1574.002", misp-galaxy:mitre-intrusion-set="Mustang Panda - G0129"

---

## Indicators of Compromise (IOCs)
### External analysis
* link: https://blog.sekoia.io/unplugging-plugx-sinkholing-the-plugx-usb-worm-botnet/

### Network activity
* ip-dst: 45.251.240.55
* ip-dst: 45.142.166.112 — Sinkholed by Sekoia
* ip-dst: 103.56.53.46
* ip-dst: 43.254.217.165

### Payload delivery
* filename: wsc.dll — DLL
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>

### Payload installation
* yara: rule apt_MustangPanda_PlugXWorm_lnk {
    meta:
        id = "bea0b6e6-0999-431d-8ea2-324aa7497657"
        version = "1.0"
        malware = "PlugXWorm"
        intrusion_set = "MustangPanda"
        description = "Detects PlugXWorm Malicious LNK"
        source = "Sekoia.io"
        classification = "TLP:WHITE"
    strings:
        $ = "RECYCLER.BIN\\1\\CEFHelper.exe" wide
    condition:
        uint32be(0) == 0x4c000000 
        and filesize < 2KB
        and all of them 
}
* yara: import "pe"
rule apt_MustangPanda_MaliciousDLL_random_exports {
    meta:
        id = "d14ae417-bc6f-40b1-a027-084522fce516"
        version = "1.0"
        intrusion_set = "MustangPanda"
        description = "Detects malicious DLL used by MustangPanda"
        source = "Sekoia.io"
        classification = "TLP:WHITE"
    strings: 
    	$trait = { 66 89 55 FC } 
    condition: 
    	pe.is_dll() and filesize < 100KB and 
        for any e in pe.export_details: (
        	$trait in (e.offset..e.offset+50)
            and e.name matches /^[a-z]{10,}$/
        )
        and not pe.is_signed
}
