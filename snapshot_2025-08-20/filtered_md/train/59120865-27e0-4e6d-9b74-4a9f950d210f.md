# Threat Report: 2017-05-09: OSINT - EPS Processing Zero-Days Exploited by Multiple Threat Actors


## Key Intelligence
* Date: 2017-05-09
* Threat Level: 3 (Low)
* Tags: tlp:white, misp-galaxy:tool="GAMEFISH"

---

## Indicators of Compromise (IOCs)
### External analysis
* link: https://www.fireeye.com/blog/threat-research/2017/05/eps-processing-zero-days.html
* text: In 2015, FireEye published details about two attacks exploiting vulnerabilities in Encapsulated PostScript (EPS) of Microsoft Office. One was a zero-day and one was patched weeks before the attack launched.

Recently, FireEye identified three new zero-day vulnerabilities in Microsoft Office products that are being exploited in the wild.

At the end of March 2017, we detected another malicious document leveraging an unknown vulnerability in EPS and a recently patched vulnerability in Windows Graphics Device Interface (GDI) to drop malware. Following the April 2017 Patch Tuesday, in which Microsoft disabled EPS, FireEye detected a second unknown vulnerability in EPS.

FireEye believes that two actors â€“ Turla and an unknown financially motivated actor â€“ were using the first EPS zero-day (CVE-2017-0261), and APT28 was using the second EPS zero-day (CVE-2017-0262) along with a new Escalation of Privilege (EOP) zero-day (CVE-2017-0263). Turla and APT28 are Russian cyber espionage groups that have used these zero-days against European diplomatic and military entities. The unidentified financial group targeted regional and global banks with offices in the Middle East. The following is a description of the EPS zero-days, associated malware, and the new EOP zero-day. Each EPS zero-day is accompanied by an EOP exploit, with the EOP being required to escape the sandbox that executes the FLTLDR.EXE instance used for EPS processing.

The malicious documents have been used to deliver three different payloads. CVE-2017-0261 was used to deliver SHIRIME (Turla) and NETWIRE (unknown financially motivated actor), and CVE-2017-0262 was used to deliver GAMEFISH (APT28). CVE-2017-0263 is used to escalate privileges during the delivery of the GAMEFISH payload.

FireEye email and network products detected the malicious documents.

FireEye has been coordinating with the Microsoft Security Response Center (MSRC) for the responsible disclosure of this information. Microsoft advises all customers to follow the guidance in security advisory ADV170005 as a defense-in-depth measure against EPS filter vulnerabilities.
* link: https://www.virustotal.com/file/91acb0d56771af0196e34ac95194b3d0bf3200bc5f6208caf3a91286958876f9/analysis/1494351849/ — Trump's_Attack_on_Syria_English.docx  (GAMEFISH) 	  wmdmediacodecs.com - Xchecked via VT: f8e92d8b5488ea76c40601c8f1a08790
* link: https://www.virustotal.com/file/ef783cc3c4e1e0649b4629f3396cff4c0e0e0e67c07cacb8a9ae7c0cfa16bf0c/analysis/1494352684/ — Confirmation_letter_ACM.docx  (NETWIRE) 	  185.106.122.113 - Xchecked via VT: 006bdb19b6936329bffd4054e270dc6a
* link: https://www.virustotal.com/file/6785e29698444243677300db6a0c519909ae9e620d575e76d9be4862b33ed490/analysis/1494351848/ — Confirmation_letter.docx.bin  (NETWIRE) 	  84.200.2.12 - Xchecked via VT: 2abe3cc4bff46455a945d56c27e9fb45

### Network activity
* ip-dst: 84.200.2.12
* ip-dst: 138.201.44.30
* ip-dst: 185.106.122.113
* hostname: tnsc.webredirect.org
* domain: wmdmediacodecs.com

### Payload delivery
* md5: <md5> — Confirmation_letter.docx.bin  (NETWIRE) 	  84.200.2.12
* filename: Confirmation_letter.docx.bin
* md5: <md5> — Confirmation_letter.docx  (NETWIRE) 	  138.201.44.30
* filename: Confirmation_letter.docx
* md5: <md5> — Confirmation_letter_ACM.docx  (NETWIRE) 	  185.106.122.113
* filename: Confirmation_letter_ACM.docx
* md5: <md5> — st07383.en17.docx  (SHIRIME) 	  tnsc.webredirect.org
* filename: st07383.en17.docx
* md5: <md5> — Trump's_Attack_on_Syria_English.docx  (GAMEFISH) 	  wmdmediacodecs.com
* filename: Trump's_Attack_on_Syria_English.docx
* vulnerability: CVE-2017-0261
* vulnerability: CVE-2017-0262
* vulnerability: CVE-2017-0263
* vulnerability: CVE-2017-0001
* vulnerability: CVE-2016-7255
* sha256: <sha256> — Trump's_Attack_on_Syria_English.docx  (GAMEFISH) 	  wmdmediacodecs.com - Xchecked via VT: f8e92d8b5488ea76c40601c8f1a08790
* sha1: <sha1> — Trump's_Attack_on_Syria_English.docx  (GAMEFISH) 	  wmdmediacodecs.com - Xchecked via VT: f8e92d8b5488ea76c40601c8f1a08790
* sha256: <sha256> — Confirmation_letter_ACM.docx  (NETWIRE) 	  185.106.122.113 - Xchecked via VT: 006bdb19b6936329bffd4054e270dc6a
* sha1: <sha1> — Confirmation_letter_ACM.docx  (NETWIRE) 	  185.106.122.113 - Xchecked via VT: 006bdb19b6936329bffd4054e270dc6a
* sha256: <sha256> — Confirmation_letter.docx.bin  (NETWIRE) 	  84.200.2.12 - Xchecked via VT: 2abe3cc4bff46455a945d56c27e9fb45
* sha1: <sha1> — Confirmation_letter.docx.bin  (NETWIRE) 	  84.200.2.12 - Xchecked via VT: 2abe3cc4bff46455a945d56c27e9fb45
