# Threat Report: 2016-03-28: OSINT - TREASUREHUNT: A CUSTOM POS MALWARE TOOL


## Key Intelligence
* Date: 2016-03-28
* Threat Level: 3 (Low)
* Tags: tlp:white, type:OSINT

---

## Indicators of Compromise (IOCs)
### Artifacts dropped
* pattern-in-file: %USERPROFILE%\documents\visual studio 2012\Projects\treasureHunter\Release\treasureHunter.pdb

### External analysis
* link: https://www.fireeye.com/blog/threat-research/2016/03/treasurehunt_a_cust.html
* comment: Since early 2015, FireEye Threat Intelligence has observed the significant growth of point-of-sale (POS) malware families in underground cyber crime forums. POS malware refers to malicious software that extracts payment card information from memory and usually uploads that data to a command and control (CnC) server.

Although the PCI DSS rules changed in October 2015, leaving retailers who have not transitioned from existing â€œswipeâ€ cards to EMV or â€œchipâ€ enabled cards liable for card present fraud in more ways than before, many retailers are still in the process of transitioning to chip-enabled card technology. Criminals appear to be racing to infect POS systems in the United States before US retailers complete this transition. In 2015, more than a dozen new POS malware families were discovered.[1]

POS malware may be freely available, available for purchase, or custom-built for specific cyber criminals. Free tools are often a result of malware source code being leaked, and tend to be older and more easily detected by security software. POS malware available for purchase may be newly developed tools or modified versions of older tools. Then there is another class of POS malware that is developed for use exclusively by a particular threat group.

In this article we examine TREASUREHUNT, POS malware that appears to have been custom-built for the operations of a particular â€œdump shop,â€ which sells stolen credit card data. TREASUREHUNT enumerates running processes, extracts payment card information from memory, and then transmits this information to a command and control server.
* link: https://www.virustotal.com/file/046d0b8024cea9c6aea2ef04b51ce9fd482214fbb3ef068a85c0f91f193f248f/analysis/1458803364/
* link: https://www.virustotal.com/file/fe5f50fce2f430432a636ef899919505e9477968d8caff7506e888cffed0b5f8/analysis/1450248638/
* link: https://www.virustotal.com/file/ceed84d8d76ee27c92d48dd01c96e6345fb3981319151601f78f4e9ec754a73b/analysis/1440623335/
* link: https://www.virustotal.com/file/68358c49d084939ecae7b78f2c0df0eb8d5b98f31dc13fb5878d8bfbdd5db86f/analysis/1458802637/
* link: https://www.virustotal.com/file/442bca26dddfe4a5d1c0b4adaaaab205a1dca856c41d9353ba45e0794e3660ed/analysis/1458802460/
* link: https://www.virustotal.com/file/7eca8bf6d17891529c74d8fce85471135a203f312ae09fe3d907355c7dea9f59/analysis/1458803543/
* link: https://www.virustotal.com/file/6a6b099dd313cfd9009d28f42613ed0375ffac9e03e5392329a2a3a4a5c358cd/analysis/1458802694/
* link: https://www.virustotal.com/file/ab7ac10833cf5936c98554c20a123c395631e09200b4f87a610195bf49dda8e1/analysis/1458803121/

### Network activity
* url: millionjam.eu/megastock/gate.php — TREASUREHUNT v0.1
* url: cortykopl.com/sdfsgsdsdssdf/gate.php — TREASUREHUNT v0.1
* url: 91.232.29.83/sdfsgsdsdssdf/gate.php — TREASUREHUNT v0.1
* url: 179.43.160.34/wp-content/temp/gate.php — TREASUREHUNT v0.1
* url: 3sipiojt.com/noth/gate.php — TREASUREHUNT v0.1
* url: friltopyes.com/southcal/gate.php — TREASUREHUNT v0.1
* url: seatrip888.eu/gate.php — TREASUREHUNT v0.1
* url: friltopyes.com/alabol/gate.php — TREASUREHUNT v0.1
* url: friltopyes.com/nothcal/gate.php — TREASUREHUNT v0.1
* domain: millionjam.eu — TREASUREHUNT v0.1
* domain: cortykopl.com — TREASUREHUNT v0.1
* ip-dst: 91.232.29.83 — TREASUREHUNT v0.1
* ip-dst: 179.43.160.34 — TREASUREHUNT v0.1
* domain: 3sipiojt.com — TREASUREHUNT v0.1
* domain: friltopyes.com — TREASUREHUNT v0.1
* domain: seatrip888.eu — TREASUREHUNT v0.1
* hostname: logmeinrescue.us.com — TREASUREHUNT v0.1.1

### Payload delivery
* md5: <md5> — TREASUREHUNT 0.1
* md5: <md5> — TREASUREHUNT 0.1
* md5: <md5> — TREASUREHUNT 0.1
* md5: <md5> — TREASUREHUNT 0.1
* md5: <md5> — TREASUREHUNT 0.1
* md5: <md5> — TREASUREHUNT 0.1
* md5: <md5> — TREASUREHUNT 0.1
* md5: <md5> — TREASUREHUNT 0.1
* md5: <md5> — TREASUREHUNT 0.1
* sha256: <sha256> — TREASUREHUNT 0.1 - Xchecked via VT: cec2810556c63e9c225afb6a5ca58bc1
* sha1: <sha1> — TREASUREHUNT 0.1 - Xchecked via VT: cec2810556c63e9c225afb6a5ca58bc1
* sha256: <sha256> — TREASUREHUNT 0.1 - Xchecked via VT: 6a9348f582b2e121a5d9bff1e8f0935f
* sha1: <sha1> — TREASUREHUNT 0.1 - Xchecked via VT: 6a9348f582b2e121a5d9bff1e8f0935f
* sha256: <sha256> — TREASUREHUNT 0.1 - Xchecked via VT: 070e9a317ee53ac3814eb86bc7d5bf49
* sha1: <sha1> — TREASUREHUNT 0.1 - Xchecked via VT: 070e9a317ee53ac3814eb86bc7d5bf49
* sha256: <sha256> — TREASUREHUNT 0.1 - Xchecked via VT: 3e2003878b364b5d77790109f24c9137
* sha1: <sha1> — TREASUREHUNT 0.1 - Xchecked via VT: 3e2003878b364b5d77790109f24c9137
* sha256: <sha256> — TREASUREHUNT 0.1 - Xchecked via VT: 21f99135f836fb4d3f4685d704a4460d
* sha1: <sha1> — TREASUREHUNT 0.1 - Xchecked via VT: 21f99135f836fb4d3f4685d704a4460d
* sha256: <sha256> — TREASUREHUNT 0.1 - Xchecked via VT: ea6248e4ddd080e60e6140ab0f8562e1
* sha1: <sha1> — TREASUREHUNT 0.1 - Xchecked via VT: ea6248e4ddd080e60e6140ab0f8562e1
* sha256: <sha256> — TREASUREHUNT 0.1 - Xchecked via VT: 48692beb88058652115b5c447cd28589
* sha1: <sha1> — TREASUREHUNT 0.1 - Xchecked via VT: 48692beb88058652115b5c447cd28589
* sha256: <sha256> — TREASUREHUNT 0.1 - Xchecked via VT: 9f9c2e6072e0a233631d234bdcf1b293
* sha1: <sha1> — TREASUREHUNT 0.1 - Xchecked via VT: 9f9c2e6072e0a233631d234bdcf1b293

### Payload installation
* md5: <md5>
