# Threat Report: 2023-02-02: No Pineapple! –DPRK Targeting of Medical Research and Technology Sector


## Key Intelligence
* Date: 2023-02-02
* Threat Level: 2 (Medium)
* Tags: misp-galaxy:mitre-intrusion-set="Lazarus Group - G0032", tlp:white

---

## Indicators of Compromise (IOCs)
### External analysis
* link: https://labs.withsecure.com/content/dam/labs/docs/WithSecure-Lazarus-No-Pineapple-Threat-Intelligence-Report-2023.pdf
* link: https://labs.withsecure.com/publications/no-pineapple-dprk-targeting-of-medical-research-and-technology-sector

### Network activity
* user-agent: Mozilla/5.0 (X11; Linux x86_64; rv:91.0)
* user-agent: Gecko/20100101 Firefox/91.0
* ip-dst: 104.225.129.86 — Cobalt Strike C2
* ip-dst: 104.225.129.103 — Cobalt Strike C2, exfiltration target
* ip-dst: 15.207.207.64 — Acres.exe C2
* ip-dst: 209.95.60.92 — Connected to webshell with suspicious user agent
* ip-dst: 175.45.176.27 — Connected to webshell with suspicious user agent
* ip-dst: 23.237.32.34 — Connected to webshell with suspicious user agent
* ip-dst: 193.176.211.0/24 — Connected to webshell with suspicious user agent
* ip-dst: 146.185.26.150 — Connected to webshell with suspicious user agent
* ip-dst: 154.6.26.2 — Connected to webshell with suspicious user agent

### Other
* comment: When investigating the network logs on the patient
zero server to identify entities connecting to the
webshells, WithSecure™ realized that one of the
connections originated from a North Korean IP
address: 175.45.176[.]27 This connection was a
single instance at the beginning of that current day. It
was both preceded on the previous days, as well as
followed (with a delay) by connections coming from
a proxy address: 209.95.60[.]92. We suspect that
this instance was an operational security failure by
the threat actor at the start of their workday and after
a small delay they came back via the intended route.
This is significant as the only North Korean IP address-
es are three /24 networks which are directly controlled
and used by the North Korean government, and as
such it is extremely likely that this activity was initiated
by a North Korean state actor.

### Payload delivery
* sha1: <sha1> — Mimikatz
* sha1: <sha1> — Bind shell
* sha1: <sha1> — GREASE2
* sha1: <sha1> — Cobalt Strike
* sha1: <sha1> — Cobalt Strike
* sha1: <sha1> — 3Proxy
* sha1: <sha1> — Dtrack
* sha1: <sha1> — All detected files
* sha1: <sha1> — All detected files
* sha1: <sha1> — All detected files
* sha1: <sha1> — All detected files
* sha1: <sha1> — All detected files

### Payload installation
* yara: rule lazarus_dtrack_unpacked
{
meta:
author="Withsecure Threat Intelligence"
description="Detects unpacked dtrack variant with smb data staging"
date="2023-01-01"
strings:
$str_mutex = "MTX_Global"
$str_cmd_1 = "/c net use \\\\" wide
$str_cmd_2 = "/c ping -n 3 127.0.01 > NUL % echo EEE > \"%s\"" wide
$str_cmd_3 = "/c move /y %s \\\\" wide
$str_cmd_4 = "/c systeminfo > \"%s\" & tasklist > \"%s\" & netstat -naop tcp > \"%s\"" wide
condition:
uint16(0) == 0x5A4D and
all of them
}
* yara: rule lazarus_dtrack_unpacked
{
meta:
author=" Withsecure Threat Intelligence "
description="Detects lazarus acres.exe 64bit rat written with QT framework"
date="2023-01-01"
strings:
$str_nopineapple = "< No Pineapple! >"
$str_qt_library = "Qt 5.12.10"
$str_xor = {8B 10 83 F6 ?? 83 FA 01 77}
condition:
uint16(0) == 0x5A4D and
all of them
}
* yara: rule lazarus_grease2
{
meta:
author=" Withsecure Threat Intelligence "
description="Detects GREASE2 malware"
date="2023-01-01"
strings:
$str_rdpconf = "c: \\windows\\temp\\RDPConf.exe" fullword nocase
$str_rdpwinst = "c: \\windows\\temp\\RDPWInst.exe" fullword nocase
$str_net_user = "net user”
$str_admins_add = "net localgroup administrators"
condition:
uint16(0) == 0x5A4D and
all of them
}
* yara: rule lazarus_bindshell
{
meta:
author=" Withsecure Threat Intelligence "
description="Detects bind shell from Lazarus group"
date="2023-01-01"
strings:
$str_comspec = "COMSPEC"
$str_consolewindow = "GetConsoleWindow"
$str_ShowWindow = "ShowWindow"
$str_WSASocketA = "WSASocketA"
$str_CreateProcessA = "CreateProcessA"
$str_port = {B9 4D 05 00 00 89}
condition:
uint16(0) == 0x5A4D and
all of them
}

## Objects
### file — File object describing a file with meta-information
* [Payload delivery] sha1: <sha1>
* [Payload delivery] filename: carbon.jsp

### file — File object describing a file with meta-information
* [Payload delivery] sha1: <sha1>
* [Payload delivery] filename: base.jsp

### file — File object describing a file with meta-information
* [Payload delivery] sha1: <sha1>
* [Payload delivery] filename: load_static.php
