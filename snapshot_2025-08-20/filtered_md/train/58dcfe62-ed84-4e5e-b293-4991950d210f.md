# Threat Report: 2017-03-30: OSINT - Carbon Paper: Peering into Turlaâ€™s second stage backdoor


## Key Intelligence
* Date: 2017-03-30
* Threat Level: 3 (Low)
* Tags: misp-galaxy:tool="Turla", tlp:white

---

## Indicators of Compromise (IOCs)
### Artifacts dropped
* yara: rule carbon_metadata
{
condition:
(pe.version_info[â€œInternalNameâ€] contains â€œSERVICE.EXEâ€ or
pe.version_info[â€œInternalNameâ€] contains â€œMSIMGHLP.DLLâ€ or
pe.version_info[â€œInternalNameâ€] contains â€œMSXIML.DLLâ€)
and pe.version_info[â€œCompanyNameâ€] contains â€œMicrosoft Corporationâ€
}
* yara: rule generic_carbon
{
strings:
$s1 = â€œModStartâ€
$s2 = â€œModuleStartâ€
$t1 = â€œSTOP|OKâ€
$t2 = â€œSTOP|KILLâ€
condition:
(uint16(0) == 0x5a4d) and (1 of ($s*)) and (1 of ($t*))
}
* yara: import "pe"
import "hash"

rule generic_carbon
{
strings:
$s1 = â€œModStartâ€
$s2 = â€œSTOP|OKâ€
$s3 = â€œSTOP|KILLâ€
condition:
(uint16(0) == 0x5a4d) and all of them
}

rule carbon_metadata
{
condition:
(pe.version_info[â€œInternalNameâ€] contains â€œSERVICE.EXEâ€ or
pe.version_info[â€œInternalNameâ€] contains â€œMSIMGHLP.DLLâ€ or
pe.version_info[â€œInternalNameâ€] contains â€œMSXIML.DLLâ€)
and pe.version_info[â€œCompanyNameâ€] contains â€œMicrosoft Corporationâ€
and not (tags contains â€œsignedâ€)
}

rule carbon_2016_filenames
{
condition:
file_name contains â€œwkstrend.xmlâ€ or
file_name contains â€œcifrado.xmlâ€ or
file_name contains â€œfsbootfail.datâ€ or
file_name contains â€œencodebase.infâ€ or
file_name contains â€œzcerterror.pngâ€ or
file_name contains â€œmkfieldsec.dllâ€
}

### External analysis
* link: https://www.welivesecurity.com/2017/03/30/carbon-paper-peering-turlas-second-stage-backdoor/
* text: The Turla espionage group has been targeting various institutions for many years. Recently, we found several new versions of Carbon, a second stage backdoor in the Turla group arsenal. Last year, a technical analysis of this component was made by Swiss GovCERT.ch as part of their report detailing the attack that a defense firm owned by the Swiss government, RUAG, suffered in the past.

This blog post highlights the technical innovations that we found in the latest versions of Carbon we have discovered.

Looking at the different versions numbers of Carbon we have, it is clear that it is still under active development. Through the internal versions embedded in the code, we see the new versions are pushed out regularly. The group is also known to change its tools once they are exposed. As such, we have seen that between two major versions, mutexes and file names are being changed.
* link: https://www.virustotal.com/file/af0e455f640b621c50d5c11efc3c8649691a9a661fa1bcf658aae48c007ff3c4/analysis/1459899966/ — Carbon sample - Xchecked via VT: 56b5627debb93790fdbcc9ecbffc3260adeafbab
* link: https://www.virustotal.com/file/050685f211158109fb1b17096b3739750e74049fe9057ad3503d96174b42891a/analysis/1487311234/ — Carbon sample - Xchecked via VT: 777e2695ae408e1578a16991373144333732c3f6
* link: https://www.virustotal.com/file/2dc0f9e08bde378e8fe4e408b1b5f4bbbeacb251901009f25189a5a41a53ab47/analysis/1460698324/ — Carbon sample - Xchecked via VT: bcf52240cc7940185ce424224d39564257610340
* link: https://www.virustotal.com/file/995d2b3924d5f517a795c0acc392e3d47f07787f58c77bb42ac2248393533f16/analysis/1460698430/ — Carbon sample - Xchecked via VT: 744b43d8c0fe8b217acf0494ad992df6d5191ed9
* link: https://www.virustotal.com/file/c3b85bc12c84b8d050e2b9f682df06d93ceaeb4a18480227358baa99f4989e47/analysis/1460104267/ — Carbon sample - Xchecked via VT: 851e538357598ed96f0123b47694e25c2d52552b
* link: https://www.virustotal.com/file/d581b95b43c16407305f5d52631f044936b354ed921cb2efe8dfc9257960d2db/analysis/1463398122/ — Carbon sample - Xchecked via VT: 1b233af41106d7915f6fa6fd1448b7f070b47eb3
* link: https://www.virustotal.com/file/7a68a6357868f19f698dacd12dea49655f9651fb01e2de4042e8bbc97095c121/analysis/1490735057/ — Carbon sample - Xchecked via VT: 87d718f2d6e46c53490c6a22de399c13f05336f0
* link: https://www.virustotal.com/file/9184be433426f5c9fe8ce27e8df89d7849c6af61779a3835c89ad46815abe839/analysis/1463724060/ — Carbon sample - Xchecked via VT: 2227fd6fc9d669a9b66c59593533750477669557
* link: https://www.virustotal.com/file/d1ad698567b04ea5ce8197c0316444ad8ee0350b46e0414f53f54c278b393a19/analysis/1487239958/ — Carbon sample - Xchecked via VT: 554f59c1578f4ee77dbba6a23507401359a59f23
* link: https://www.virustotal.com/file/e82d4b6d037568a4602e70f099005572b587c220793afd8f90c13cb7bbde61ed/analysis/1487240002/ — Carbon sample - Xchecked via VT: fbc43636e3c9378162f3b9712cb6d87bd48ddbd3
* link: https://www.virustotal.com/file/c58d57f5ce9ca7689e6b71d3dcb48b2caf41a9e7105bb68bae113218869dd6a0/analysis/1472552183/ — Carbon sample - Xchecked via VT: 311f399c299741e80db8bec65bbf4b56109eedaf
* link: https://www.virustotal.com/file/1311759943aabfe55ef2d42677432f14ed8fb549619473e5fb56f8a92d2daf72/analysis/1472508860/ — Carbon sample - Xchecked via VT: 2f7e335e092e04f3f4734b60c5345003d10aa15d
* link: https://www.virustotal.com/file/31b176b9906211c14ee5b9cff4c56f71866ec47d7f7c783aeb31692168d66566/analysis/1487311644/ — Carbon sample - Xchecked via VT: 1dbfcb9005abb2c83ffa6a3127257a009612798c
* link: https://www.virustotal.com/file/ba9a87ba0ad1a4f4e81583a1449b20bf703cdbee6b1a639c13f4cbcd1b9eb57f/analysis/1482320204/ — Carbon sample - Xchecked via VT: 20393222d4eb1ba72a6536f7e67e139aadfa47fe
* link: https://www.virustotal.com/file/8d20dd4433821eaeb1b2bec5911ba3633e656ca56ae50b75d35b2d52ea55b2cb/analysis/1472540442/ — Carbon sample - Xchecked via VT: 7ce746bb988cb3b7e64f08174bdb02938555ea53
* link: https://www.virustotal.com/file/ffb0e35cfab750c8532f7d49deb8a71284fa420660710b8be632dacdd0a5cf45/analysis/1472563917/ — Carbon sample - Xchecked via VT: 7c43f5df784bf50423620d8f1c96e43d8d9a9b28
* link: https://www.virustotal.com/file/1a488c6824bd39f3568346b2aaf3f6666f41b1d4961a2d77360c7c65c7978b5e/analysis/1484282511/ — Carbon sample - Xchecked via VT: a28164de29e51f154be12d163ce5818fceb69233
* link: https://www.virustotal.com/file/02f9501cb01b375e752a9cc4aa5ee084a504944bdc853e1bdfc860dd76e0d198/analysis/1487306753/ — Carbon sample - Xchecked via VT: 1ad46547e3dc264f940bf62df455b26e65b0101f
* link: https://www.virustotal.com/file/3b8bd0a0c6069f2d27d759340721b78fd289f92e0a13965262fea4e8907af122/analysis/1490734934/ — Carbon sample - Xchecked via VT: cbde204e7641830017bb84b89223131b2126bc46
* link: https://www.virustotal.com/file/0b90db3a69aa8cfab36a66cd5390f46c32e3d88d8fcaefce8cd9e00700e10b65/analysis/1485875623/ — Carbon sample - Xchecked via VT: 4636dccac5acf1d95a474747bb7bcd9b1a506cc3
* link: https://www.virustotal.com/file/7fa4482bfbca550ce296d8e791b1091d60d733ea8042167fd0eb853530584452/analysis/1486030116/ — Carbon sample - Xchecked via VT: a08b8371ead1919500a4759c2f46553620d5a9d9
* link: https://www.virustotal.com/file/aaa2afe68852cb76bccf7dbb0b541a5d62b7f0b15e47f0a24e63f68f50af167c/analysis/1487398090/ — Carbon sample - Xchecked via VT: 7f3a60613a3bdb5f1f8616e6ca469d3b78b1b45b

### Network activity
* url: http://soheylistore.ir:80:/modules/mod_feed/feed.php — C&C server addresses (hacked websites used as 1st level of proxies
* url: http://tazohor.com:80:/wp-includes/feed-rss-comments.php — C&C server addresses (hacked websites used as 1st level of proxies
* url: http://jucheafrica.com:80:/wp-includes/class-wp-edit.php — C&C server addresses (hacked websites used as 1st level of proxies
* url: http://61paris.fr:80:/wp-includes/ms-set.php — C&C server addresses (hacked websites used as 1st level of proxies
* url: http://doctorshand.org:80:/wp-content/about/ — C&C server addresses (hacked websites used as 1st level of proxies
* url: http://www.lasac.eu:80:/credit_payment/url/ — C&C server addresses (hacked websites used as 1st level of proxies

### Payload delivery
* sha1: <sha1> — Carbon sample
* sha1: <sha1> — Carbon sample
* sha1: <sha1> — Carbon sample
* sha1: <sha1> — Carbon sample
* sha1: <sha1> — Carbon sample
* sha1: <sha1> — Carbon sample
* sha1: <sha1> — Carbon sample
* sha1: <sha1> — Carbon sample
* sha1: <sha1> — Carbon sample
* sha1: <sha1> — Carbon sample
* sha1: <sha1> — Carbon sample
* sha1: <sha1> — Carbon sample
* sha1: <sha1> — Carbon sample
* sha1: <sha1> — Carbon sample
* sha1: <sha1> — Carbon sample
* sha1: <sha1> — Carbon sample
* sha1: <sha1> — Carbon sample
* sha1: <sha1> — Carbon sample
* sha1: <sha1> — Carbon sample
* sha1: <sha1> — Carbon sample
* sha1: <sha1> — Carbon sample
* sha1: <sha1> — Carbon sample
* sha1: <sha1> — Carbon sample
* sha256: <sha256> — Carbon sample - Xchecked via VT: 56b5627debb93790fdbcc9ecbffc3260adeafbab
* md5: <md5> — Carbon sample - Xchecked via VT: 56b5627debb93790fdbcc9ecbffc3260adeafbab
* sha256: <sha256> — Carbon sample - Xchecked via VT: 777e2695ae408e1578a16991373144333732c3f6
* md5: <md5> — Carbon sample - Xchecked via VT: 777e2695ae408e1578a16991373144333732c3f6
* sha256: <sha256> — Carbon sample - Xchecked via VT: bcf52240cc7940185ce424224d39564257610340
* md5: <md5> — Carbon sample - Xchecked via VT: bcf52240cc7940185ce424224d39564257610340
* sha256: <sha256> — Carbon sample - Xchecked via VT: 744b43d8c0fe8b217acf0494ad992df6d5191ed9
* md5: <md5> — Carbon sample - Xchecked via VT: 744b43d8c0fe8b217acf0494ad992df6d5191ed9
* sha256: <sha256> — Carbon sample - Xchecked via VT: 851e538357598ed96f0123b47694e25c2d52552b
* md5: <md5> — Carbon sample - Xchecked via VT: 851e538357598ed96f0123b47694e25c2d52552b
* sha256: <sha256> — Carbon sample - Xchecked via VT: 1b233af41106d7915f6fa6fd1448b7f070b47eb3
* md5: <md5> — Carbon sample - Xchecked via VT: 1b233af41106d7915f6fa6fd1448b7f070b47eb3
* sha256: <sha256> — Carbon sample - Xchecked via VT: 87d718f2d6e46c53490c6a22de399c13f05336f0
* md5: <md5> — Carbon sample - Xchecked via VT: 87d718f2d6e46c53490c6a22de399c13f05336f0
* sha256: <sha256> — Carbon sample - Xchecked via VT: 2227fd6fc9d669a9b66c59593533750477669557
* md5: <md5> — Carbon sample - Xchecked via VT: 2227fd6fc9d669a9b66c59593533750477669557
* sha256: <sha256> — Carbon sample - Xchecked via VT: 554f59c1578f4ee77dbba6a23507401359a59f23
* md5: <md5> — Carbon sample - Xchecked via VT: 554f59c1578f4ee77dbba6a23507401359a59f23
* sha256: <sha256> — Carbon sample - Xchecked via VT: fbc43636e3c9378162f3b9712cb6d87bd48ddbd3
* md5: <md5> — Carbon sample - Xchecked via VT: fbc43636e3c9378162f3b9712cb6d87bd48ddbd3
* sha256: <sha256> — Carbon sample - Xchecked via VT: 311f399c299741e80db8bec65bbf4b56109eedaf
* md5: <md5> — Carbon sample - Xchecked via VT: 311f399c299741e80db8bec65bbf4b56109eedaf
* sha256: <sha256> — Carbon sample - Xchecked via VT: 2f7e335e092e04f3f4734b60c5345003d10aa15d
* md5: <md5> — Carbon sample - Xchecked via VT: 2f7e335e092e04f3f4734b60c5345003d10aa15d
* sha256: <sha256> — Carbon sample - Xchecked via VT: 1dbfcb9005abb2c83ffa6a3127257a009612798c
* md5: <md5> — Carbon sample - Xchecked via VT: 1dbfcb9005abb2c83ffa6a3127257a009612798c
* sha256: <sha256> — Carbon sample - Xchecked via VT: 20393222d4eb1ba72a6536f7e67e139aadfa47fe
* md5: <md5> — Carbon sample - Xchecked via VT: 20393222d4eb1ba72a6536f7e67e139aadfa47fe
* sha256: <sha256> — Carbon sample - Xchecked via VT: 7ce746bb988cb3b7e64f08174bdb02938555ea53
* md5: <md5> — Carbon sample - Xchecked via VT: 7ce746bb988cb3b7e64f08174bdb02938555ea53
* sha256: <sha256> — Carbon sample - Xchecked via VT: 7c43f5df784bf50423620d8f1c96e43d8d9a9b28
* md5: <md5> — Carbon sample - Xchecked via VT: 7c43f5df784bf50423620d8f1c96e43d8d9a9b28
* sha256: <sha256> — Carbon sample - Xchecked via VT: a28164de29e51f154be12d163ce5818fceb69233
* md5: <md5> — Carbon sample - Xchecked via VT: a28164de29e51f154be12d163ce5818fceb69233
* sha256: <sha256> — Carbon sample - Xchecked via VT: 1ad46547e3dc264f940bf62df455b26e65b0101f
* md5: <md5> — Carbon sample - Xchecked via VT: 1ad46547e3dc264f940bf62df455b26e65b0101f
* sha256: <sha256> — Carbon sample - Xchecked via VT: cbde204e7641830017bb84b89223131b2126bc46
* md5: <md5> — Carbon sample - Xchecked via VT: cbde204e7641830017bb84b89223131b2126bc46
* sha256: <sha256> — Carbon sample - Xchecked via VT: 4636dccac5acf1d95a474747bb7bcd9b1a506cc3
* md5: <md5> — Carbon sample - Xchecked via VT: 4636dccac5acf1d95a474747bb7bcd9b1a506cc3
* sha256: <sha256> — Carbon sample - Xchecked via VT: a08b8371ead1919500a4759c2f46553620d5a9d9
* md5: <md5> — Carbon sample - Xchecked via VT: a08b8371ead1919500a4759c2f46553620d5a9d9
* sha256: <sha256> — Carbon sample - Xchecked via VT: 7f3a60613a3bdb5f1f8616e6ca469d3b78b1b45b
* md5: <md5> — Carbon sample - Xchecked via VT: 7f3a60613a3bdb5f1f8616e6ca469d3b78b1b45b
