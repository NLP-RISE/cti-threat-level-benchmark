# Threat Report: 2017-09-18: OSINT - CCleanup: A Vast Number of Machines at Risk


## Key Intelligence
* Date: 2017-09-18
* Threat Level: 3 (Low)
* Tags: tlp:white

---

## Indicators of Compromise (IOCs)
### Artifacts dropped
* pdb: S:\workspace\ccleaner\branches\v5.33\bin\CCleaner\Release\CCleaner.pdb
* regkey: HKLM\SOFTWARE\Piriform\Agomo

### External analysis
* text: Supply chain attacks are a very effective way to distribute malicious software into target organizations. This is because with supply chain attacks, the attackers are relying on the trust relationship between a manufacturer or supplier and a customer. This trust relationship is then abused to attack organizations and individuals and may be performed for a number of different reasons. The Nyetya worm that was released into the wild earlier in 2017 showed just how potent these types of attacks can be. Frequently, as with Nyetya, the initial infection vector can remain elusive for quite some time. Luckily with tools like AMP the additional visibility can usually help direct attention to the initial vector. 

Talos recently observed a case where the download servers used by software vendor to distribute a legitimate software package were leveraged to deliver malware to unsuspecting victims. For a period of time, the legitimate signed version of CCleaner 5.33 being distributed by Avast also contained a multi-stage malware payload that rode on top of the installation of CCleaner. CCleaner boasted over 2 billion total downloads by November of 2016 with a growth rate of 5 million additional users per week. Given the potential damage that could be caused by a network of infected computers even a tiny fraction of this size we decided to move quickly. On September 13, 2017 Cisco Talos immediately notified Avast of our findings so that they could initiate appropriate response activities. The following sections will discuss the specific details regarding this attack.
* link: http://blog.talosintelligence.com/2017/09/avast-distributes-malware.html
* link: https://www.virustotal.com/file/36b36ee9515e0a60629d2c722b006b33e543dce1c8c2611053e0651a0bfdb2e9/analysis/1505722714/ — - Xchecked via VT: 36b36ee9515e0a60629d2c722b006b33e543dce1c8c2611053e0651a0bfdb2e9
* link: https://www.virustotal.com/file/1a4a5123d7b2c534cb3e3168f7032cf9ebf38b9a2a97226d0fdb7933cf6030ff/analysis/1505723218/ — - Xchecked via VT: 1a4a5123d7b2c534cb3e3168f7032cf9ebf38b9a2a97226d0fdb7933cf6030ff
* link: https://www.virustotal.com/file/6f7840c77f99049d788155c1351e1560b62b8ad18ad0e9adda8218b9f432f0a9/analysis/1505722818/ — - Xchecked via VT: 6f7840c77f99049d788155c1351e1560b62b8ad18ad0e9adda8218b9f432f0a9

### Network activity
* domain: ab6d54340c1a.com — DGA Domain
* domain: aba9a949bc1d.com — DGA Domain
* domain: ab2da3d400c20.com — DGA Domain
* domain: ab3520430c23.com — DGA Domain
* domain: ab1c403220c27.com — DGA Domain
* domain: ab1abad1d0c2a.com — DGA Domain
* domain: ab8cee60c2d.com — DGA Domain
* domain: ab1145b758c30.com — DGA Domain
* domain: ab890e964c34.com — DGA Domain
* domain: ab3d685a0c37.com — DGA Domain
* domain: ab70a139cc3a.com — DGA Domain
* ip-dst: 216.126.225.148

### Payload delivery
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha1: <sha1> — - Xchecked via VT: 36b36ee9515e0a60629d2c722b006b33e543dce1c8c2611053e0651a0bfdb2e9
* md5: <md5> — - Xchecked via VT: 36b36ee9515e0a60629d2c722b006b33e543dce1c8c2611053e0651a0bfdb2e9
* sha1: <sha1> — - Xchecked via VT: 1a4a5123d7b2c534cb3e3168f7032cf9ebf38b9a2a97226d0fdb7933cf6030ff
* md5: <md5> — - Xchecked via VT: 1a4a5123d7b2c534cb3e3168f7032cf9ebf38b9a2a97226d0fdb7933cf6030ff
* sha1: <sha1> — - Xchecked via VT: 6f7840c77f99049d788155c1351e1560b62b8ad18ad0e9adda8218b9f432f0a9
* md5: <md5> — - Xchecked via VT: 6f7840c77f99049d788155c1351e1560b62b8ad18ad0e9adda8218b9f432f0a9
