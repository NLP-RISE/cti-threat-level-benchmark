# Threat Report: 2016-07-28: OSINT Massive AdGholas Malvertising Campaigns Use Steganography and File Whitelisting to Hide in Plain Sight by ProofPoint


## Key Intelligence
* Date: 2016-07-28
* Threat Level: 3 (Low)
* Tags: OSINT, tlp:white

---

## Indicators of Compromise (IOCs)
### Artifacts dropped
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* yara: rule AdGholas_mem
{
 meta:
     malfamily = "AdGholas"

 strings:
      $a1 = "(3e8)!=" ascii wide
      $a2 = /href=\x22\.\x22\+[a-z]+\,mimeType\}/ ascii wide
      $a3 = /\+[a-z]+\([\x22\x27]divx[^\x22\x27]+torrent[^\x22\x27]*[\x22\x27]\.split/ ascii wide
      $a4 = "chls" nocase ascii wide
      $a5 = "saz" nocase ascii wide
      $a6 = "flac" nocase ascii wide
      $a7 = "pcap" nocase ascii wide

 condition:
      all of ($a*)
}
* yara: rule AdGholas_mem_antisec_M2
{
 meta:
     malfamily = "AdGholas"

 strings:
     $s1 = "ActiveXObject(\"Microsoft.XMLDOM\")" nocase ascii wide
     $s2 = "loadXML" nocase ascii wide fullword
     $s3 = "parseError.errorCode" nocase ascii wide
     $s4 = /res\x3a\x2f\x2f[\x27\x22]\x2b/ nocase ascii wide
     $s5 = /\x251e3\x21\s*\x3d\x3d\s*[a-zA-Z]+\x3f1\x3a0/ nocase ascii wide

 condition:
     all of ($s*)
}
* md5: <md5> — Automatically added (via 09ba8463a09bbb430987ac1cbcbb7004c3be6b9bcf72b2db2333e599cc4203eb)
* md5: <md5> — Automatically added (via 0ca994d7e06405793f8fc9b9ced5364bd0dd46119031b8b0d09f03e8bbffb85e)
* md5: <md5> — Automatically added (via 5962b458a0d3852a6974836951dc072593ecd4407b58dccad4a38eccc39dc54c)
* md5: <md5> — Automatically added (via 676ea2b87029e18edf3a1b221e5173cbc7a5dc73da9e48b09644eac65ab544f0)
* md5: <md5> — Automatically added (via a5881a71d46346224e3d23d49a0577ea898fab3ea619d0e1acc77c982787fca0)
* md5: <md5> — Automatically added (via b46408cefa56cd09faa2d994271f03fcae9aa27dee279ea2eb71e163a15c3d44)
* md5: <md5> — Automatically added (via e06b753aa98e1b8fdc7c8ee1cbd07f5d46b2bbf88ebc8d450c8f24c6e79520a4)
* md5: <md5> — Automatically added (via e7febe0cdfa798c3bb78e5ca8fd143b4721b04ff4d81cfea2b4c7b9da039fa19)
* sha1: <sha1> — Automatically added (via 09ba8463a09bbb430987ac1cbcbb7004c3be6b9bcf72b2db2333e599cc4203eb)
* sha1: <sha1> — Automatically added (via 0ca994d7e06405793f8fc9b9ced5364bd0dd46119031b8b0d09f03e8bbffb85e)
* sha1: <sha1> — Automatically added (via 5962b458a0d3852a6974836951dc072593ecd4407b58dccad4a38eccc39dc54c)
* sha1: <sha1> — Automatically added (via 676ea2b87029e18edf3a1b221e5173cbc7a5dc73da9e48b09644eac65ab544f0)
* sha1: <sha1> — Automatically added (via a5881a71d46346224e3d23d49a0577ea898fab3ea619d0e1acc77c982787fca0)
* sha1: <sha1> — Automatically added (via b46408cefa56cd09faa2d994271f03fcae9aa27dee279ea2eb71e163a15c3d44)
* sha1: <sha1> — Automatically added (via e06b753aa98e1b8fdc7c8ee1cbd07f5d46b2bbf88ebc8d450c8f24c6e79520a4)
* sha1: <sha1> — Automatically added (via e7febe0cdfa798c3bb78e5ca8fd143b4721b04ff4d81cfea2b4c7b9da039fa19)

### External analysis
* link: https://www.proofpoint.com/us/threat-insight/post/massive-adgholas-malvertising-campaigns-use-steganography-and-file-whitelisting-to-hide-in-plain-sight

### Network activity
* domain: brainram.net
* domain: cleanerzoomer.com
* domain: cruzame.com
* domain: ec-centre.com
* domain: emaxing.com
* domain: iipus.com
* domain: mamaniaca.com
* domain: merovinjo.com
* domain: moyeuvelo.com
* domain: ponteblue.com
* domain: sensecreator.com
* domain: tjprofile.net
* domain: xuwakix.com
* hostname: a.stylefinishdesign.com.au — Domain shadowing
* hostname: ads.avodirect.ca — Domain shadowing
* hostname: ads.boxerbuilding.com — Domain shadowing
* ip-dst: 162.247.14.213
* ip-dst: 179.43.147.195
* ip-dst: 179.43.147.242
* ip-dst: 192.240.97.164
* ip-dst: 193.109.69.212
* ip-dst: 5.187.5.206
* ip-dst: 50.7.124.160
* ip-dst: 50.7.124.184
* ip-dst: 50.7.124.215
* ip-dst: 50.7.143.14
* ip-dst: 50.7.143.70
* ip-dst: 95.154.199.135
* ip-dst: 95.154.199.181
* ip-dst: 95.154.199.182
* ip-dst: 95.154.199.67
* ip-dst: 95.154.199.79
* domain: allerager.click
* domain: amyrwsmur.click
* domain: biicqwfvqiec.click
* domain: cmedia.cloud
* ip-dst: 108.61.103.205
* ip-dst: 176.31.62.78
* ip-dst: 198.105.244.11
* ip-dst: 45.32.157.168
* ip-dst: 93.190.177.179
* domain: 987034569274692894.com
* domain: allkindsublidamages.ru
* domain: allenia.com
* domain: fqelkidudcwb.eu
* domain: genetyoucircuminformed.xyz
* domain: ionbudeerttsq.net
* domain: j73gdy64reff625r.cc
* domain: oghtjpo.eu
* domain: othrebso.com
* domain: andnetscapeadefective.ru
* domain: allerapo.eu
* domain: blastercast.com
* domain: enwhhdvfolsn.click
* domain: gegbghtyg.eu
* domain: heleryjoortusd.com
* domain: obesca.com
* domain: stream.gizdosales.com
* ip-dst: 112.20.178.110
* ip-dst: 192.42.116.41
* ip-dst: 212.92.127.39
* ip-dst: 45.32.154.141
* ip-dst: 45.32.245.19
* ip-dst: 46.45.169.120
* ip-dst: 46.45.169.182
* ip-dst: 87.98.254.64
* ip-dst: 91.233.116.174
* ip-dst: 94.242.254.51

### Payload delivery
* yara: rule AdGholas_mem_MIME
{
 meta:
     malfamily = "AdGholas"

 strings:
      $b1=".300000000" ascii nocase wide fullword
      $b2=".saz" ascii nocase wide fullword
      $b3=".py" ascii nocase wide fullword
      $b4=".pcap" ascii nocase wide fullword
      $b5=".chls" ascii nocase wide fullword

 condition:
      all of ($b*)
}
* yara: rule AdGholas_mem_MIME_M2
{
 meta:
     malfamily = "AdGholas"

 strings:
     $s1 = "halog" nocase ascii wide fullword
     $s2 = "pcap" nocase ascii wide fullword
     $s3 = "saz" nocase ascii wide fullword
     $s4 = "chls" nocase ascii wide fullword
     $s5 = /return[^\x3b\x7d\n]+href\s*=\s*[\x22\x27]\x2e[\x27\x22]\s*\+\s*[^\x3b\x7d\n]+\s*,\s*[^\x3b\x7d\n]+\.mimeType/ nocase ascii wide
     $s6 = /\x21==[a-zA-Z]+\x3f\x210\x3a\x211/ nocase ascii wide

 condition:
     all of ($s*)
}
