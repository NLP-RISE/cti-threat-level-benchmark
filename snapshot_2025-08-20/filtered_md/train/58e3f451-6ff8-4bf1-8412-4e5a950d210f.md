# Threat Report: 2017-04-04: OSINT - Introducing ROKRAT


## Key Intelligence
* Date: 2017-04-04
* Threat Level: 3 (Low)
* Tags: tlp:white, osint:source-type="blog-post", misp-galaxy:rat="rokrat"

---

## Indicators of Compromise (IOCs)
### External analysis
* link: http://blog.talosintelligence.com/2017/04/introducing-rokrat.html
* text: A few weeks ago, Talos published research on a Korean MalDoc. As we previously discussed this actor is quick to cover their tracks and very quickly cleaned up their compromised hosts. We believe the compromised infrastructure was live for a mere matter of hours during any campaign. We identified a new campaign, again leveraging a malicious Hangul Word Processor (HWP) document. After analyzing the final payload, we determined the winner was… a Remote Administration Tool, which we have named ROKRAT.

Like in the previous post, the campaign started with a spear phishing email containing a malicious attachment, the HWP document. One of the identified emails was sent from the email server of Yonsei, a private university in Seoul. The address used in the email was 'kgf2016@yonsei.ac.kr' which is the contact email of the Korea Global Forum where the slogan in 2016 was "Peace and Unification of the Korean Peninsula". This fact gives more credit and legitimacy to the email.

The HWP document contained an embedded Encapsulated PostScript (EPS) object. As with our previous publication this again is zlib compressed and trivial to obtain. The purpose of the EPS is to exploit a well-known vulnerability (CVE-2013-0808) to download a binary disguised as a .jpg file. This file is decoded and finally an executable is launched: ROKRAT. This RAT has the added complexity that the command and control servers are legitimate websites. The malware uses Twitter and two cloud platforms, Yandex and Mediafire, apparently for both C2 communications and exfiltration platforms. Unfortunately, these platforms are difficult to block globally within organizations as their use can be viewed as legitimate in most cases. Additionally, these 3 platforms all make use of HTTPS connectivity, making it much more difficult to identify specific patterns or the usage of specific tokens.
* link: https://www.virustotal.com/file/051463a14767c6477b6dacd639f30a8a5b9e126ff31532b58fc29c8364604d00/analysis/1491317438/ — ROKRAT PE32 - Xchecked via VT: 051463a14767c6477b6dacd639f30a8a5b9e126ff31532b58fc29c8364604d00
* link: https://www.virustotal.com/file/cd166565ce09ef410c5bba40bad0b49441af6cfb48772e7e4a9de3d646b4851c/analysis/1491235235/ — ROKRAT PE32 - Xchecked via VT: cd166565ce09ef410c5bba40bad0b49441af6cfb48772e7e4a9de3d646b4851c
* link: https://www.virustotal.com/file/5441f45df22af63498c63a49aae82065086964f9067cfa75987951831017bd4f/analysis/1491235236/ — HWP Documents - Xchecked via VT: 5441f45df22af63498c63a49aae82065086964f9067cfa75987951831017bd4f
* link: https://www.virustotal.com/file/7d163e36f47ec56c9fe08d758a0770f1778fa30af68f39aac80441a3f037761e/analysis/1491280391/ — HWP Documents - Xchecked via VT: 7d163e36f47ec56c9fe08d758a0770f1778fa30af68f39aac80441a3f037761e

### Network activity
* url: http://discgolfglow.com/wp-content/plugins/maintenance/images/worker.jpg — Malicious URL
* url: http://acddesigns.com.au/clients/ACPRCM/kingstone.jpg — Malicious URL
* url: https://www.amazon.com/Men-War-PC/dp/B001QZGVEC/EsoftTeam/watchcom.jpg — Not malicious URLs but could be use to identify RAT execution:
* url: http://www.hulu.com/watch/559035/episode3.mp4 — Not malicious URLs but could be use to identify RAT execution:

### Payload delivery
* sha256: <sha256> — HWP Documents
* sha256: <sha256> — HWP Documents
* sha256: <sha256> — ROKRAT PE32
* sha256: <sha256> — ROKRAT PE32
* text: MEDIAFIRE
Account #1
Username: ksy182824@gmail.com
Application ID: 81342
TWITTER
Account #1
Consumer key: sOPcUKjJteYrg8klXC4XUlk9l
Token: 722226174008315904-u6P1FlI7IDg8VIYe720X0gqDYcAMQAR

Account #2
Consumer key: sgpalyF1KukVKaPAePb3EGeMT
Token: 759577633630593029-CQzXMfvsQ2RztFYawUPeVbAzcSnwllX

Account #3
Consumer key: XVvauoXKfnAUm2qdR1nNEZqkN
Token: 752302142474051585-r2TH1Dk8tU5TetUyfnw9c5OgA1popTj

Account #4
Consumer key: U1AoCSLLHxfeDbtxRXVgj7y00
Token: 779546496603561984-Qm8CknTvS4nKxWOB4tJvbtBUMBfNCKE

Account #5
Consumer key: 9ndXAB6UcxhQVoBAkEKnwzt4C
Token: 777852155245080576-H0kXYcQCpV6qiFER38h3wS1tBFdROcQ

Account #6
Consumer key: QCDXTaOCPBQM4VZigrRj2CnJi
Token: 775849572124307457-4ICTjYmOfAy5MX2FxUHVdUfqeNTYYqj

Account #7
Consumer key: 2DQ8GqKhDWp55XIl77Es9oFRV
Token: 778855419785154560-0YUVZtZjKblo2gTGWKiNF67ROwS9MMq
YANDEX
Token #1: AQAAAAAYm4qtAANss-XFfX3FjU8VmVR76k4aMA0
Token #2: AQAAAAAA8uDKAANxExojbqps-UOIi8kc8EAhcq8
Token #3: AQAAAAAY9j8KAANyULDuYU1240rjvpNXcRdF5Tw
Token #4: AQAAAAAZDPB1AAN6l1Ht3ctALU1flix57TvuMa4 — TOKENS
* sha1: <sha1> — ROKRAT PE32 - Xchecked via VT: 051463a14767c6477b6dacd639f30a8a5b9e126ff31532b58fc29c8364604d00
* md5: <md5> — ROKRAT PE32 - Xchecked via VT: 051463a14767c6477b6dacd639f30a8a5b9e126ff31532b58fc29c8364604d00
* sha1: <sha1> — ROKRAT PE32 - Xchecked via VT: cd166565ce09ef410c5bba40bad0b49441af6cfb48772e7e4a9de3d646b4851c
* md5: <md5> — ROKRAT PE32 - Xchecked via VT: cd166565ce09ef410c5bba40bad0b49441af6cfb48772e7e4a9de3d646b4851c
* sha1: <sha1> — HWP Documents - Xchecked via VT: 5441f45df22af63498c63a49aae82065086964f9067cfa75987951831017bd4f
* md5: <md5> — HWP Documents - Xchecked via VT: 5441f45df22af63498c63a49aae82065086964f9067cfa75987951831017bd4f
* sha1: <sha1> — HWP Documents - Xchecked via VT: 7d163e36f47ec56c9fe08d758a0770f1778fa30af68f39aac80441a3f037761e
* md5: <md5> — HWP Documents - Xchecked via VT: 7d163e36f47ec56c9fe08d758a0770f1778fa30af68f39aac80441a3f037761e

### Social network
* email-src: ksy182824@gmail.com — MEDIAFIRE account
