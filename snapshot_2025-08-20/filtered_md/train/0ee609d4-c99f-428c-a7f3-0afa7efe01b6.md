# Threat Report: 2023-06-23: IoT devices and Linux-based systems targeted by OpenSSH trojan campaign


## Key Intelligence
* Date: 2023-06-23
* Threat Level: 1 (High)
* Tags: misp-galaxy:malpedia="reptile", tlp:white

---

## Indicators of Compromise (IOCs)
### External analysis
* link: https://www.microsoft.com/en-us/security/blog/2023/06/22/iot-devices-and-linux-based-systems-targeted-by-openssh-trojan-campaign/

### Network activity
* ip-dst: 185.161.208.234 — C2
* ip-dst: 139.180.185.24 — C2
* ip-dst: 199.247.30.230 — C2
* ip-dst: 149.28.239.146 — C2
* ip-dst: 209.250.234.77 — C2
* ip-dst: 70.34.220.100 — C2
* hostname: irc.socialfreedom.party — C2
* hostname: singapore.sg.socialfreedom.party — C2
* hostname: amsterdam.nl.socialfreedom.party — C2
* hostname: frankfurt.de.socialfreedom.party — C2
* hostname: sidney.au.socialfreedom.party — C2
* hostname: losangeles.us.socialfreedom.party — C2
* domain: mumbaitravelers.org — C2
* hostname: sh.madagent.tm — C2
* hostname: ssh.madagent.tm — C2
* hostname: dumpx.madagent.tm — C2
* hostname: reg.madagent.tm — C2
* hostname: sshm.madagent.tm — C2
* hostname: z.madagent.tm — C2
* hostname: ssho.madagent.tm — C2
* hostname: sshr.madagent.tm — C2
* hostname: sshu.madagent.tm — C2
* hostname: user.madagent.tm — C2
* domain: madagent.cc — C2
* hostname: cler.madagent.cc — C2
* hostname: dumpx.madagent.cc — C2
* hostname: mh.madagent.cc — C2
* hostname: ns1.madagent.cc — C2
* hostname: ns2.madagent.cc — C2
* hostname: ns3.madagent.cc — C2
* hostname: ns4.madagent.cc — C2
* hostname: reg.madagent.cc — C2
* hostname: ssh.madagent.cc — C2
* hostname: sshm.madagent.cc — C2
* hostname: ssho.madagent.cc — C2
* hostname: sshr.madagent.cc — C2
* hostname: sshu.madagent.cc — C2
* hostname: user.madagent.cc — C2
* hostname: www.madagent.cc — C2
* hostname: rsh.sys-stat.download — C2
* hostname: sh.sys-stat.download — C2
* hostname: sh.rawdot.net — C2
* hostname: ssho.rawdot.net — C2
* hostname: donate.xmr.rawdot.net — C2
* hostname: pool.rawdot.net — C2
* hostname: 2018.rawdot.net — C2
* hostname: blog.rawdot.net — C2
* hostname: clients.rawdot.net — C2
* hostname: ftp.rawdot.net — C2
* hostname: psql01.rawdot.net — C2
* hostname: www.rawdot.net — C2
* hostname: sh.0xbadc0de.stream — C2
* hostname: ss.0xbadc0de.stream — C2

### Other
* comment: The threat actors initiate the attack by attempting to brute force various credentials on misconfigured internet-facing Linux devices. Upon compromising a target device, they disable shell history and retrieve a compromised OpenSSH archive named openssh-8.0p1.tgz from a remote server. The archive contains benign OpenSSH source code alongside several malicious files: the shell script inst.sh, backdoor binaries for multiple architectures (x86-64, arm4l, arm5l, i568, and i686), and an archive containing the shell script vars.sh, which holds embedded files for the backdoor’s operation.
* comment: Once running on a device, the shell script backdoor tests access to /proc to determine whether the device is a honeypot. If it can’t access /proc, it determines the device is a honeypot and exits. Otherwise, it exfiltrates information about the device, including its operating system version, network configuration, and the contents of /etc/passwd and /etc/shadow over email to the hardcoded address dotsysadmin[@]protonmail[.]com, and to any email address provided by the threat actor as an argument to the script.
* comment: On supported systems, the backdoor downloads, compiles, and installs two open-source rootkits available on GitHub, Diamorphine and Reptile. The backdoor configures Reptile to connect to the C2 domain rsh.sys-stat[.]download on port 4444 and to hide its child processes, files, or their content. Microsoft researchers assess that the Diamorphine rootkit is used to hide processes as well.

### Payload delivery
* email-src: asterzeu@yahoo.com
* email-src: dotsysadmin@protonmail.com
* sha256: <sha256> — Script to launch ZiggyStarTux
* sha256: <sha256> — ZiggyStarTux
* sha256: <sha256> — ZiggyStarTux
* sha256: <sha256> — ZiggyStarTux
* sha256: <sha256> — ZiggyStarTux
* sha256: <sha256> — ZiggyStarTux
* sha256: <sha256> — Malicious OpenSSH
* sha256: <sha256> — Malicious OpenSSH
* sha256: <sha256> — Malicious OpenSSH
* sha256: <sha256> — Malicious OpenSSH
* sha256: <sha256> — Malicious OpenSSH
* sha256: <sha256> — Malicious OpenSSH
* sha256: <sha256> — Malicious OpenSSH
* sha256: <sha256> — Backdoor
* sha256: <sha256> — Backdoor
* sha256: <sha256> — Backdoor
* sha256: <sha256> — Backdoor
* sha256: <sha256> — Backdoor
* sha256: <sha256> — Backdoor
* sha256: <sha256> — Backdoor
* sha256: <sha256> — Backdoor
* sha256: <sha256> — Backdoor
* sha256: <sha256> — Backdoor
* sha256: <sha256> — Backdoor
* sha256: <sha256> — Backdoor
* sha256: <sha256> — Backdoor
* sha256: <sha256> — Backdoor
* sha256: <sha256> — vars.sh archive
* sha256: <sha256> — vars.sh archive
* sha256: <sha256> — vars.sh archive
* sha256: <sha256> — Decode utility used by the backdoor
* sha256: <sha256> — ss.patch
* sha256: <sha256> — inst.sh
* sha256: <sha256> — hive-start.tgz
* sha256: <sha256> — lssh.tgz
* sha256: <sha256> — File from lssh.tgz
* sha256: <sha256> — File from lssh.tgz
* sha256: <sha256> — File from lssh.tgz
* sha256: <sha256> — File from lssh.tgz
* sha256: <sha256> — File from lssh.tgz
