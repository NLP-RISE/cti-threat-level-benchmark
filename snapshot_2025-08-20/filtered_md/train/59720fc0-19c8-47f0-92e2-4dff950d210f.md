# Threat Report: 2017-07-21: OSINT - Rurktar - Spyware under Construction


## Key Intelligence
* Date: 2017-07-21
* Threat Level: 3 (Low)
* Tags: tlp:white

---

## Indicators of Compromise (IOCs)
### Artifacts dropped
* yara: rule Rurktar
{
meta:
author = "Nathan Stern"
description = "Rurktar detection rule"
strings:
 $a = "FriendlyID" wide ascii nocase
 $a2 = "CaptureMode" wide ascii nocase
 $a3 = "CaptureStart" wide ascii nocase
 $a4 = "CaptureMonikerString" wide ascii nocase
 $a5 = "ACaptureMonikerString" wide ascii nocase
 $a6 = "VideoCap" wide ascii nocase
 $a7 = "SkipFrames" wide ascii nocase
 $a8 = "SkipDetectionFrames" wide ascii nocase
 $a9 = "SkipTakeFrames" wide ascii nocase
 $a10 = "DetectionPreBuffer" wide ascii nocase
 $a11 = "MaxCaptureFrames" wide ascii nocase
 $a12 = "MaxCaptureFolderSize" wide ascii nocase
 $a13 = "NetworkImageQ" wide ascii nocase
 $a14 = "CaptureDirectory" wide ascii nocase
 $a15 = "DefPass" wide ascii nocase
 $a16 = "CaptureStopProcess1" wide ascii nocase
 $a17 = "CaptureStopProcess2" wide ascii nocase
$a18 = "DetectPorog" wide ascii nocase
 $a19 = "WatchFiles" wide ascii nocase
 $a20 = "AutoSendPreviews" wide ascii nocase
 $a21 = "ControlExt" wide ascii nocase
 $a22 = "SendOriginPreviews" wide ascii nocase
 $a23 = "CopyOriginsToCaptureDir" wide ascii nocase
 $a24 = "WatchProc" wide ascii nocase
 $a25 = "ScreenshotExt" wide ascii nocase
 $a26 = "ScreenshotAutoCapture" wide ascii nocase
 $a27 = "ScreenshotAutoStartProcess" wide ascii nocase
 $a28 = "ScreenshotPause" wide ascii nocase
 $a29 = "ProxyEnabled" wide ascii nocase
 $b = "\\R_C_S.ini" wide ascii nocase
 $b2 = "\\RCS.ini" wide ascii nocase
 $b3 = "RCS.log" wide ascii nocase
 $b4 = "RCSU.exe" wide ascii nocase
 $b5 = "RCS.log" wide ascii nocase
 $c = "?share*" wide ascii nocase
 $c2 = "?find*" wide ascii nocase
 $c3 = "user?" wide ascii nocase
 $c4 = "?prefs*" wide ascii nocase
 $c5 = "?type*abstract" wide ascii nocase
 $c6 = "?FriendlyID*" wide ascii nocase
 $c7 = "?disc*" wide ascii nocase
condition:
5 of ($a*) or
3 of ($b*) or
 4 of ($c*)
}

### External analysis
* link: https://www.gdatasoftware.com/blog/2017/07/29896-rurktar-spyware-under-construction
* text: Researchers at G DATA - have examined a new spyware which still seems to be in a development stage. But what is it about and what are its objectives?
The development of any kind of software takes time. Not every function that is planned for the final product is implemented right from the start. It does not come as a surprise that this is also true for the development of malware. At the G DATA Security Labs, a file has sparked the interest of our researchers - this file is interesting for a number of reasons.

Who commissioned it?
The new espionage tool which was was christened "Rurktar" allows some conclusions as to its origin. It is very likely that it originates from Russia. There is quite some evidence to support this: some of the internal error messages of Rurktar are in Russian. Also, the IP addresses used for remote control of the spyware are located in Russia.

It is not 100 per cent clear whether Rurktar is the work of a single individual or a development team. What we can say, though, is that a Dropbox folder is used as a working directory. There are several possible reasons for this. One of them is that several developers are cooperating here and consolidate their work through a Dropbox. What Dropbox can also be used for by a single individual is a crude and very basic versioning system - some Dropbox accounts offer the possibility of restoring earlier versions of a file. Therefore, it can be used to track changes, but it is not ideal from a developer's stand point. Using Dropbox as a backup is, of course, also a possibility to be considered here.
* link: https://file.gdatasoftware.com/web/en/documents/whitepaper/Rurktar.pdf
* link: https://www.virustotal.com/file/618908e3d368301a323ee8ae7df867db8d7f5a98b513cfb8c961fb945e62a9b6/analysis/1489348132/ — MSIL.Backdoor.Rurktar.A - Xchecked via VT: 618908e3d368301a323ee8ae7df867db8d7f5a98b513cfb8c961fb945e62a9b6
* link: https://www.virustotal.com/file/89110710eddd0da23ea206a6047c252bf1e16a2d1957729973d77a58219e614b/analysis/1489377772/ — MSIL.Backdoor.Rurktar.A - Xchecked via VT: 89110710eddd0da23ea206a6047c252bf1e16a2d1957729973d77a58219e614b
* link: https://www.virustotal.com/file/54f25a6820b8a0e3fc26bdf4599e7db695ef7aefb7dcefaa2c2581bb58426a40/analysis/1497208372/ — MSIL.Backdoor.Rurktar.A - Xchecked via VT: 54f25a6820b8a0e3fc26bdf4599e7db695ef7aefb7dcefaa2c2581bb58426a40
* link: https://www.virustotal.com/file/b4b75bda475ea58f2a5cf3329e311a70fa56745ba6cb2785523fa53139d4e37f/analysis/1496056079/ — MSIL.Backdoor.Rurktar.A - Xchecked via VT: b4b75bda475ea58f2a5cf3329e311a70fa56745ba6cb2785523fa53139d4e37f

### Payload delivery
* sha256: <sha256> — MSIL.Backdoor.Rurktar.A
* sha256: <sha256> — MSIL.Backdoor.Rurktar.A
* sha256: <sha256> — MSIL.Backdoor.Rurktar.A
* sha256: <sha256> — MSIL.Backdoor.Rurktar.A
* sha1: <sha1> — MSIL.Backdoor.Rurktar.A - Xchecked via VT: 618908e3d368301a323ee8ae7df867db8d7f5a98b513cfb8c961fb945e62a9b6
* md5: <md5> — MSIL.Backdoor.Rurktar.A - Xchecked via VT: 618908e3d368301a323ee8ae7df867db8d7f5a98b513cfb8c961fb945e62a9b6
* sha1: <sha1> — MSIL.Backdoor.Rurktar.A - Xchecked via VT: 89110710eddd0da23ea206a6047c252bf1e16a2d1957729973d77a58219e614b
* md5: <md5> — MSIL.Backdoor.Rurktar.A - Xchecked via VT: 89110710eddd0da23ea206a6047c252bf1e16a2d1957729973d77a58219e614b
* sha1: <sha1> — MSIL.Backdoor.Rurktar.A - Xchecked via VT: 54f25a6820b8a0e3fc26bdf4599e7db695ef7aefb7dcefaa2c2581bb58426a40
* md5: <md5> — MSIL.Backdoor.Rurktar.A - Xchecked via VT: 54f25a6820b8a0e3fc26bdf4599e7db695ef7aefb7dcefaa2c2581bb58426a40
* sha1: <sha1> — MSIL.Backdoor.Rurktar.A - Xchecked via VT: b4b75bda475ea58f2a5cf3329e311a70fa56745ba6cb2785523fa53139d4e37f
* md5: <md5> — MSIL.Backdoor.Rurktar.A - Xchecked via VT: b4b75bda475ea58f2a5cf3329e311a70fa56745ba6cb2785523fa53139d4e37f
