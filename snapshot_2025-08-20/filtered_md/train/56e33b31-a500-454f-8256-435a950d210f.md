# Threat Report: 2016-03-11: OSINT - PowerSniff Malware Used in Macro-based Attacks


## Key Intelligence
* Date: 2016-03-11
* Threat Level: 2 (Medium)
* Tags: tlp:white, type:OSINT

---

## Indicators of Compromise (IOCs)
### External analysis
* link: http://researchcenter.paloaltonetworks.com/2016/03/powersniff-malware-used-in-macro-based-attacks/
* comment: The concept of file-less malware is not a new one. Families like Poweliks, which abuse Microsoftâ€™s PowerShell, have emerged in recent years and have garnered extensive attention due to their ability to compromise a system while leaving little or no trace of their presence to traditional forensic techniques.
System administrators have lauded the power and versatility of PowerShell since version 2.0â€™s integration into Windows 7. Unfortunately, with such versatility comes the opportunity for abuse, specifically surrounding the capability to write directly into memory of the host OS.
Typically, file-less malware has been observed in the context of Exploit Kits such as Angler. Palo Alto Networks has observed a recent high-threat spam campaign that is serving malicious macro documents used to execute PowerShell scripts which injects malware similar to the Ursnif family directly into memory. We call the malware PowerSniff.
* link: https://www.virustotal.com/file/5d215ef3affe320efe4f5034513697675de40ba8878ca82e80b07ad1b8d61ed8/analysis/1457561699/
* link: https://www.virustotal.com/file/136379754edd05c20d5162aed7e10774a95657f69d4f9a5de17a8059c9018aa6/analysis/1457567038/
* link: https://www.virustotal.com/file/708374a4dfaaa8e44ee217ca5946511cacec55da5eabb0feb1df321753258782/analysis/1457605003/
* link: https://www.virustotal.com/file/247511ab6d7d3820b9d345bb899a7827ce62c9dd27c538c75a73f5beba6c6018/analysis/1457720794/
* link: https://www.virustotal.com/file/2c21dafcb4f50cae47d0d4314810226cba3ee4e61811f5c778353c8eac9ba7dc/analysis/1457724250/
* link: https://www.virustotal.com/file/90a7951683a5a77a21d4a544b76e2e6ee04e357d2f5bfcff01cd6924906adf77/analysis/1457729711/
* link: https://www.virustotal.com/file/74ec24b5d08266d86c59718a4a476cfa5d220b7b3c8cc594d4b9efc03e8bee0d/analysis/1457619249/
* link: https://www.virustotal.com/file/83e305724e9cd020b8f80535c5dd897b2057cee7d2bb48461614a37941e78e3a/analysis/1457715410/
* link: https://www.virustotal.com/file/a1770a7671679f13601e75a7cb841fea90c7add78436a0bea875ce50b92afc33/analysis/1457719230/
* link: https://www.virustotal.com/file/815bd46e66f1d330ed49c6f4a4e570da2ec89bcd665cedf025028a94d7b0cc1e/analysis/1457721069/
* link: https://www.virustotal.com/file/340f82a198aa510159989058f3f62861de74135666c50060491144b7b3ec5a6f/analysis/1457728626/
* link: https://www.virustotal.com/file/1e746ba37c56f7f2422e6e01aa6fde6f019214a1e12475fe54ee5c2cf1b9f083/analysis/1457729262/
* link: https://www.virustotal.com/file/f45bf212c43d1d30cc00f64b3dcae5c35d4a85cacd9350646f7918a30af1b709/analysis/1457708110/
* link: https://www.virustotal.com/file/7e22ea4e06b8fd6698d224ce04b3ef5f00838543cb96fb234e4a8c84bb5fa7b3/analysis/1457711295/
* link: https://www.virustotal.com/file/f204c10af7cdcc0b57e77b2e521b4b0ac04667ccffce478cb4c3b8b8f18e32a2/analysis/1457725859/
* link: https://www.virustotal.com/file/0661c68e6c247cd6f638dbcac7914c826a5feee1013e456af2f1f6fd642f4147/analysis/1457721291/
* link: https://www.virustotal.com/file/30cd5d32bc3c046cfc584cb8521f5589c4d86a4241d1a9ae6c8e9172aa58ac73/analysis/1457730528/
* link: https://www.virustotal.com/file/a8663becc17e34f85d828f53029ab110f92f635c3dfd94132e5ac87e2f0cdfc3/analysis/1457725715/

### Network activity
* domain: supratimewest.com — C&C
* domain: letterinklandoix.net — C&C
* domain: supratimewest.biz — C&C
* domain: starwoodhotels.pw — C&C
* domain: oklinjgreirestacks.biz — C&C
* hostname: www.starwoodhotels.pw — C&C
* domain: brookmensoklinherz.org — C&C

### Payload installation
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha256: <sha256>
* sha1: <sha1> — - Xchecked via VT: 5d215ef3affe320efe4f5034513697675de40ba8878ca82e80b07ad1b8d61ed8
* md5: <md5> — - Xchecked via VT: 5d215ef3affe320efe4f5034513697675de40ba8878ca82e80b07ad1b8d61ed8
* sha1: <sha1> — - Xchecked via VT: 136379754edd05c20d5162aed7e10774a95657f69d4f9a5de17a8059c9018aa6
* md5: <md5> — - Xchecked via VT: 136379754edd05c20d5162aed7e10774a95657f69d4f9a5de17a8059c9018aa6
* sha1: <sha1> — - Xchecked via VT: 708374a4dfaaa8e44ee217ca5946511cacec55da5eabb0feb1df321753258782
* md5: <md5> — - Xchecked via VT: 708374a4dfaaa8e44ee217ca5946511cacec55da5eabb0feb1df321753258782
* sha1: <sha1> — - Xchecked via VT: 247511ab6d7d3820b9d345bb899a7827ce62c9dd27c538c75a73f5beba6c6018
* md5: <md5> — - Xchecked via VT: 247511ab6d7d3820b9d345bb899a7827ce62c9dd27c538c75a73f5beba6c6018
* sha1: <sha1> — - Xchecked via VT: 2c21dafcb4f50cae47d0d4314810226cba3ee4e61811f5c778353c8eac9ba7dc
* md5: <md5> — - Xchecked via VT: 2c21dafcb4f50cae47d0d4314810226cba3ee4e61811f5c778353c8eac9ba7dc
* sha1: <sha1> — - Xchecked via VT: 90a7951683a5a77a21d4a544b76e2e6ee04e357d2f5bfcff01cd6924906adf77
* md5: <md5> — - Xchecked via VT: 90a7951683a5a77a21d4a544b76e2e6ee04e357d2f5bfcff01cd6924906adf77
* sha1: <sha1> — - Xchecked via VT: 74ec24b5d08266d86c59718a4a476cfa5d220b7b3c8cc594d4b9efc03e8bee0d
* md5: <md5> — - Xchecked via VT: 74ec24b5d08266d86c59718a4a476cfa5d220b7b3c8cc594d4b9efc03e8bee0d
* sha1: <sha1> — - Xchecked via VT: 83e305724e9cd020b8f80535c5dd897b2057cee7d2bb48461614a37941e78e3a
* md5: <md5> — - Xchecked via VT: 83e305724e9cd020b8f80535c5dd897b2057cee7d2bb48461614a37941e78e3a
* sha1: <sha1> — - Xchecked via VT: a1770a7671679f13601e75a7cb841fea90c7add78436a0bea875ce50b92afc33
* md5: <md5> — - Xchecked via VT: a1770a7671679f13601e75a7cb841fea90c7add78436a0bea875ce50b92afc33
* sha1: <sha1> — - Xchecked via VT: 815bd46e66f1d330ed49c6f4a4e570da2ec89bcd665cedf025028a94d7b0cc1e
* md5: <md5> — - Xchecked via VT: 815bd46e66f1d330ed49c6f4a4e570da2ec89bcd665cedf025028a94d7b0cc1e
* sha1: <sha1> — - Xchecked via VT: 340f82a198aa510159989058f3f62861de74135666c50060491144b7b3ec5a6f
* md5: <md5> — - Xchecked via VT: 340f82a198aa510159989058f3f62861de74135666c50060491144b7b3ec5a6f
* sha1: <sha1> — - Xchecked via VT: 1e746ba37c56f7f2422e6e01aa6fde6f019214a1e12475fe54ee5c2cf1b9f083
* md5: <md5> — - Xchecked via VT: 1e746ba37c56f7f2422e6e01aa6fde6f019214a1e12475fe54ee5c2cf1b9f083
* sha1: <sha1> — - Xchecked via VT: f45bf212c43d1d30cc00f64b3dcae5c35d4a85cacd9350646f7918a30af1b709
* md5: <md5> — - Xchecked via VT: f45bf212c43d1d30cc00f64b3dcae5c35d4a85cacd9350646f7918a30af1b709
* sha1: <sha1> — - Xchecked via VT: 7e22ea4e06b8fd6698d224ce04b3ef5f00838543cb96fb234e4a8c84bb5fa7b3
* md5: <md5> — - Xchecked via VT: 7e22ea4e06b8fd6698d224ce04b3ef5f00838543cb96fb234e4a8c84bb5fa7b3
* sha1: <sha1> — - Xchecked via VT: f204c10af7cdcc0b57e77b2e521b4b0ac04667ccffce478cb4c3b8b8f18e32a2
* md5: <md5> — - Xchecked via VT: f204c10af7cdcc0b57e77b2e521b4b0ac04667ccffce478cb4c3b8b8f18e32a2
* sha1: <sha1> — - Xchecked via VT: 0661c68e6c247cd6f638dbcac7914c826a5feee1013e456af2f1f6fd642f4147
* md5: <md5> — - Xchecked via VT: 0661c68e6c247cd6f638dbcac7914c826a5feee1013e456af2f1f6fd642f4147
* sha1: <sha1> — - Xchecked via VT: 30cd5d32bc3c046cfc584cb8521f5589c4d86a4241d1a9ae6c8e9172aa58ac73
* md5: <md5> — - Xchecked via VT: 30cd5d32bc3c046cfc584cb8521f5589c4d86a4241d1a9ae6c8e9172aa58ac73
* sha1: <sha1> — - Xchecked via VT: a8663becc17e34f85d828f53029ab110f92f635c3dfd94132e5ac87e2f0cdfc3
* md5: <md5> — - Xchecked via VT: a8663becc17e34f85d828f53029ab110f92f635c3dfd94132e5ac87e2f0cdfc3
