# Threat Report: 2024-07-15: MuddyWater replaces Atera by custom MuddyRot implant in a recent campaign


## Key Intelligence
* Date: 2024-07-15
* Threat Level: 2 (Medium)
* Tags: misp-galaxy:groups="MuddyWater", misp-galaxy:microsoft-activity-group="Mango Sandstorm", misp-galaxy:mitre-intrusion-set="MuddyWater - G0069", tlp:white, misp-galaxy:mitre-attack-pattern="Spearphishing Attachment - T1598.002"

---

## Indicators of Compromise (IOCs)
### Artifacts dropped
* mutex: DocumentUpdater

### External analysis
* link: https://blog.sekoia.io/muddywater-replaces-atera-by-custom-muddyrot-implant-in-a-recent-campaign/

### Network activity
* ip-dst: 91.235.234.202
* ip-dst: 146.19.143.14

### Payload delivery
* filename: documentsmanagerreporter.exe
* sha256: <sha256> — MuddyRot related codes
* sha256: <sha256> — MuddyRot related codes
* sha256: <sha256> — MuddyRot related codes
* sha256: <sha256> — MuddyRot related codes

### Payload installation
* yara: rule apt_MuddyWater_MuddyRot_strings {
  meta:
        id = "f7bc195a-0e60-4495-b78a-78f101543700"
        version = "1.0"
        malware = "MuddyRot"
        intrusion_set = "MuddyWater"
        description = "Detects RotRot backdoor based on strings permutations"
        source = "Sekoia.io"
        creation_date = "2024-06-10"
        classification = "TLP:WHITE"
  strings:
    $s1 = "qsphsbnebub"
    $s2 = "rtqitcofcvc"
    $s3 = "surjudpgdwd"
    $s4 = "tvskveqhexe"
    $s5 = "uwtlwfrifyf"
    $s6 = "vxumxgsjgzg"

    $t1 = "MpbeMjcsbs"
    $t2 = "NqcfNkdtct"
    $t3 = "OrdgOleudu"
    $t4 = "PsehPmfvev"
    $t5 = "QtfiQngwfw"
    $t6 = "RugjRohxgx"

    $u1 = "UfsnjobufKpcPckfdu"
    $u2 = "VgtokpcvgLqdQdlgev"
    $u3 = "WhuplqdwhMreRemhfw"
    $u4 = "XivqmrexiNsfSfnigx"
    $u5 = "YjwrnsfyjOtgTgojhy"
    $u6 = "ZkxsotgzkPuhUhpkiz"

  condition:
    uint16be(0) == 0x4d5a and
    filesize > 100KB and filesize < 300KB and
    any of ($s*) and any of ($t*) and any of ($u*)
}
* yara: rule apt_MuddyWater_malicious_pdf {
    meta:
        id = "77983aea-47cb-4436-b773-faf7be430339"
        version = "1.0"
        intrusion_set = "MuddyWater"
        description = "Detects malicious PDF used by MuddyWater"
        source = "Sekoia.io"
        creation_date = "2024-06-10"
        classification = "TLP:WHITE"
    strings:
        $ = "egnyte.com/fl/"
        $ = "/Type/Pages/Count 1"
    condition:
        uint32be(0) == 0x25504446 and
        filesize < 300KB and
        all of them
}
