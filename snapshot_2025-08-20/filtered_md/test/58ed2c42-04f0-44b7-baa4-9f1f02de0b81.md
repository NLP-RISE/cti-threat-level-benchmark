# Threat Report: 2017-04-11: OSINT - CVE-2017-0199: In the Wild Attacks Leveraging HTA Handler


## Key Intelligence
* Date: 2017-04-11
* Threat Level: 3 (Low)
* Tags: tlp:white, osint:source-type="blog-post"

---

## Indicators of Compromise (IOCs)
### External analysis
* text: FireEye recently detected malicious Microsoft Office RTF documents that leverage CVE-2017-0199, a previously undisclosed vulnerability. This vulnerability allows a malicious actor to download and execute a Visual Basic script containing PowerShell commands when a user opens a document containing an embedded exploit. FireEye has observed Office documents exploiting CVE-2017-0199 that download and execute malware payloads from different well-known malware families.

FireEye shared the details of the vulnerability with Microsoft and has been coordinating public disclosure timed with the release of a patch by Microsoft to address the vulnerability, which can be found here.

The vulnerability bypassed most mitigations prior to patch availability; however, FireEye email and network products detected the malicious documents. FireEye recommends that Microsoft Office users apply the patch from Microsoft.
* link: https://www.fireeye.com/blog/threat-research/2017/04/cve-2017-0199-hta-handler.html
* link: https://www.virustotal.com/file/169c9cc7120fa64c7c02cbbf3aeeefd02fef32ca5dcc61093d1ea012e4f39a18/analysis/1491819886/ — wood.exe/ dcihprianeeyirdeuceulx.exe Updated final payload - Xchecked via VT: 15e51cdbd938545c9af47806984b1667
* link: https://www.virustotal.com/file/3e72bfa3ca0880226cacdbac28299d2a0bacde556ad3400d76be8f1666940828/analysis/1491935832/ — template.doc/template[?].hta Malicious HTA file - Xchecked via VT: fb475f0d8c8e9bf1bc360211179d8a28
* link: https://www.virustotal.com/file/13d0d0b67c8e881e858ae8cbece32ee464775b33a9ffcec6bff4dd3085dbb575/analysis/1491931544/ — hire_form.doc Malicious document - Xchecked via VT: 5ebfd13250dd0408e3de594e419f9e01
* link: https://www.virustotal.com/file/01220917060a94315eeeb04e1ee1263c024e54e66058cb1f910dec3a48fef42a/analysis/1491867682/ — docu.doc/document.doc - Xchecked via VT: e01982913fbc22188b83f5f9fadc1c17
* link: https://www.virustotal.com/file/f4a0f65e9161a266b557e3850e3d17f08b2843ee560f8a89ecf7059eba104e66/analysis/1491801507/ — Ð¡ÐŸÐ£Ð¢ÐÐ˜Ðš Ð ÐÐ—Ð’Ð•Ð”Ð§Ð˜ÐšÐ.doc - Xchecked via VT: c10dabb05a38edd8a9a0ddda1c9af10e

### Network activity
* url: http://www.modani.com/media/wysiwyg/ww.vbs
* url: http://www.modani.com/media/wysiwyg/wood.exe
* ip-dst: 217.12.203.90 — variant then connects to the following command and control (C2) server
* url: http://95.141.38.110/mo/dnr/tmp/template.doc — The initial stage reached out to the following URL to download the stage one malicious HTA file:
* ip-dst: 95.141.38.110 — Malicious HTA

### Payload delivery
* md5: <md5> — Ð¡ÐŸÐ£Ð¢ÐÐ˜Ðš Ð ÐÐ—Ð’Ð•Ð”Ð§Ð˜ÐšÐ.doc
* md5: <md5> — template.doc
* md5: <md5> — copy.jpg/winword.exe
* md5: <md5> — docu.doc/document.doc
* vulnerability: CVE-2017-0199
* md5: <md5> — hire_form.doc Malicious document
* md5: <md5> — template.doc/template[?].hta Malicious HTA file
* md5: <md5> — ww.vbs/maintenance.vbs Stage two VBScript
* md5: <md5> — questions.doc/document.doc Decoy document
* md5: <md5> — eoobvfwiglhiliqougukgm.js Malicious script
* md5: <md5> — wood.exe/ dcihprianeeyirdeuceulx.exe Final payload
* md5: <md5> — wood.exe/ dcihprianeeyirdeuceulx.exe Updated final payload
* sha256: <sha256> — wood.exe/ dcihprianeeyirdeuceulx.exe Updated final payload - Xchecked via VT: 15e51cdbd938545c9af47806984b1667
* sha1: <sha1> — wood.exe/ dcihprianeeyirdeuceulx.exe Updated final payload - Xchecked via VT: 15e51cdbd938545c9af47806984b1667
* sha256: <sha256> — template.doc/template[?].hta Malicious HTA file - Xchecked via VT: fb475f0d8c8e9bf1bc360211179d8a28
* sha1: <sha1> — template.doc/template[?].hta Malicious HTA file - Xchecked via VT: fb475f0d8c8e9bf1bc360211179d8a28
* sha256: <sha256> — hire_form.doc Malicious document - Xchecked via VT: 5ebfd13250dd0408e3de594e419f9e01
* sha1: <sha1> — hire_form.doc Malicious document - Xchecked via VT: 5ebfd13250dd0408e3de594e419f9e01
* sha256: <sha256> — docu.doc/document.doc - Xchecked via VT: e01982913fbc22188b83f5f9fadc1c17
* sha1: <sha1> — docu.doc/document.doc - Xchecked via VT: e01982913fbc22188b83f5f9fadc1c17
* sha256: <sha256> — Ð¡ÐŸÐ£Ð¢ÐÐ˜Ðš Ð ÐÐ—Ð’Ð•Ð”Ð§Ð˜ÐšÐ.doc - Xchecked via VT: c10dabb05a38edd8a9a0ddda1c9af10e
* sha1: <sha1> — Ð¡ÐŸÐ£Ð¢ÐÐ˜Ðš Ð ÐÐ—Ð’Ð•Ð”Ð§Ð˜ÐšÐ.doc - Xchecked via VT: c10dabb05a38edd8a9a0ddda1c9af10e
