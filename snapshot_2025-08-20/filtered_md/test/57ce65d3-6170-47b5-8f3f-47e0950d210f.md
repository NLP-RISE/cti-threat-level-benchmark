# Threat Report: 2016-09-06: OSINT - PokÃ©mon-themed Umbreon Linux Rootkit Hits x86, ARM Systems


## Key Intelligence
* Date: 2016-09-06
* Threat Level: 3 (Low)
* Tags: tlp:white, malware_classification:malware-category="Rootkit", ms-caro-malware:malware-platform="Linux"

---

## Indicators of Compromise (IOCs)
### Artifacts dropped
* yara: rule crime_linux_umbreon : rootkit
{
	meta:
		description = "Catches Umbreon rootkit"
		reference = "http://blog.trendmicro.com/trendlabs-security-intelligence/pokemon-themed-umbreon-linux-rootkit-hits-x86-arm-systems"
		author = "Fernando Merces, FTR, Trend Micro"
		date = "2016-08"
	
	strings:
		$ = { 75 6e 66 75 63 6b 5f 6c 69 6e 6b 6d 61 70 }
		$ = "unhide.rb" ascii fullword
		$ = "rkit" ascii fullword

	condition:
		uint32(0) == 0x464c457f // Generic ELF header
		and uint8(16) == 0x0003 // Shared object file
		and all of them
}
* yara: rule crime_linux_umbreon_strace : rootkit
{
	meta:
		description = "Catches Umbreon strace rootkit component"
		reference = "http://blog.trendmicro.com/trendlabs-security-intelligence/pokemon-themed-umbreon-linux-rootkit-hits-x86-arm-systems"
		author = "Fernando Merces, FTR, Trend Micro"
		date = "2016-08"
	
	strings:
		$ = "LD_PRELOAD" fullword
		$ = /ld\.so\.[a-zA-Z0-9]{7}/ fullword
		$ = "\"/etc/ld.so.preload\"" fullword
		$ = "fputs_unlocked" fullword

	condition:
		uint32(0) == 0x464c457f // Generic ELF header
		and uint8(16) == 0x0003 // Shared object file
		and all of them
}
* yara: rule crime_linux_umbreon_espeon : rootkit backdoor
{
	meta:
		description = "Catches Umbreon strace rootkit component"
		reference = "http://blog.trendmicro.com/trendlabs-security-intelligence/pokemon-themed-umbreon-linux-rootkit-hits-x86-arm-systems"
		author = "Fernando Merces, FTR, Trend Micro"
		date = "2016-08"

	strings:
		$ = "Usage: %s [interface]" fullword
		$ = "Options:" fullword
		$ = "    interface    Listen on <interface> for packets." fullword
		$ = "/bin/espeon-shell %s %hu"
		$ = { 66 75 63 6b 20 6f 66 66 20 63 75 6e 74 }
		$ = "error: unrecognized command-line options" fullword

	condition:
		uint32(0) == 0x464c457f // Generic ELF header
		and uint8(16) == 0x0002 // Executable file
		and all of them
}

### External analysis
* link: http://blog.trendmicro.com/trendlabs-security-intelligence/pokemon-themed-umbreon-linux-rootkit-hits-x86-arm-systems/
* comment: rootkit-feature

The Trend Micro Forward Looking Threat Research team recently obtained samples of a new rootkit family from one of our trusted partners. We are providing a detailed analysis of the rootkit, and also making the samples available to the industry to help others block this threat.

This rootkit family called Umbreon (sharing the same name as the PokÃ©mon) targets Linux systems, including systems running both Intel and ARM processors, expanding the scope of this threat to include embedded devices as well. (An aside: the rootkit does appear to be named after the PokÃ©mon of the same name. This PokÃ©mon is known for hiding in the night, which is an appropriate characteristic for a rootkit.) We detect Umbreon under the ELF_UMBREON family.
* link: https://www.virustotal.com/file/e9bce46584acbf59a779d1565687964991d7033d63c06bddabcfc4375c5f1853/analysis/1472872777/ — umbreon.so (ARM version, detected as ELF_UMREON.B) - Xchecked via VT: 358afd4bd02de3ce1db43970de5e4cb0c38c2848
* link: https://www.virustotal.com/file/991179b6ba7d4aeabdf463118e4a2984276401368f4ab842ad8a5b8b73088522/analysis/1473161723/ — /.ldso/strace.so (detected as ELF_UMREON.A) - Xchecked via VT: 17b42374795295f776536b86aa571a721b041c38
* link: https://www.virustotal.com/file/4fc4b5dab105e03f03ba3ec301bab9e2d37f17a431dee7f2e5a8dfadcca4c234/analysis/1472872774/ — /usr/share/libc.so.2284441204.x86_64.ld-2.22.so (detected as ELF_UMREON.A) - Xchecked via VT: e2bc8945f0d7ca8986b4223ed9ba13686a798446
* link: https://www.virustotal.com/file/8752d16e32a611763eee97da6528734751153ac1699c4693c84b6e9e4fb08784/analysis/1472872773/ — /usr/share/libc.so.2284441204.i686.ld-2.22.so (detected as ELF_UMREON.A) - Xchecked via VT: 851b7f07736be6789cbcc617efd6dcb682e0ce54
* link: https://www.virustotal.com/file/0ce8c09bb6ce433fb8b388c369d7491953cf9bb5426a7bee752150118616d8ff/analysis/1442181954/ — /bin/.x - Xchecked via VT: 1f1ab0a8e9ec43d154cd7ab39bfaaa1eada4ad5e
* link: https://www.virustotal.com/file/0a4d5ffb1407d409a55f1aed5c5286d4f31fe17bc99eabff64aa1498c5482a5f/analysis/1473087594/ — /bin/spytty - Xchecked via VT: 4f6c6d42bdf93f4ccf68d888ce7f98bcd929fc72
* link: https://www.virustotal.com/file/c80d19f6f3372f4cc6e75ae1af54e8727b54b51aaf2794fedd3a1aa463140480/analysis/1472872772/ — /bin/espeon (detected as ELF_UMREON.A) - Xchecked via VT: 66d246e02492821f7e5bbaeb8156ece44c101bbc
* link: https://www.virustotal.com/file/aa24deb830a2b1aa694e580c5efb24f979d6c5d861b56354a6acb1ad0cf9809b/analysis/1423751099/ — /bin/unhide-self - Xchecked via VT: 88aea4bb5e68c1afe1fb11d55a190dddb8b1586f
* link: https://www.virustotal.com/file/122417853c1eb1868e429cacc499ef75cfc018b87da87b1f61bff53e9b8e8670/analysis/1472938012/ — /bin/espeon-shell (detected as BKDR_UMREON.A) - Xchecked via VT: 48a6e43af0cb40d4f92b38062012117081b6774e
* link: https://www.virustotal.com/file/0751cf716ea9bc18e78eb2a82cc9ea0cac73d70a7a74c91740c95312c8a9d53a/analysis/1472938049/ — /bin/pkg /bin/zypper ./bin/emerge /bin/yum /bin/apt-get - Xchecked via VT: 73ddcd21bf05a9edc7c85d1efd5304eea039d3cb

### Payload delivery
* sha1: <sha1> — /hideports
* sha1: <sha1> — /.bashrc
* sha1: <sha1> — /bin/pkg /bin/zypper ./bin/emerge /bin/yum /bin/apt-get
* sha1: <sha1> — /bin/espeon-shell (detected as BKDR_UMREON.A)
* sha1: <sha1> — /bin/unhide-self
* sha1: <sha1> — /bin/umbreon.py
* sha1: <sha1> — /bin/espeon (detected as ELF_UMREON.A)
* sha1: <sha1> — /bin/spytty
* sha1: <sha1> — /bin/.x
* sha1: <sha1> — /.init-append
* sha1: <sha1> — /.umbreon-ascii
* sha1: <sha1> — /.profile
* sha1: <sha1> — /usr/share/libc.so.2284441204.i686.ld-2.22.so (detected as ELF_UMREON.A)
* sha1: <sha1> — /usr/share/libc.so.2284441204.x86_64.ld-2.22.so (detected as ELF_UMREON.A)
* sha1: <sha1> — /.ldso/strace.so (detected as ELF_UMREON.A)
* sha1: <sha1> — /promptlog
* sha1: <sha1> — espeon (ARM version, detected as ELF_UMREON.B)
* sha1: <sha1> — pkg (ARM version, detected as ELF_UMREON.B)
* sha1: <sha1> — strace.so (ARM version, detected as ELF_UMREON.B)
* sha1: <sha1> — umbreon.so (ARM version, detected as ELF_UMREON.B)
* sha256: <sha256> — umbreon.so (ARM version, detected as ELF_UMREON.B) - Xchecked via VT: 358afd4bd02de3ce1db43970de5e4cb0c38c2848
* md5: <md5> — umbreon.so (ARM version, detected as ELF_UMREON.B) - Xchecked via VT: 358afd4bd02de3ce1db43970de5e4cb0c38c2848
* sha256: <sha256> — /.ldso/strace.so (detected as ELF_UMREON.A) - Xchecked via VT: 17b42374795295f776536b86aa571a721b041c38
* md5: <md5> — /.ldso/strace.so (detected as ELF_UMREON.A) - Xchecked via VT: 17b42374795295f776536b86aa571a721b041c38
* sha256: <sha256> — /usr/share/libc.so.2284441204.x86_64.ld-2.22.so (detected as ELF_UMREON.A) - Xchecked via VT: e2bc8945f0d7ca8986b4223ed9ba13686a798446
* md5: <md5> — /usr/share/libc.so.2284441204.x86_64.ld-2.22.so (detected as ELF_UMREON.A) - Xchecked via VT: e2bc8945f0d7ca8986b4223ed9ba13686a798446
* sha256: <sha256> — /usr/share/libc.so.2284441204.i686.ld-2.22.so (detected as ELF_UMREON.A) - Xchecked via VT: 851b7f07736be6789cbcc617efd6dcb682e0ce54
* md5: <md5> — /usr/share/libc.so.2284441204.i686.ld-2.22.so (detected as ELF_UMREON.A) - Xchecked via VT: 851b7f07736be6789cbcc617efd6dcb682e0ce54
* sha256: <sha256> — /bin/.x - Xchecked via VT: 1f1ab0a8e9ec43d154cd7ab39bfaaa1eada4ad5e
* md5: <md5> — /bin/.x - Xchecked via VT: 1f1ab0a8e9ec43d154cd7ab39bfaaa1eada4ad5e
* sha256: <sha256> — /bin/spytty - Xchecked via VT: 4f6c6d42bdf93f4ccf68d888ce7f98bcd929fc72
* md5: <md5> — /bin/spytty - Xchecked via VT: 4f6c6d42bdf93f4ccf68d888ce7f98bcd929fc72
* sha256: <sha256> — /bin/espeon (detected as ELF_UMREON.A) - Xchecked via VT: 66d246e02492821f7e5bbaeb8156ece44c101bbc
* md5: <md5> — /bin/espeon (detected as ELF_UMREON.A) - Xchecked via VT: 66d246e02492821f7e5bbaeb8156ece44c101bbc
* sha256: <sha256> — /bin/unhide-self - Xchecked via VT: 88aea4bb5e68c1afe1fb11d55a190dddb8b1586f
* md5: <md5> — /bin/unhide-self - Xchecked via VT: 88aea4bb5e68c1afe1fb11d55a190dddb8b1586f
* sha256: <sha256> — /bin/espeon-shell (detected as BKDR_UMREON.A) - Xchecked via VT: 48a6e43af0cb40d4f92b38062012117081b6774e
* md5: <md5> — /bin/espeon-shell (detected as BKDR_UMREON.A) - Xchecked via VT: 48a6e43af0cb40d4f92b38062012117081b6774e
* sha256: <sha256> — /bin/pkg /bin/zypper ./bin/emerge /bin/yum /bin/apt-get - Xchecked via VT: 73ddcd21bf05a9edc7c85d1efd5304eea039d3cb
* md5: <md5> — /bin/pkg /bin/zypper ./bin/emerge /bin/yum /bin/apt-get - Xchecked via VT: 73ddcd21bf05a9edc7c85d1efd5304eea039d3cb
* malware-sample: 0a4d5ffb1407d409a55f1aed5c5286d4f31fe17bc99eabff64aa1498c5482a5f|0ab776fa8a0fbed2ef26c9933c32e97c — expanded manually via VT
* filename|sha1: <sha1> — expanded manually via VT
* filename|sha256: <sha256> — expanded manually via VT
* malware-sample: 0ce8c09bb6ce433fb8b388c369d7491953cf9bb5426a7bee752150118616d8ff|b982597ceb7274617f286ca80864f499 — expanded manually via VT
* filename|sha1: <sha1> — expanded manually via VT
* filename|sha256: <sha256> — expanded manually via VT
* malware-sample: 4fc4b5dab105e03f03ba3ec301bab9e2d37f17a431dee7f2e5a8dfadcca4c234|d0d97899131c29b3ec9ae89a6d49a23e — expanded manually via VT
* filename|sha1: <sha1> — expanded manually via VT
* filename|sha256: <sha256> — expanded manually via VT
* malware-sample: 015a84eb1d18beb310e7aeeceab8b84776078935c45924b3a10aa884a93e28ac|a47e38464754289c0f4a55ed7bb55648 — expanded manually via VT
* filename|sha1: <sha1> — expanded manually via VT
* filename|sha256: <sha256> — expanded manually via VT
* malware-sample: 409c90ecd56e9abcb9f290063ec7783ecbe125c321af3f8ba5dcbde6e15ac64a|b4746bb5e697f23a5842abcaed36c914 — expanded manually via VT
* filename|sha1: <sha1> — expanded manually via VT
* filename|sha256: <sha256> — expanded manually via VT
* malware-sample: 0751cf716ea9bc18e78eb2a82cc9ea0cac73d70a7a74c91740c95312c8a9d53a|f9ba2429eae5471acde820102c5b8159 — expanded manually via VT
* filename|sha1: <sha1> — expanded manually via VT
* filename|sha256: <sha256> — expanded manually via VT
* malware-sample: 8752d16e32a611763eee97da6528734751153ac1699c4693c84b6e9e4fb08784|e7e82d29dfb1fc484ed277c702187818 — expanded manually via VT
* filename|sha1: <sha1> — expanded manually via VT
* filename|sha256: <sha256> — expanded manually via VT
* malware-sample: 991179b6ba7d4aeabdf463118e4a2984276401368f4ab842ad8a5b8b73088522|2b1863acdc0068ed5d50590cf792df05 — expanded manually via VT
* filename|sha1: <sha1> — expanded manually via VT
* filename|sha256: <sha256> — expanded manually via VT
* malware-sample: 122417853c1eb1868e429cacc499ef75cfc018b87da87b1f61bff53e9b8e8670|9eef7e7e3c1bee2f8591a088244be0cb — expanded manually via VT
* filename|sha1: <sha1> — expanded manually via VT
* filename|sha256: <sha256> — expanded manually via VT
* malware-sample: aa24deb830a2b1aa694e580c5efb24f979d6c5d861b56354a6acb1ad0cf9809b|df320ed7ee6ccf9f979aefe451877ffc — expanded manually via VT
* filename|sha1: <sha1> — expanded manually via VT
* filename|sha256: <sha256> — expanded manually via VT
* malware-sample: acfb014304b6f2cff00c668a9a2a3a9cbb6f24db6d074a8914dd69b43afa4525|84d552b5d22e40bda23e6587b1bc532d — expanded manually via VT
* filename|sha1: <sha1> — expanded manually via VT
* filename|sha256: <sha256> — expanded manually via VT
* malware-sample: c80d19f6f3372f4cc6e75ae1af54e8727b54b51aaf2794fedd3a1aa463140480|087dd79515d37f7ada78ff5793a42b7b — expanded manually via VT
* filename|sha1: <sha1> — expanded manually via VT
* filename|sha256: <sha256> — expanded manually via VT
* malware-sample: e9bce46584acbf59a779d1565687964991d7033d63c06bddabcfc4375c5f1853|bbeb18c0c3e038747c78fcab3e0444e3 — expanded manually via VT
* filename|sha1: <sha1> — expanded manually via VT
* filename|sha256: <sha256> — expanded manually via VT
