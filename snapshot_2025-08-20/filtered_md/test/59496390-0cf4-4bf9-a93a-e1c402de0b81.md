# Threat Report: 2017-06-20: OSINT - CVE-­2017-­0199 life of an exploit


## Key Intelligence
* Date: 2017-06-20
* Threat Level: 3 (Low)
* Tags: tlp:white, misp-galaxy:tool="LATENTBOT", misp-galaxy:tool="AmmyAdmin"

---

## Indicators of Compromise (IOCs)
### External analysis
* link: https://www.sophos.com/en-us/medialibrary/PDFs/technical-papers/CVE-2017-0199-life-of-an-exploit.pdf

### Network activity
* url: http://95.141.38.110/mo/dnr/tmp/template.doc — decoy
* url: http://95.141.38.110/mo/dnr/copy.jpg — payload
* url: http://185.168.186.36/up/dnr/scan/
* url: http://46.102.152.129/template.doc
* url: wood.exe/dcihprianeeyirdeuceulx.exe — payload
* url: questions.doc/document.doc — decoy
* url: http://d218w8g44zaxak.cloudfront.net/Doc1.jpg
* url: http://107.170.240.244/download/omgrtf.doc
* url: http://95.46.99.199/template.doc
* url: http://95.46.99.199/last.exe
* url: http://212.86.115.71/sage50.exe
* url: http://btt5sxcx90.com/template.doc — (first stage downloader)
* url: http://btt5sxcx90.com/7500.exe — (payload)
* url: http://btt5sxcx90.com/sample.doc — (decoy)
* url: http://rottastics36w.net/template.doc
* url: http://hyoeyeep.ws/template.doc
* url: http://hyoeyeep.ws/sp.exe
* url: http://127.0.0.1/ddsa.doc
* url: http://127.0.0.1/EncryptedDocument.doc
* url: http://directxmpp.siph0n.pw/EncryptedDocument.doc
* url: http://hyoeyeep.ws/template.dod — Derived from 04a2977b0307834806214fd219636711352b67c7 (Dridex downloader) by changing a single byte in the URL (the extension was changed from .doc to .dod)
* url: hstp://hyoeyeep.ws/template.doc — Derived from 04a2977b0307834806214fd219636711352b67c7 (Dridex downloader) by changing a single byte in the URL (changing http to hstp)
* url: http://hyoeyeep.ws/templatc.doc — Derived from 04a2977b0307834806214fd219636711352b67c7 (Dridex downloader ) by changing a single byte in the URL (from template to templatc)
* url: http://127.0.0.1/s/template.doc
* url: http://135.84.177.155/svchost.exe
* url: http://192.168.56.1/test.doc
* url: http://5.79.98.106/logo.doc
* url: http://87.120.254.189/BFbGXDVNjwJaGfFg.txt
* url: http://wowaskopoq.top/1.xls

### Payload delivery
* vulnerability: CVE-2017-0199
* sha1: <sha1>
* filename|sha1: <sha1>
* filename|sha1: <sha1>
* filename|sha1: <sha1> — Latentbot
* filename|sha1: <sha1>
* sha1: <sha1>
* filename|sha1: <sha1> — Downloads hxxp://d218w8g44zaxak.cloudfront[.]net/Doc1.jpg
* filename|sha1: <sha1> — Downloads hxxp://107.170.240.244/download/omgrtf.doc
* filename|sha1: <sha1> — Downloads http://107.170.240.244/download/omgrtf.doc
* ip-dst|port: 194.165.16.51|443 — Ammyy remote administration tool ,connects on this server
* filename|sha1: <sha1>
* filename|sha1: <sha1>
* filename|sha1: <sha1>
* filename|sha1: <sha1>
* filename|sha1: <sha1>
* filename|sha1: <sha1> — Downloads hxxp ://212.86.115.71/template.doc and hxxp://212.86.115.71/sage50.exe
* filename: http://212.86.115.71/template.doc
* filename|sha1: <sha1> — Downloads hxxp://btt5sxcx90[.]com/template.doc which downloads hxxp://btt5sxcx90[.]com/7500.exe and hxxp://btt5sxcx90.com/sample.doc
* filename|sha1: <sha1>
* sha1: <sha1>
* filename|sha1: <sha1>
* filename|sha1: <sha1>
* filename|sha1: <sha1> — Downloads hxxp://rottastics36w[.]net/template.doc
* filename|sha1: <sha1>
* filename|sha1: <sha1>
* sha1: <sha1>
* sha1: <sha1> — Downloads hxxp://hyoeyeep[.]ws/template.doc; probably downloads hxxp://hyoeyeep[.]ws/sp.exe
* filename|sha1: <sha1>
* filename|sha1: <sha1> — Downloads hxxp://127.0.0.1/ddsa.doc
* filename|sha1: <sha1> — Downloads hxxp://127.0.0.1/EncryptedDocument.doc
* filename|sha1: <sha1> — Downloads hxxp://directxmpp.siph0n.pw/EncryptedDocument.doc; executed calc.exe
* sha1: <sha1> — Original name:assssss - Downloads hxxp://hyoeyeep[.]ws/template.dod
* sha1: <sha1> — Original name:assssss - Downloads hstp://hyoeyeep[.]ws/template.doc
* sha1: <sha1> — Original name:assssss - Downloads hxxp://hyoeyeep.ws/templatc.doc
* sha1: <sha1> — Original name:assssss - Derived from 04a2977b0307834806214fd219636711352b67c7 (Dridex downloader) by manually editing the RTF file in multiple point and eventually breaking the download URL
* sha1: <sha1> — Dridex downloaders
* sha256: <sha256> — Dridex downloaders
* filename|sha1: <sha1>
* filename|sha1: <sha1> — Downloads hxxp://hyoeyeep.ws/template.doc
* filename|sha1: <sha1> — Downloads hxxp://127.0.0.1/s/template.doc
* filename|sha1: <sha1> — Downloads hxxp://127.0.0.1/s/template.doc
* filename|sha1: <sha1> — Downloads hxxp://127.0.0.1/s/template.doc
* filename|sha1: <sha1> — Downloads hxxp://127.0.0.1/s/template.doc
* filename|sha1: <sha1> — Downloads hxxp://127.0.0.1/s/template.doc
* filename|sha1: <sha1> — Downloads hxxp://127.0.0.1/s/template.doc
* filename|sha1: <sha1> — Downloads hxxp://127.0.0.1/s/template.doc
* filename|sha1: <sha1> — Downloads hxxps://g-­‐mirror.appspot[.]com/report.rtf which downloads hxxps://g-­‐mirror.appspot[.]com/favicon.ico
* filename: https://g-‐mirror.appspot.com/report.rtf
* filename: https://g-‐mirror.ppspot.com/favicon.icoa
* filename: %PROFILE%\AppData\Roaming\Microsoft\Display Control Panel\DpiScaling.exe — (installer)
* filename: %PROFILE%\AppData\Roaming\Microsoft\Dynamic COM+\comuid.dll — (main backdoor)
* filename|sha1: <sha1> — Downloads hxxps://mirror-­‐gcdn.appspot[.]com/template.rtf
* filename: https://mirror-‐gcdn.appspot.com/template.rtf
* filename|sha1: <sha1> — Downloads hxxps://cdn-­‐gmirror.appspot[.]com/template.rtf
* filename: https://cdn-‐gmirror.appspot.com/template.rtf
* filename|sha1: <sha1> — Downloads hxxp://135.84.177.155/svchost.exe
* filename|sha1: <sha1> — Downloads hxxp://192.168.56.1/test.doc
* sha1: <sha1> — Downloads hxxp://5.79.98.106/logo.doc
* filename|sha1: <sha1> — Downloads hxxp://87.120.254.189/BFbGXDVNjwJaGfFg.txt
* filename|sha1: <sha1> — Downloads hxxp://wowaskopoq.top/1.xls which is not an Excel spreadsheet, as the extension would suggest, but a Windows executable that drops the Cerber ransomware

### Persistence mechanism
* regkey: HKCU\Software\Microsoft\Windows\CurrentVersion\Run→DpiScaling
