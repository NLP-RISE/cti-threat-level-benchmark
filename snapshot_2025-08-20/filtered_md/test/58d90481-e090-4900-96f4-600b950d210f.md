# Threat Report: 2017-03-27: OSINT - APT29 Domain Fronting With TOR


## Key Intelligence
* Date: 2017-03-27
* Threat Level: 3 (Low)
* Tags: misp-galaxy:threat-actor="APT 29", tlp:white

---

## Indicators of Compromise (IOCs)
### External analysis
* link: https://www.fireeye.com/blog/threat-research/2017/03/apt29_domain_frontin.html
* text: Mandiant has observed Russian nation-state attackers APT29 employing domain fronting techniques for stealthy backdoor access to victim environments for at least two years. There has been considerable discussion about domain fronting following the release of a paper detailing these techniques. Domain fronting provides outbound network connections that are indistinguishable from legitimate requests for popular websites.

APT29 has used The Onion Router (TOR) and the TOR domain fronting plugin meek to create a hidden, encrypted network tunnel that appeared to connect to Google services over TLS. This tunnel provided the attacker remote access to the host system using the Terminal Services (TS), NetBIOS, and Server Message Block (SMB) services, while appearing to be traffic to legitimate websites. The attackers also leveraged a common Windows exploit to access a privileged command shell without authenticating.

We first discussed APT29â€™s use of these techniques as part of our â€œNo Easy Breachâ€ talk at DerbyCon 6.0. For additional details on how we first identified this backdoor, and the epic investigation it was part of, see the slides and presentation.
* link: https://www.virustotal.com/file/2f39dee2ee608e39917cc022d9aae399959e967a2dd70d83b81785a98bd9ed36/analysis/1490381093/ — GoogleUpdate.exe - the meek-client plugin, which obfuscates the TOR connection. - Xchecked via VT: 2f39dee2ee608e39917cc022d9aae399959e967a2dd70d83b81785a98bd9ed36
* link: https://www.virustotal.com/file/fe744a5b2d07de396a8b3fe97155fc64e350b76d88db36c619cd941279987dc5/analysis/1490588868/ — googleService.exe the primary TOR executable, responsible for establishing and maintaining encrypted proxy connections. - Xchecked via VT: fe744a5b2d07de396a8b3fe97155fc64e350b76d88db36c619cd941279987dc5

### Network activity
* url: https://meek-reflect.appspot.com — Bridge traffic using the meek plugin to https://meek-reflect.appspot.com and obfuscate HTTPS and DNS requests to appear destined for www.google.com

### Payload delivery
* sha256: <sha256> — googleService.exe the primary TOR executable, responsible for establishing and maintaining encrypted proxy connections.
* sha256: <sha256> — GoogleUpdate.exe - the meek-client plugin, which obfuscates the TOR connection.
* sha1: <sha1> — GoogleUpdate.exe - the meek-client plugin, which obfuscates the TOR connection. - Xchecked via VT: 2f39dee2ee608e39917cc022d9aae399959e967a2dd70d83b81785a98bd9ed36
* md5: <md5> — GoogleUpdate.exe - the meek-client plugin, which obfuscates the TOR connection. - Xchecked via VT: 2f39dee2ee608e39917cc022d9aae399959e967a2dd70d83b81785a98bd9ed36
* sha1: <sha1> — googleService.exe the primary TOR executable, responsible for establishing and maintaining encrypted proxy connections. - Xchecked via VT: fe744a5b2d07de396a8b3fe97155fc64e350b76d88db36c619cd941279987dc5
* md5: <md5> — googleService.exe the primary TOR executable, responsible for establishing and maintaining encrypted proxy connections. - Xchecked via VT: fe744a5b2d07de396a8b3fe97155fc64e350b76d88db36c619cd941279987dc5
