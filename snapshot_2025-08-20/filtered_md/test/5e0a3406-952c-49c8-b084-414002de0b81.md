# Threat Report: 2019-12-30: OSINT - Introducing BIOLOAD: FIN7 BOOSTWRITEâ€™s Lost Twin


## Key Intelligence
* Date: 2019-12-30
* Threat Level: 2 (Medium)
* Tags: misp-galaxy:mitre-enterprise-attack-intrusion-set="FIN7", misp-galaxy:mitre-enterprise-attack-relationship="FIN7 (G0046) uses Carbanak (S0030)", misp-galaxy:mitre-enterprise-attack-relationship="FIN7 uses Carbanak", misp-galaxy:mitre-intrusion-set="FIN7", misp-galaxy:threat-actor="Anunak", type:OSINT, osint:lifetime="perpetual", tlp:white, misp-galaxy:mitre-attack-pattern="DLL Search Order Hijacking", misp-galaxy:mitre-enterprise-attack-attack-pattern="DLL Search Order Hijacking", osint:source-type="blog-post"

---

## Indicators of Compromise (IOCs)
### External analysis
* text: By Omri Misgav | December 26, 2019
Acouple of months ago, enSiloâ€™s endpoint protection platform blocked malicious payloads running in legitimate Microsoft Windows processes. A deeper look uncovered that the attacker abused the DLL search order to load their own malicious DLL. Some of the samples in the environment matched ones described in a recent publication by FireEye about FIN7â€™s new tools and techniques, specifically BOOSTWRITE. Comparing the rest of the samples to BOOSTWRITE revealed they have a common codebase and carry the Carbanak backdoor.

### Payload delivery
* sha256: <sha256> — WinBio.dll (scrubbed key and payload)
* sha256: <sha256> — WinBio.dll (scrubbed key and payload)
* sha256: <sha256> — Carbanak
* sha256: <sha256> — Carbanak

## Objects
### file — File object describing a file with meta-information
* [Payload delivery] md5: <md5> — WinBio.dll (scrubbed key and payload)
* [Payload delivery] sha1: <sha1> — WinBio.dll (scrubbed key and payload)
* [Payload delivery] sha256: <sha256> — WinBio.dll (scrubbed key and payload)

### virustotal-report — VirusTotal report
* [Other] datetime: 2019-12-30T17:16:31 — WinBio.dll (scrubbed key and payload)
* [Payload delivery] link: https://www.virustotal.com/file/7bdae0dfc37cb5561a89a0b337b180ac6a139250bd5247292f470830bd96dda7/analysis/1577726191/ — WinBio.dll (scrubbed key and payload)
* [Payload delivery] text: 32/69 — WinBio.dll (scrubbed key and payload)

### file — File object describing a file with meta-information
* [Payload delivery] md5: <md5> — Carbanak
* [Payload delivery] sha1: <sha1> — Carbanak
* [Payload delivery] sha256: <sha256> — Carbanak

### virustotal-report — VirusTotal report
* [Other] datetime: 2019-12-29T14:21:55 — Carbanak
* [Payload delivery] link: https://www.virustotal.com/file/77a6fbd4799a8468004f49f5929352336f131ad83c92484b052a2eb120ebaf9a/analysis/1577629315/ — Carbanak
* [Payload delivery] text: 42/71 — Carbanak

### file — File object describing a file with meta-information
* [Payload delivery] md5: <md5> — WinBio.dll (scrubbed key and payload)
* [Payload delivery] sha1: <sha1> — WinBio.dll (scrubbed key and payload)
* [Payload delivery] sha256: <sha256> — WinBio.dll (scrubbed key and payload)

### virustotal-report — VirusTotal report
* [Other] datetime: 2019-12-30T14:02:20 — WinBio.dll (scrubbed key and payload)
* [Payload delivery] link: https://www.virustotal.com/file/c1c68454e82d79e75fefad33e5acbb496bbc3f5056dfa26aaf1f142cee1af372/analysis/1577714540/ — WinBio.dll (scrubbed key and payload)
* [Payload delivery] text: 33/70 — WinBio.dll (scrubbed key and payload)

### file — File object describing a file with meta-information
* [Payload delivery] md5: <md5> — Carbanak
* [Payload delivery] sha1: <sha1> — Carbanak
* [Payload delivery] sha256: <sha256> — Carbanak

### virustotal-report — VirusTotal report
* [Other] datetime: 2019-12-28T17:45:44 — Carbanak
* [Payload delivery] link: https://www.virustotal.com/file/42d3cf75497a724e9a9323855e0051971816915fc7eb9f0426b5a23115a3bdcb/analysis/1577555144/ — Carbanak
* [Payload delivery] text: 39/70 — Carbanak

### annotation — An annotation object allowing analysts to add annotations, comments, executive summary to a MISP event, objects or attributes.
* [Other] text: markdown
* [Other] text: Other
* [Other] text: [<img width="200" height="23" src=":/735a23f2ea5d4a2ca314bbb10957e1fd"/>](https://www.fortinet.com)

[Blog](https://www.fortinet.com/blog)

*   [Business & Technology](https://www.fortinet.com/blog/business-and-technology.html)
*   [Threat Research](https://www.fortinet.com/blog/threat-research.html)
*   [Industry Trends](https://www.fortinet.com/blog/industry-trends.html)
*   [Partners](https://www.fortinet.com/blog/partners.html)

<img width="1908" height="400" src=":/bce5663d73cd44318b21c1471c4186e3"/>

Threat Research

# Introducing BIOLOAD: FIN7 BOOSTWRITEâ€™s Lost Twin

By [Omri Misgav](https://www.fortinet.com/blog/search.html?author=Omri+Misgav) | December 26, 2019

A couple of months ago, [enSiloâ€™s endpoint protection platform](https://www.fortinet.com/blog/business-and-technology/fortinet-acquires-endpoint-security-innovator-ensilo-.html) blocked malicious payloads running in legitimate Microsoft Windows processes. A deeper look uncovered that the attacker abused the DLL search order to load their own malicious DLL. Some of the samples in the environment matched ones described in a recent publication by FireEye about FIN7â€™s new tools and techniques, specifically BOOSTWRITE. Comparing the rest of the samples to BOOSTWRITE revealed they have a common codebase and carry the Carbanak backdoor.

## The Abused Target

Windows OS uses a [common method](https://docs.microsoft.com/en-us/windows/win32/dlls/dynamic-link-library-search-order) to look for required DLLs to load into a program. Adversaries may use this behavior to cause the program to load a malicious DLL, a technique known as [DLL search order hijacking (or binary planting)](https://attack.mitre.org/techniques/T1038).

The abused application in this case is _FaceFodUninstaller.exe_. It exists on a clean OS installation starting from Windows 10 RS4 (1803) at the â€œ_%WINDR%\\System32\\WinBioPlugIns_â€ folder. The executable is dependent on winbio.dll, which is usually found in the parent directory (â€œ_%WINDR%\\System32_â€).

<img width="924" height="353" src=":/4ec1bd4104104b4484e66764c4c3e752"/> Figure 1: FaceFodUninstaller.exe import table

What makes this executable even more attractive in the eyes of an attacker is the fact that it is started from a built-in scheduled task named _FODCleanupTask_, thereby minimizing the footprint on the machine and reducing the chances of detection even further. This demonstrates the groupâ€™s ongoing technological research efforts.

<img width="693" height="693" src=":/18a7bd8efa6e48098d90b14c8334033f"/> Figure 2: The built-in task view in Windows Task Scheduler

## BIOLOAD  

The loader file name is _WinBio.dll_ (note the uppercase characters) and is placed by the attacker alongside the executable in the same folder (â€œ_WinBioPlugIns_"), thus leveraging the default DLL search order. Because the file path is under _%WINDIR%_, it means that in order to plant it the attacker needed to have elevated privileges on the victimâ€™s machine such as administrator or a SYSTEM account.

<img width="693" height="693" src=":/18a7bd8efa6e48098d90b14c8334033f"/> Figure 3: WinBioPlugIns folder of an infected machine

Like BOOSTWRITE, this loader was also developed in C++. It exports only a single function which is the one _FaceFodUninstaller.exe_ imports.

The samples target a 64-bit OS and were compiled in March and July of 2019. BOOSTWRITE targets 32-bit machines and was compiled (and signed) in May 2019. According to previous reports on the group, they do not falsify compilation timestamps of the binaries.

When the DLL is started it checks the number of command line arguments of the process to decide how to act. When the executable is started by the task scheduler it doesnâ€™t have command line arguments and the malware works as follows:

1.  Creates a log file at _%TEMP%\\~bio&lt;epoch_time&gt;_. Logs are textual and arenâ€™t encrypted.
2.  Starts itself again as a child process with one command line argument comprised of 32 random upper-case letters.
3.  Establishes persistency by using COM objects to access the task scheduler. The malware makes sure the task is enabled, adds a trigger to start it 30 seconds after Windows boots and does not wait for idle state.

When _WinBioGetEnrolledFactors_ is called, the malware loads the original _winbio.dll_ and invokes the original function.

The worker process loads and executes the payload DLL in-memory. It starts by creating a log file at _%TEMP%\\~wrk&lt;epoch_time&gt;_. It then makes sure only a single instance is currently running by creating a named mutex based on environments variables in this fashion:

<img width="539" height="539" src=":/18a7bd8efa6e48098d90b14c8334033f"/>

BIOLOAD also has the encrypted payload DLL embedded in it. In contrast to BOOSTWRITE, it does not support multiple payloads. Furthermore, to decrypt the payload it uses a simple XOR decryption rather than a ChaCha cipher, nor does it access a remote server to fetch the key. Instead, BIOLOAD is tailor-made for every machine it infects as it relies on the machine name to properly derive the decryption key.

The length of the key is 16 bytes and is also embedded in the loader. A portion of the key is overwritten with the result of [MurmurHash3](https://github.com/aappleby/smhasher/blob/master/src/MurmurHash3.cpp#L255) on the key using a CRC32 checksum of the computer name as the seed. This hinders detection by sandboxes and obstruct researchers from analyzing the payload when the relevant context is missing.

<img width="693" height="693" src=":/18a7bd8efa6e48098d90b14c8334033f"/> Figure 4: Start of the MurmurHash3 function disassembly

The PE loader implementation is the same as the one in BOOSTWRITE. The format of the log file name is similar as well.

## The Carbanak Backdoor

As mentioned, the payload this loader carries is the Carbanak backdoor. The samples we extracted from BIOLOAD are newer builds of the backdoor, dated January and April of 2019, according to their timestamps.

One notable addition is that it checks to see if another Anti-Virus (AV) is running on the machine, besides Kaspersky, AVG and TrendMicro. The result, however, has no effect on the operations of the backdoor, unlike with previously detected AVs.

## Final Thoughts

This is the first public case of FaceFodUninstaller.exe being abused as host process by a threat actor.

The shared codebase with recent tools attributed to FIN7, together with the same techniques and backdoor, allows to attribute this new loader to the cybercrime group. The timestamps, together with simpler functionality, suggest BIOLOAD is a preceding iteration of BOOSTWRITE.

Since the loader is specifically built for each targeted machine and requires administrative permissions to deploy, it suggests the group gathers information about its targetsâ€™ networks.

## Solutions

This malware uses a common, yet stealthy and effective, method to execute its payload in the context of legitimate processes.Â 

Countermeasures should be in place to detect this malicious behavior. The recently acquired FortiEDR â€“ an Endpoint Detection and Response solution integrated into FortiGate firewalls, FortiSIEM and FortiSandbox - detects and blocks such behavior post-infection to help incident responders quickly mitigate and respond to such threats.

FortiClient detects and blocks the IOCs listed below as **W64/Inject.B!tr.spy** and **W64/Carbanak.A2EB!tr**.

In addition, as part of our membership in theÂ [Cyber Threat Alliance](https://www.cyberthreatalliance.org/), details of this threat were shared in real time with other Alliance members to help create better protections for customers.

## IOCs

**WinBio.dll (scrubbed key and payload) SHA256**

7bdae0dfc37cb5561a89a0b337b180ac6a139250bd5247292f470830bd96dda7  
c1c68454e82d79e75fefad33e5acbb496bbc3f5056dfa26aaf1f142cee1af372

**Carbanak SHA256**

77a6fbd4799a8468004f49f5929352336f131ad83c92484b052a2eb120ebaf9a  
42d3cf75497a724e9a9323855e0051971816915fc7eb9f0426b5a23115a3bdcbÂ  Â Â 

_Learn more aboutÂ [FortiGuard Labs](https://www.fortinet.com/fortiguard/threat-intelligence/threat-research.html?utm_source=nreleaseblog&utm_campaign=2018-q2-fortiguardlabs-cta)Â and the FortiGuard Security ServicesÂ [portfolio](https://www.fortinet.com/support-and-training/support-services/fortiguard-security-subscriptions.html?utm_source=blog&utm_campaign=2018-blog-security-services).Â [Sign up](https://www.fortinet.com/fortiguard/threat-intelligence/threat-research.html?utm_source=nreleaseblog&utm_campaign=2018-q2-fortiguardlabs-cta)Â for our weekly FortiGuard Threat Brief._

_Read about the FortiGuardÂ [Security Rating Service](https://www.fortinet.com/support-and-training/support-services/fortiguard-security-subscriptions/security-rating.html?utm_source=blog&utm_campaign=2018-blog-security-rating-service), which provides security audits and best practices._

[<img width="914" height="143" src=":/91993d9978bb413c9e197be19c0ce541"/>](https://www.fortinet.com/resources/resources-campaign.html?utm_source=social&utm_medium=blog&campaign=power-of&utm_term=q3fy19tlr#ufh-i-503778344-quarterly-threat-landscape-report/2901083)

Tags:

[threat research](https://www.fortinet.com/blog/tags-search.html?tag=threat-research), [Carbanak](https://www.fortinet.com/blog/tags-search.html?tag=carbanak), [Cybersecurity Architect](https://www.fortinet.com/blog/tags-search.html?tag=cybersecurity-architect), [BIOLOAD](https://www.fortinet.com/blog/tags-search.html?tag=bioload), [FIN7](https://www.fortinet.com/blog/tags-search.html?tag=fin7)

### Related Posts

[<img width="281" height="211" src=":/bce5663d73cd44318b21c1471c4186e3"/><br>Threat Research<br>##### â€œBlueKeepâ€ Vulnerability (CVE-2019-0708) within Cloud/Datacenter Machines: How to Safeguard Yourself?](https://www.fortinet.com/blog/threat-research/bluekeep-vulnerability-cloud-datacenters.html)[<img width="281" height="211" src=":/bce5663d73cd44318b21c1471c4186e3"/><br>Threat Research<br>##### Key Takeaways from Our Latest Global Threat Landscape Report](https://www.fortinet.com/blog/threat-research/cyber-adversaries-flock-to-apps-where-the-users-are-and-when-use.html)[<img width="281" height="211" src=":/bce5663d73cd44318b21c1471c4186e3"/><br>Threat Research<br>##### WordPress WooCommerce XSS Vulnerability â€“ Hijacking a Customer Account with a Crafted Image](https://www.fortinet.com/blog/threat-research/wordpress-woocommerce-xss-vulnerability----hijacking-a-customer-.html)

[<img width="190" height="23" src=":/735a23f2ea5d4a2ca314bbb10957e1fd"/>](https://www.fortinet.com)

#### News & Articles

*   [News Releases](https://www.fortinet.com/corporate/about-us/newsroom/press-releases.html)
*   [News Articles](https://www.fortinet.com/corporate/about-us/newsroom/news.html)
*   [Trademarks](https://www.fortinet.com/corporate/about-us/contact-us/fortinet-trademark-guidelines.html)

#### Security Research

*   [Threat Research](https://www.fortinet.com/fortiguard/threat-intelligence/threat-research.html)
*   [FortiGuard Labs](https://fortiguard.com/)
*   [Threat Map](https://www.fortinet.com/fortiguard/threat-intelligence/threat-map.html)
*   [Threat Briefs](https://secure.fortinet.com/fortiguard)
*   [Ransomware](https://www.fortinet.com/solutions/ransomware.html)

#### Connect With Us

*   [Blog](https://www.fortinet.com/blog/)
*   [Fuse](https://fusecommunity.fortinet.com)

#### Company

*   [About Us](https://www.fortinet.com/corporate/about-us/about-us.html)
*   [Why Fortinet](https://www.fortinet.com/corporate/about-us/why-fortinet.html)
*   [Security Fabric](https://www.fortinet.com/corporate/about-us/security-fabric.html)
*   [Exec Mgmt](https://www.fortinet.com/corporate/about-us/executive-management.html)
*   [Careers](https://www.fortinet.com/corporate/careers.html)
*   [Certifications](https://www.fortinet.com/corporate/about-us/product-certifications.html)
*   [Events](https://www.fortinet.com/corporate/about-us/events.html)
*   [Industry Awards](https://www.fortinet.com/corporate/about-us/industry-awards.html)

#### Contact Us

*   (866) 868-3678

Copyright Â© 2019 Fortinet, Inc. All Rights Reserved

[Terms of Services](https://www.fortinet.com/corporate/about-us/legal.html) [Privacy Policy](https://www.fortinet.com/corporate/about-us/privacy.html)

This site uses cookies. Some are essential to the operation of the site; others help us improve the user experience. By continuing to use the site, you consent to the use of these cookies. To learn more about cookies, please read our [privacy policy](https://www.fortinet.com/corporate/about-us/privacy.html).  

Accept

We Use Cookies

<a id="navigate"></a>

*   NextRoll and our <a id="adroll_consent_banner_partners_link"></a>advertising partners use cookies and similar technologies on this site and around the web that collect and use personal data (e.g. your IP address) in order to select and deliver measurable personalized advertising from this site and other advertisers in <a id="adroll_consent_banner_learn_more"></a>NextRoll's network, as well as to analyze and understand your use of our websites using NextRoll's services.
*   By clicking "Allow", you consent to the placement and use of cookies and similar technologies by NextRoll and its advertising partners.
*   If you select "Reject", NextRoll will not serve you personalized advertising. You may still receive advertising that is not targeted or is served by other third parties that are not affiliated with NextRoll.
*   If you "Allow" now, you have the right to withdraw your consent at anytime by visiting <a id="adroll_consent_banner_optout"></a>here OR by clicking the Ad Choices Icon on any NextRoll served ad.
*   To manage NextRoll's partners and learn more, click <a id="adroll_consent_banner_here_link"></a>here.

<a id="adroll_consent_reject"></a>Reject<a id="adroll_consent_accept"></a>Allow

AddThis Sharing Sidebar

Share to FacebookShare to TwitterShare to LinkedInShare to EmailMore AddThis Share options
