# Threat Report: 2018-06-26: OSINT - RANCOR: Targeted Attacks in South East Asia Using PLAINTEE and DDKONG Malware Families


## Key Intelligence
* Date: 2018-06-26
* Threat Level: 3 (Low)
* Tags: misp-galaxy:tool="KHRAT", misp-galaxy:rat="KhRAT", tlp:white, circl:incident-classification="malware", osint:source-type="blog-post", misp-galaxy:threat-actor="RANCOR", misp-galaxy:mitre-enterprise-attack-attack-pattern="Spearphishing Attachment - T1193"

---

## Indicators of Compromise (IOCs)
### Artifacts dropped
* mutex: microsoftfuckedupb — PLAINTEE
* mutex: Microsoftfuckedup — PLAINTEE

### External analysis
* text: Throughout 2017 and 2018 Unit 42 has been tracking and observing a series of highly targeted attacks focused in South East Asia, building on our research into the KHRAT Trojan. Based on the evidence, these attacks appear to be conducted by the same set of attackers using previously unknown malware families. In addition, these attacks appear to be highly targeted in their distribution of the malware used, as well as the targets chosen. Based on these factors, Unit 42 believes the attackers behind these attacks are conducting their campaigns for espionage purposes.

We believe this group is previously unidentified and therefore have we have dubbed it â€œRANCORâ€. The Rancor groupâ€™s attacks use two primary malware families which we describe in depth later in this blog and are naming DDKONG and PLAINTEE. DDKONG is used throughout the campaign and PLAINTEE appears to be new addition to these attackersâ€™ toolkit.  Countries Unit 42 has identified as targeted by Rancor with these malware families include, but are not limited to:

    Singapore
    Cambodia

We identified decoy files which indicate these attacks began with spear phishing messages but have not observed the actual messages. These decoys contain details from public news articles focused primarily on political news and events. Based on this, we believe the Rancor attackers were targeting political entities.  Additionally, these decoy documents are hosted on legitimate websites including a government website belonging to the Cambodia Government and in at least once case, Facebook.

The malware and infrastructure used in these attacks falls into two distinct clusters, which we are labeling A and B, that are linked through their use of the PLAINTEE malware and several â€œsofterâ€ linkages.
* link: https://researchcenter.paloaltonetworks.com/2018/06/unit42-rancor-targeted-attacks-south-east-asia-using-plaintee-ddkong-malware-families/

### Network activity
* hostname: www.facebook-apps.com — Loader
* hostname: dlj40s.jdanief.xyz — Loader
* ip-dst: 89.46.222.97 — Loader
* ip-dst: 199.247.6.253 — PLAINTEE
* ip-dst: 45.76.176.236 — PLAINTEE
* hostname: goole.authorizeddns.us — PLAINTEE - DDKONG
* ip-dst: 103.75.189.74 — PLAINTEE - DDKONG
* ip-dst: 131.153.48.146 — PLAINTEE
* hostname: microsoft.authorizeddns.us — DDKONG
* hostname: ftp.chinhphu.ddns.ms — DDKONG
* hostname: www.microsoft.https443.org — DDKONG
* hostname: msdns.otzo.com — DDKONG
* ip-dst: 103.75.191.177 — DDKONG
* ip-dst: 103.75.191.75 — DDKONG
* ip-dst: 45.121.146.26 — DDKONG

### Payload delivery
* filename: www.google_ssl.onmypc.org — DDKONG

## Objects
### file — File object describing a file with meta-information
* [Payload delivery] sha256: <sha256>
* [Other] text: Malicious

### file — File object describing a file with meta-information
* [Payload delivery] sha256: <sha256>
* [Other] text: Malicious

### file — File object describing a file with meta-information
* [Payload delivery] sha256: <sha256>
* [Other] text: Malicious

### file — File object describing a file with meta-information
* [Payload delivery] sha256: <sha256>
* [Other] text: Malicious

### file — File object describing a file with meta-information
* [Payload delivery] sha256: <sha256>
* [Other] text: Malicious

### file — File object describing a file with meta-information
* [Payload delivery] sha256: <sha256>
* [Other] text: Malicious

### file — File object describing a file with meta-information
* [Payload delivery] sha256: <sha256>
* [Other] text: Malicious
* [Payload delivery] md5: <md5>
* [Payload delivery] sha1: <sha1>

### file — File object describing a file with meta-information
* [Payload delivery] sha256: <sha256>
* [Other] text: Malicious

### file — File object describing a file with meta-information
* [Payload delivery] sha256: <sha256>
* [Other] text: Malicious
* [Payload delivery] md5: <md5>
* [Payload delivery] sha1: <sha1>

### file — File object describing a file with meta-information
* [Payload delivery] sha256: <sha256>
* [Other] text: Malicious

### file — File object describing a file with meta-information
* [Payload delivery] sha256: <sha256>
* [Other] text: Malicious

### file — File object describing a file with meta-information
* [Payload delivery] sha256: <sha256>
* [Other] text: Malicious

### domain-ip — A domain and IP address seen as a tuple in a specific time frame.
* [Network activity] ip-dst: 89.46.222.97
* [Network activity] domain: facebook-apps.com

### file — File object describing a file with meta-information
* [Payload delivery] md5: <md5>
* [Payload delivery] sha1: <sha1>
* [Payload delivery] sha256: <sha256>
* [Other] text: Malicious

### file — File object describing a file with meta-information
* [Payload delivery] md5: <md5>
* [Payload delivery] sha1: <sha1>
* [Payload delivery] sha256: <sha256>
* [Other] text: Malicious

### file — File object describing a file with meta-information
* [Payload delivery] sha256: <sha256>
* [Other] text: Malicious

### file — File object describing a file with meta-information
* [Payload delivery] sha256: <sha256>
* [Other] text: Malicious

### file — File object describing a file with meta-information
* [Payload delivery] sha256: <sha256>
* [Other] text: Malicious

### file — File object describing a file with meta-information
* _No attributes_

### virustotal-report — VirusTotal report
* _No attributes_

### file — File object describing a file with meta-information
* _No attributes_

### virustotal-report — VirusTotal report
* _No attributes_

### file — File object describing a file with meta-information
* _No attributes_

### virustotal-report — VirusTotal report
* _No attributes_

### file — File object describing a file with meta-information
* _No attributes_

### virustotal-report — VirusTotal report
* _No attributes_

### file — File object describing a file with meta-information
* _No attributes_

### virustotal-report — VirusTotal report
* _No attributes_

### file — File object describing a file with meta-information
* _No attributes_

### virustotal-report — VirusTotal report
* _No attributes_

### file — File object describing a file with meta-information
* _No attributes_

### virustotal-report — VirusTotal report
* _No attributes_

### file — File object describing a file with meta-information
* _No attributes_

### virustotal-report — VirusTotal report
* _No attributes_

### file — File object describing a file with meta-information
* _No attributes_

### virustotal-report — VirusTotal report
* _No attributes_

### file — File object describing a file with meta-information
* [Payload delivery] sha256: <sha256>
* [Other] text: Malicious

### file — File object describing a file with meta-information
* [Payload delivery] sha256: <sha256>
* [Other] text: Malicious

### file — File object describing a file with meta-information
* [Payload delivery] sha256: <sha256>
* [Other] text: Malicious

### file — File object describing a file with meta-information
* [Payload delivery] sha256: <sha256>
* [Other] text: Malicious

### file — File object describing a file with meta-information
* [Payload delivery] sha256: <sha256>
* [Other] text: Malicious

### file — File object describing a file with meta-information
* [Payload delivery] sha256: <sha256>
* [Other] text: Malicious

### file — File object describing a file with meta-information
* [Payload delivery] sha256: <sha256>
* [Other] text: Malicious

### file — File object describing a file with meta-information
* [Payload delivery] sha256: <sha256>
* [Other] text: Malicious

### file — File object describing a file with meta-information
* [Payload delivery] sha256: <sha256>
* [Other] text: Malicious

### file — File object describing a file with meta-information
* [Payload delivery] sha256: <sha256>
* [Other] text: Malicious

### file — File object describing a file with meta-information
* [Payload delivery] sha256: <sha256>
* [Other] text: Malicious

### file — File object describing a file with meta-information
* [Payload delivery] sha256: <sha256>
* [Other] text: Malicious

### file — File object describing a file with meta-information
* [Payload delivery] sha256: <sha256>
* [Other] text: Malicious

### file — File object describing a file with meta-information
* _No attributes_

### virustotal-report — VirusTotal report
* _No attributes_

### file — File object describing a file with meta-information
* _No attributes_

### virustotal-report — VirusTotal report
* _No attributes_

### file — File object describing a file with meta-information
* _No attributes_

### virustotal-report — VirusTotal report
* _No attributes_

### file — File object describing a file with meta-information
* _No attributes_

### virustotal-report — VirusTotal report
* _No attributes_

### file — File object describing a file with meta-information
* _No attributes_

### virustotal-report — VirusTotal report
* _No attributes_

### file — File object describing a file with meta-information
* _No attributes_

### virustotal-report — VirusTotal report
* _No attributes_

### file — File object describing a file with meta-information
* _No attributes_

### virustotal-report — VirusTotal report
* _No attributes_

### file — File object describing a file with meta-information
* _No attributes_

### virustotal-report — VirusTotal report
* _No attributes_

### file — File object describing a file with meta-information
* _No attributes_

### virustotal-report — VirusTotal report
* _No attributes_

### file — File object describing a file with meta-information
* _No attributes_

### virustotal-report — VirusTotal report
* _No attributes_

### file — File object describing a file with meta-information
* _No attributes_

### virustotal-report — VirusTotal report
* _No attributes_

### file — File object describing a file with meta-information
* _No attributes_

### virustotal-report — VirusTotal report
* _No attributes_
