# Threat Report: 2019-11-21: OSINT -  Wrong hashes (from getmonero.org) #6151 - malicious binaries


## Key Intelligence
* Date: 2019-11-21
* Threat Level: 1 (High)
* Tags: type:OSINT, osint:lifetime="perpetual", tlp:white, misp-galaxy:mitre-attack-pattern="Supply Chain Compromise - T1195", misp-galaxy:mitre-attack-pattern="Trusted Relationship - T1199", collaborative-intelligence:request="historical-information", estimative-language:likelihood-probability="almost-certain", estimative-language:confidence-in-analytic-judgment="high", admiralty-scale:information-credibility="2"

---

## Indicators of Compromise (IOCs)
### External analysis
* link: https://bartblaze.blogspot.com/2019/11/monero-project-compromised.html
* link: https://github.com/monero-project/monero/issues/6151
* link: https://web.getmonero.org/2019/11/19/warning-compromised-binaries.html
* link: https://old.reddit.com/r/Monero/comments/dyfozs/security_warning_cli_binaries_available_on/
* link: https://thehackernews.com/2019/11/hacking-monero-cryptocurrency.html

### Network activity
* ip-dst: 91.210.104.245 — Malicious referenced by https://www.virustotal.com/gui/file/7ab9afbc5f9a1df687558d570192fbfe9e085712657d2cfa5524f2c8caccca31/community
* ip-dst: 45.9.148.65 — Malicious referenced by https://www.virustotal.com/gui/file/7ab9afbc5f9a1df687558d570192fbfe9e085712657d2cfa5524f2c8caccca31/community
* domain: hashmonero.com — Malicious referenced by https://www.virustotal.com/gui/file/7ab9afbc5f9a1df687558d570192fbfe9e085712657d2cfa5524f2c8caccca31/community
* domain: xmrsupport.co — Malicious referenced by https://www.virustotal.com/gui/file/7ab9afbc5f9a1df687558d570192fbfe9e085712657d2cfa5524f2c8caccca31/community
* hostname: www.hashmonero.com — Malicious referenced by https://www.virustotal.com/gui/file/7ab9afbc5f9a1df687558d570192fbfe9e085712657d2cfa5524f2c8caccca31/community
* hostname: node.xmrsupport.co — Malicious referenced by https://www.virustotal.com/gui/file/7ab9afbc5f9a1df687558d570192fbfe9e085712657d2cfa5524f2c8caccca31/community
* hostname: node.hashmonero.com — Malicious referenced by https://www.virustotal.com/gui/file/7ab9afbc5f9a1df687558d570192fbfe9e085712657d2cfa5524f2c8caccca31/community
* url: https://91.210.104.245 — https://github.com/monero-project/monero/issues/6151#issuecomment-555698007

### Payload delivery
* sha256: <sha256> — Malicious monero binary

## Objects
### file — File object describing a file with meta-information
* [Payload delivery] md5: <md5> — Malicious monero binary
* [Payload delivery] sha1: <sha1> — Malicious monero binary
* [Payload delivery] sha256: <sha256> — Malicious monero binary

### virustotal-report — VirusTotal report
* [Other] datetime: 2019-11-21T08:05:19 — Malicious monero binary
* [Payload delivery] link: https://www.virustotal.com/file/7ab9afbc5f9a1df687558d570192fbfe9e085712657d2cfa5524f2c8caccca31/analysis/1574323519/ — Malicious monero binary
* [Payload delivery] text: 7/57 — Malicious monero binary

### file — File object describing a file with meta-information
* [Payload delivery] malware-sample: 7ab9afbc5f9a1df687558d570192fbfe9e085712657d2cfa5524f2c8caccca31|d267be7efc3f2c4dde8e90b9b489ed2a
* [Payload delivery] filename: 7ab9afbc5f9a1df687558d570192fbfe9e085712657d2cfa5524f2c8caccca31
* [Payload delivery] md5: <md5>
* [Payload delivery] sha1: <sha1>
* [Payload delivery] sha256: <sha256>
* [Other] size-in-bytes: 28967688

### ip-port — An IP address (or domain or hostname) and a port seen as a tuple (or as a triple) in a specific time frame.
* [Network activity] ip-dst: 45.9.148.65
* [Network activity] port: 18081
* [Other] text: https://github.com/monero-project/monero/issues/6151#issuecomment-555694443

### annotation — An annotation object allowing analysts to add annotations, comments, executive summary to a MISP event, objects or attributes.
* [External analysis] link: https://github.com/monero-project/monero/issues/6151#issuecomment-555694443
* [Other] text: Analysis
* [Other] text: I'm analyzing the malicious binaries. Luckily debug symbols are included which makes it easier. Here's my progress so far:

    two new functions are added named cryptonote::simple_wallet::send_to_cc at address 0x0000000000689AE0 and cryptonote::simple::wallet:send_seed at address 0x000000000068B590
    these malicious functions are called inside cryptonote::simple_wallet::print_seed
    print_seed is called at cryptonote::simple_wallet::open_wallet and cryptonote::simple_wallet::new_wallet - that means anyone who created or opened a wallet with this binary has his seed stolen
    the seed is then sent to 45.9.148.65 (node.xmrsupport.co with SSL certificate for node.hashmonero.com) port 18081 as simple HTTP POST request
