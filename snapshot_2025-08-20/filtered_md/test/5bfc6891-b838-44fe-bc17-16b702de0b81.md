# Threat Report: 2018-11-26: OSINT - `event-stream` dependency attack steals wallets from users of copay


## Key Intelligence
* Date: 2018-11-26
* Threat Level: 3 (Low)
* Tags: tlp:white, ecsirt:intrusions="application-compromise", estimative-language:confidence-in-analytic-judgment="high", estimative-language:likelihood-probability="almost-certain"

---

## Indicators of Compromise (IOCs)
### Attribution
* dns-soa-email: kvlguuvh@sharklasers.co — copayapi.host's SOA record indicates the domain registrant's email address is "kvlguuvh@sharklasers.co" (very likely a throwaway email address).
* whois-registrant-email: right9ctrl@outlook.com

### External analysis
* link: https://github.com/bitpay/copay/issues/9346#issuecomment-441749542
* link: https://github.com/dominictarr/event-stream/issues/116

### Network activity
* domain: copayapi.host — "HTTP POST traffic on port 8080 to copayapi.host (which currently resolves to 51.38.112.212 and previously resolved to 145.249.104.239) or 111.90.151.134 indicates compromised and exfiltrated wallet private keys."
* ip-dst: 51.38.112.212 — "HTTP POST traffic on port 8080 to copayapi.host (which currently resolves to 51.38.112.212 and previously resolved to 145.249.104.239) or 111.90.151.134 indicates compromised and exfiltrated wallet private keys."
* ip-dst: 145.249.104.239 — "HTTP POST traffic on port 8080 to copayapi.host (which currently resolves to 51.38.112.212 and previously resolved to 145.249.104.239) or 111.90.151.134 indicates compromised and exfiltrated wallet private keys."
* ip-dst: 111.90.151.134 — "HTTP POST traffic on port 8080 to copayapi.host (which currently resolves to 51.38.112.212 and previously resolved to 145.249.104.239) or 111.90.151.134 indicates compromised and exfiltrated wallet private keys."
* url: https://www.npmjs.com/~right9ctrl — The NPM account of the event-stream hijacker: https://www.npmjs.com/~right9ctrlh
* url: https://github.com/hugeglass/flatmap-stream — The GitHub repo for the malicious flat-map package: https://github.com/hugeglass/flatmap-stream
* url: https://www.npmjs.com/~hugeglass

### Social network
* github-username: right9ctrl — The GitHub account of the event-stream hijacker: https://github.com/right9ctrl (email address right9ctrl@outlook.com)
