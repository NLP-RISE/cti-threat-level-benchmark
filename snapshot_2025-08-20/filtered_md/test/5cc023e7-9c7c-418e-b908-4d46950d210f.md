# Threat Report: 2019-04-24: OSINT -  DNSpionage brings out the Karkoff


## Key Intelligence
* Date: 2019-04-24
* Threat Level: 3 (Low)
* Tags: misp-galaxy:malpedia="DNSpionage", misp-galaxy:threat-actor="DNSpionage", type:OSINT, osint:lifetime="perpetual", osint:certainty="50", tlp:white, misp-galaxy:tool="Karkoff"

---

## Indicators of Compromise (IOCs)
### External analysis
* link: https://blog.talosintelligence.com/2019/04/dnspionage-brings-out-karkoff.html
* text: In November 2018, Cisco Talos discovered an attack campaign, called DNSpionage, in which threat actors created a new remote administrative tool that supports HTTP and DNS communication with the attackers' command and control(C2). Since then, there have been several other public reports of additional DNSpionage attacks, and in January, the U.S. Department of Homeland Security issued an alert warning users about this threat activity.

In addition to increased reports of threat activity, we have also discovered new evidence that the threat actors behind the DNSpionage campaign continue to change their tactics, likely in an attempt to improve the efficacy of their operations. In February, we discovered some changes to the actors' tactics, techniques and procedures (TTPs), including the use of a new reconnaissance phase that selectively chooses which targets to infect with malware. In April 2019, we also discovered the actors using a new malware, which we are calling "Karkoff."

This post will cover the aforementioned DNSpionage updates, the discovery of the Karkoff malware and an analysis of the recent Oilrig malware toolset leak â€” and how it could be connected to these two attacks.

### Network activity
* domain: coldfart.com — C2 server
* domain: rimrun.com — C2 server
* domain: kuternull.com — C2 server
* ip-src: 108.62.141.247 — Attribute #4346152 enriched by dns.
* ip-src: 74.118.138.192 — Attribute #4346153 enriched by dns.

### Payload delivery
* sha256: <sha256> — Karkoff sample
* sha256: <sha256> — Karkoff sample
* sha256: <sha256> — Karkoff sample
* sha256: <sha256> — Karkoff sample
* sha256: <sha256> — DNSpionage XLS document
* sha256: <sha256> — DNSpionage

## Objects
### file — File object describing a file with meta-information
* [Payload delivery] md5: <md5> — Karkoff sample
* [Payload delivery] sha1: <sha1> — Karkoff sample
* [Payload delivery] sha256: <sha256> — Karkoff sample

### virustotal-report — VirusTotal report
* [Other] datetime: 2019-04-24T08:58:49 — Karkoff sample
* [Payload delivery] link: https://www.virustotal.com/file/cd4b9d0f2d1c0468750855f0ed352c1ed6d4f512d66e0e44ce308688235295b5/analysis/1556096329/ — Karkoff sample
* [Payload delivery] text: 38/71 — Karkoff sample

### file — File object describing a file with meta-information
* [Payload delivery] md5: <md5> — DNSpionage
* [Payload delivery] sha1: <sha1> — DNSpionage
* [Payload delivery] sha256: <sha256> — DNSpionage

### virustotal-report — VirusTotal report
* [Other] datetime: 2019-04-24T09:05:37 — DNSpionage
* [Payload delivery] link: https://www.virustotal.com/file/e398dac59f604d42362ffe8a2947d4351a652516ebfb25ddf0838dd2c8523be8/analysis/1556096737/ — DNSpionage
* [Payload delivery] text: 48/69 — DNSpionage

### file — File object describing a file with meta-information
* [Payload delivery] md5: <md5> — Karkoff sample
* [Payload delivery] sha1: <sha1> — Karkoff sample
* [Payload delivery] sha256: <sha256> — Karkoff sample

### virustotal-report — VirusTotal report
* [Other] datetime: 2019-04-24T07:39:13 — Karkoff sample
* [Payload delivery] link: https://www.virustotal.com/file/6a251ed6a2c6a0a2be11f2a945ec68c814d27e2b6ef445f4b2c7a779620baa11/analysis/1556091553/ — Karkoff sample
* [Payload delivery] text: 39/66 — Karkoff sample

### file — File object describing a file with meta-information
* [Payload delivery] md5: <md5> — Karkoff sample
* [Payload delivery] sha1: <sha1> — Karkoff sample
* [Payload delivery] sha256: <sha256> — Karkoff sample

### virustotal-report — VirusTotal report
* [Other] datetime: 2019-04-24T07:39:16 — Karkoff sample
* [Payload delivery] link: https://www.virustotal.com/file/5b102bf4d997688268bab45336cead7cdf188eb0d6355764e53b4f62e1cdf30c/analysis/1556091556/ — Karkoff sample
* [Payload delivery] text: 42/71 — Karkoff sample

### file — File object describing a file with meta-information
* [Payload delivery] md5: <md5> — Karkoff sample
* [Payload delivery] sha1: <sha1> — Karkoff sample
* [Payload delivery] sha256: <sha256> — Karkoff sample

### virustotal-report — VirusTotal report
* [Other] datetime: 2019-04-24T07:39:18 — Karkoff sample
* [Payload delivery] link: https://www.virustotal.com/file/b017b9fc2484ce0a5629ff1fed15bca9f62f942eafbb74da6a40f40337187b04/analysis/1556091558/ — Karkoff sample
* [Payload delivery] text: 41/65 — Karkoff sample
