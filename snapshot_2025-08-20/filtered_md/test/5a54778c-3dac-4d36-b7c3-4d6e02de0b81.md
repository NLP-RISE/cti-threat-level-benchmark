# Threat Report: 2018-01-09: OSINT - A North Korean Monero Cryptocurrency Miner


## Key Intelligence
* Date: 2018-01-09
* Threat Level: 3 (Low)
* Tags: tlp:white, admiralty-scale:information-credibility="2", osint:source-type="blog-post"

---

## Indicators of Compromise (IOCs)
### Artifacts dropped
* yara: rule nkminer_monero {

   meta:

       description = "Detects installer of Monero miner that points to a NK domain"

       author = "cdoman@alienvault.com"

       tlp = "white"

       license = "MIT License"

   strings:

       $a = "82e999fb-a6e0-4094-aa1f-1a306069d1a5" nocase wide ascii

       $b = "4JUdGzvrMFDWrUUwY3toJATSeNwjn54LkCnKBPRzDuhzi5vSepHfUckJNxRL2gjkNrSqtCoRUrEDAgRwsQvVCjZbRy5YeFCqgoUMnzumvS" nocase wide ascii

       $c = "barjuok.ryongnamsan.edu.kp" nocase wide ascii

       $d = "C:\\SoftwaresInstall\\soft" nocase wide ascii

       $e = "C:\\Windows\\Sys64\\intelservice.exe" nocase wide ascii

       $f = "C:\\Windows\\Sys64\\updater.exe" nocase wide ascii

       $g = "C:\\Users\\Jawhar\\documents\\" nocase wide ascii

   condition:

       any of them

}

### External analysis
* link: https://www.alienvault.com/blogs/labs-research/a-north-korean-monero-cryptocurrency-miner
* text: AlienVault labs recently analysed an application compiled on Christmas Eve 2017. It is an Installer for software to mine the Monero crypto-currency. Any mined currency is sent to Kim Il Sung University in Pyongyang, North Korea.

The Installer copies a file named intelservice.exe to the system. The filename intelservice.exe is often associated with crypto-currency mining malware. Based on the arguments itâ€™s executed with, itâ€™s likely a piece of software called xmrig. 

Itâ€™s not unusual to see xmrig in malware campaigns. It was recently used in some wide campaigns exploiting unpatched IIS servers to mine Monero.

### Network activity
* ip-src: 175.45.178.19 — has been active on BitCoin trading sites:
* hostname: barjuok.ryongnamsan.edu.kp — On port 5615

### Payload delivery
* md5: <md5> — We identified two other pieces of software which share some code:
* md5: <md5> — We identified two other pieces of software which share some code:
* md5: <md5> — Decompiled Code

## Objects
### ip-port — An IP address and a port seen as a tuple (or as a triple) in a specific time frame.
* [Network activity] port: 5615
* [Network activity] ip-dst: 175.45.178.19
* [Other] text: Arguments = (("-o barjuok.ryongnamsan.edu.kp:5615 -u 4JUdGzvrMFDWrUUwY3toJATSeNwjn54LkCnKBPRzDuhzi5vSepHfUckJNxRL2gjkNrSqtCoRUrEDAgRwsQvVCjZbRy5YeFCqgoUMnzumvS -p " + str + " -k -t " + Conversions.ToString(value)) ?? "")

### file — File object describing a file with meta-information
* [Payload delivery] sha1: <sha1> — We identified two other pieces of software which share some code:
* [Payload delivery] md5: <md5> — We identified two other pieces of software which share some code:
* [Payload delivery] sha256: <sha256> — We identified two other pieces of software which share some code:

### virustotal-report — VirusTotal report
* [External analysis] link: https://www.virustotal.com/file/42300b6a09f183ae167d7a11d9c6df21d022a5f02df346350d3d875d557d3b76/analysis/1515484535/ — We identified two other pieces of software which share some code:
* [Other] text: 3/67 — We identified two other pieces of software which share some code:
* [Other] datetime: 2018-01-09T07:55:35 — We identified two other pieces of software which share some code:

### file — File object describing a file with meta-information
* [Payload delivery] sha1: <sha1> — Decompiled Code
* [Payload delivery] md5: <md5> — Decompiled Code
* [Payload delivery] sha256: <sha256> — Decompiled Code

### virustotal-report — VirusTotal report
* [External analysis] link: https://www.virustotal.com/file/c599f3ca3417169e4a620b8231f8a97ccc63e291b9e09c888e6807dd90f1f17c/analysis/1515484533/ — Decompiled Code
* [Other] text: 6/68 — Decompiled Code
* [Other] datetime: 2018-01-09T07:55:33 — Decompiled Code

### file — File object describing a file with meta-information
* [Payload delivery] sha1: <sha1> — We identified two other pieces of software which share some code:
* [Payload delivery] md5: <md5> — We identified two other pieces of software which share some code:
* [Payload delivery] sha256: <sha256> — We identified two other pieces of software which share some code:

### virustotal-report — VirusTotal report
* [External analysis] link: https://www.virustotal.com/file/0024e32c0199ded445c0b968601f21cc92fc0c534d2642f2dd64c1c978ff01f3/analysis/1515484532/ — We identified two other pieces of software which share some code:
* [Other] text: 6/67 — We identified two other pieces of software which share some code:
* [Other] datetime: 2018-01-09T07:55:32 — We identified two other pieces of software which share some code:
