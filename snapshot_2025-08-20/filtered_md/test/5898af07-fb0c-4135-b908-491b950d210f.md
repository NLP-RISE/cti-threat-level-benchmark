# Threat Report: 2017-02-06: OSINT - ikittens: iranian actor resurfaces with malware for mac (macdownloader)


## Key Intelligence
* Date: 2017-02-06
* Threat Level: 3 (Low)
* Tags: tlp:white

---

## Indicators of Compromise (IOCs)
### Artifacts dropped
* pdb: %USERPROFILE%\Desktop\Projects\Tiny_st\BlackBerry\obj\Debug\MSSUP.pdb

### External analysis
* link: https://iranthreats.github.io/resources/macdownloader-macos-malware/
* text: A macOS malware agent, named MacDownloader, was observed in the wild as targeting the defense industrial base, and reported elsewhere to have been used against an human rights advocate. MacDownloader strangely attempts to pose as both an installer for Adobe Flash, as well as the Bitdefender Adware Removal Tool, in order to extract system information and copies of OS X keychain databases. Based on observations on infrastructure, and the state of the code, we believe these incidents represent the first attempts to deploy the agent, and features such as persistence do not appear to work. Instead, MacDownloader is a simple exfiltration agent, with broader ambitions.

The macOS malware also mirrors the approach of the ExtremeDownloader dropper previously documented in our research, and samples of the latter identified during this time used the same infrastructure. Lastly, the exposure of test victim data and code references provide a unique insight into the development of the malware, with potential connections to agents developed by long dormant threat groups.

Since the Technical Preview of our forthcoming Carnegie Endowment publication about state-sponsored espionage campaigns was released at Black Hat USA, we have continued to disclose information about current Iranian activities in order to promote public education and to provide indicators of compromise. While this agent is neither sophisticated nor full-featured, its sudden appearance is concerning given the popularity of Apple computers with certain community, and inaccurate perceptions about the security of those devices.
* link: https://www.virustotal.com/file/7a9cdb9d608b88bd7afce001cb285c2bb2ae76f5027977e8635aa04bd064ffb7/analysis/1486400681/ — Bitdefender Adware Removal Tool - Xchecked via VT: 7a9cdb9d608b88bd7afce001cb285c2bb2ae76f5027977e8635aa04bd064ffb7
* link: https://www.virustotal.com/file/52efcfe30f96a85c9c068880c20663db64f0e08346e0f3b59c2e5bbcb41ba73c/analysis/1486400701/ — addone flashplayer.app.zip - Xchecked via VT: 52efcfe30f96a85c9c068880c20663db64f0e08346e0f3b59c2e5bbcb41ba73c

### Network activity
* ip-dst: 46.17.97.37
* domain: officialswebsites.info
* hostname: utc.officialswebsites.info
* url: http://192.168.3.217/DroperTest — The malware reads from the embedded Resources folder the "checkadr.txt," which contains the URL for the first beacon. 192.168.3.217 is internal development server address
* url: http://46.17.97.37/Servermac.php — The malware reads from the embedded Resources folder the "checkadr.txt," which contains the URL for the first beacon. 192.168.3.217 is internal development server address

### Payload delivery
* sha256: <sha256> — addone flashplayer.app.zip
* sha256: <sha256> — Bitdefender Adware Removal Tool
* sha1: <sha1> — Bitdefender Adware Removal Tool - Xchecked via VT: 7a9cdb9d608b88bd7afce001cb285c2bb2ae76f5027977e8635aa04bd064ffb7
* md5: <md5> — Bitdefender Adware Removal Tool - Xchecked via VT: 7a9cdb9d608b88bd7afce001cb285c2bb2ae76f5027977e8635aa04bd064ffb7
* sha1: <sha1> — addone flashplayer.app.zip - Xchecked via VT: 52efcfe30f96a85c9c068880c20663db64f0e08346e0f3b59c2e5bbcb41ba73c
* md5: <md5> — addone flashplayer.app.zip - Xchecked via VT: 52efcfe30f96a85c9c068880c20663db64f0e08346e0f3b59c2e5bbcb41ba73c
