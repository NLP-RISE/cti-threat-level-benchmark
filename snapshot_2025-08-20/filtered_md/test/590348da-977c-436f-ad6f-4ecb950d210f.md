# Threat Report: 2017-04-28: OSINT - Use of DNS Tunneling for C&C Communications


## Key Intelligence
* Date: 2017-04-28
* Threat Level: 3 (Low)
* Tags: tlp:white, malware_classification:obfuscation-technique="tunneling"

---

## Indicators of Compromise (IOCs)
### External analysis
* link: https://securelist.com/blog/research/78203/use-of-dns-tunneling-for-cc-communications/
* text: Network communication is a key function for any malicious program. Yes, there are exceptions, such as cryptors and ransomware Trojans that can do their job just fine without using the Internet. However, they also require their victims to establish contact with the threat actor so they can send the ransom and recover their encrypted data. If we omit these two and have a look at the types of malware that have no communication with a C&C and/or threat actor, all that remains are a few outdated or extinct families of malware (such as Trojan-ArcBomb), or irrelevant, crudely made prankware that usually does nothing more than scare the user with screamers or switches mouse buttons.

Malware has come a long way since the Morris worm, and the authors never stop looking for new ways to maintain communication with their creations. Some create complex, multi-tier authentication and management protocols that can take weeks or even months for analysists to decipher. Others go back to the basics and use IRC servers as a management host â€“ as we saw in the recent case of Mirai and its numerous clones.

Often, virus writers donâ€™t even bother to run encryption or mask their communications: instructions and related information is sent in plain text, which comes in handy for a researcher analyzing the bot. This approach is typical of incompetent cybercriminals or even experienced programmers who donâ€™t have much experience developing malware.

However, you do get the occasional off-the-wall approaches that donâ€™t fall into either of the above categories. Take, for instance, the case of a Trojan that Kaspersky Lab researchers discovered in mid-March and which establishes a DNS tunnel for communication with the C&C server.

The malicious program in question is detected by Kaspersky Lab products as Backdoor.Win32.Denis. This Trojan enables an intruder to manipulate the file system, run arbitrary commands and run loadable modules.
* link: https://www.virustotal.com/file/bb5114227ab5bb2e6bde5bcd876e437f72998ee88d27f7cbb15828c82666bef1/analysis/1489120629/ — - Xchecked via VT: 5421781c2c05e64ef20be54e2ee32e37
* link: https://www.virustotal.com/file/087ef9f7ce4681d49c6fa8842785fedef21461f160a34fc37c75fed26ddfa91e/analysis/1490772409/ — - Xchecked via VT: 5394b09cf2a0b3d1caaecc46c0e502e3
* link: https://www.virustotal.com/file/f5872f49943c39b73026fc3982b85330953a138cc27c23487a28103337bfdbb5/analysis/1492046570/ — - Xchecked via VT: 1a4d58e281103fea2a4ccbfab93f74d2
* link: https://www.virustotal.com/file/12c2c3566c29f80478277e0f96b79fc85b9e86ebf16505d8f2d7877a6204f860/analysis/1493377594/ — - Xchecked via VT: 018433e8e815d9d2065e57b759202edc
* link: https://www.virustotal.com/file/155b13e582adeab564c60a1091b4dccc43ed78db290aa3e2da7e8bc1e039770c/analysis/1489419438/ — - Xchecked via VT: facec411b6d6aa23ff80d1366633ea7a

### Payload delivery
* md5: <md5>
* md5: <md5>
* md5: <md5>
* md5: <md5>
* md5: <md5>
* sha256: <sha256> — - Xchecked via VT: 5421781c2c05e64ef20be54e2ee32e37
* sha1: <sha1> — - Xchecked via VT: 5421781c2c05e64ef20be54e2ee32e37
* sha256: <sha256> — - Xchecked via VT: 5394b09cf2a0b3d1caaecc46c0e502e3
* sha1: <sha1> — - Xchecked via VT: 5394b09cf2a0b3d1caaecc46c0e502e3
* sha256: <sha256> — - Xchecked via VT: 1a4d58e281103fea2a4ccbfab93f74d2
* sha1: <sha1> — - Xchecked via VT: 1a4d58e281103fea2a4ccbfab93f74d2
* sha256: <sha256> — - Xchecked via VT: 018433e8e815d9d2065e57b759202edc
* sha1: <sha1> — - Xchecked via VT: 018433e8e815d9d2065e57b759202edc
* sha256: <sha256> — - Xchecked via VT: facec411b6d6aa23ff80d1366633ea7a
* sha1: <sha1> — - Xchecked via VT: facec411b6d6aa23ff80d1366633ea7a
